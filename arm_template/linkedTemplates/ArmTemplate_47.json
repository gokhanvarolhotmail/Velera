{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "EnterpriseDataSourceProdDF"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/TR_Daily_sp_Update_Binkey_Transactions')]",
            "type": "Microsoft.DataFactory/factories/triggers",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "runtimeState": "Started",
                "pipelines": [
                    {
                        "pipelineReference": {
                            "referenceName": "PL_sp_update_binkey_transactions",
                            "type": "PipelineReference"
                        },
                        "parameters": {}
                    }
                ],
                "type": "ScheduleTrigger",
                "typeProperties": {
                    "recurrence": {
                        "frequency": "Day",
                        "interval": 1,
                        "startTime": "2021-07-21T01:03:00",
                        "timeZone": "Eastern Standard Time",
                        "schedule": {
                            "minutes": [
                                0
                            ],
                            "hours": [
                                18
                            ]
                        }
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/TR_Daily_PL_SharedBranch_Integrated_Load')]",
            "type": "Microsoft.DataFactory/factories/triggers",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "This trigger calls the pipeline that will load the SB Transaction and SB Interchange data into Integrated Table in ConsolidatedDW.",
                "annotations": [],
                "runtimeState": "Started",
                "pipelines": [
                    {
                        "pipelineReference": {
                            "referenceName": "PL_SharedBranch_Integrated_Load",
                            "type": "PipelineReference"
                        },
                        "parameters": {}
                    }
                ],
                "type": "ScheduleTrigger",
                "typeProperties": {
                    "recurrence": {
                        "frequency": "Day",
                        "interval": 1,
                        "startTime": "2022-09-30T15:30:00Z",
                        "timeZone": "UTC",
                        "schedule": {}
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_CycleToDate')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneTransactions_meta_CycleToDate",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'CycleToDate')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "BinarySource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "deleteFilesAfterCompletion": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "BinaryReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "BinarySink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "DS_BINARY_DZ_FDCycleToDate",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "DS_BINARY_RAW_FDCycleToDate",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2021-07-30T22:10:09Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Copy_Storage')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "CopyData",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": false,
                                    "wildcardFileName": "*",
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "parallelCopies": 4
                        },
                        "inputs": [
                            {
                                "referenceName": "src_Copy",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "drop-zone",
                                    "directory": "FIS/Interchange"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "snk_Copy",
                                "type": "DatasetReference",
                                "parameters": {
                                    "container": "raw",
                                    "directory": "FIS/Interchange/current"
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2021-03-11T18:38:47Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_transactions')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneTransactions_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'FISDebitTransaction')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "dropZoneTransactions",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_transactions",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FIS/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_CrossCycle')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneTransactions_meta_CrossCycle",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'CrossCycle')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "BinarySource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "deleteFilesAfterCompletion": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "BinaryReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "BinarySink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "DS_BINARY_DZ_FDCrossCycle",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "DS_BINARY_RAW_FDCrossCycle",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2021-07-30T22:10:08Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_CD031')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneTransactions_meta_CD031",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'CD031')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "dropZoneTransactions_CD031",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_CD031",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_demographics')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzDemographics_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'FISDebitDemographic')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzDemographics",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_account",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDropFile",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzDemographics",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FIS/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDTransactions')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneTransactions_meta_FD",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'Transaction')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "BinarySource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "deleteFilesAfterCompletion": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "BinaryReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "BinarySink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "DS_BINARY_DZ_FDTransactions",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "DS_BINARY_RAW_FDTransactions",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2021-07-30T22:10:08Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_ChargeOff')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneTransactions_meta_ChargeOff",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'ChargeOff')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "BinarySource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "deleteFilesAfterCompletion": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "BinaryReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "BinarySink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "DS_BINARY_DZ_FDChargeOff",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "DS_BINARY_RAW_FDChargeOff",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2021-07-30T22:10:08Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_SemanticDatabase_TestCases')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Trans_Analysis_Daily_No_Account",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[transaction_analysis_daily_no_account]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionAnalysis_Daily_NoAccount",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Daily_NoAccount",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Trans_Analysis_Monthly",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[transaction_analysis_monthly]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_year",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "settlement_year",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_month",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "settlement_month",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Trans_Analysis_Monthly_No_Account",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[transaction_analysis_monthly_no_account]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_year",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "settlement_year",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_month",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "settlement_month",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionsAnalysis_Monthly_NoAccount",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Monthly_NoAccount",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-29T22:11:53Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_DD031')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneTransactions_meta_DD031",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'DD031')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "dropZoneTransactions_DD031",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_DD031",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTransactionAnalysis_singleDay')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "populate_TransStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_analysis_daily_Days_Data_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.ProcessDate",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[transaction_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionAnalysis_Daily_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Daily_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DELETE_TRANS",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "populate_TransStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_DaysData_Transaction_analysis_Daily]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.ProcessDate",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "populate_TransFinal",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DELETE_TRANS",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "parallelCopies": 8,
                            "dataIntegrationUnits": 16,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Daily_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "ProcessDate": {
                        "type": "string",
                        "defaultValue": "1/1/2019"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Daily"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semCardholderAnalysis_singleDay')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "populate_cardholderStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_cardholder_analysis_daily_Days_Data_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.ProcessDate",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[cardholder_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_CardholderAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_CardholderAnalysis_Daily_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DELETE_Cardholder",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "populate_cardholderStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_DaysData_Cardholder_analysis_Daily]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.ProcessDate",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "populate_cardholderFinal",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DELETE_Cardholder",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "parallelCopies": 8,
                            "dataIntegrationUnits": 16,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_CardholderAnalysis_Daily_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_CardholderAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "ProcessDate": {
                        "type": "string",
                        "defaultValue": "1/1/2019"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Daily"
                },
                "annotations": [],
                "lastPublishTime": "2020-09-14T20:05:16Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTerminalAnalysis_singleDay')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "populate_TerminalStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_terminal_analysis_daily_Days_Data_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.ProcessDate",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[terminal_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_client_id",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "acquirer_client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issuer_client_id",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "issuer_client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transmission_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "transmission_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "product_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "product_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_premise",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "on_premise",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TerminalAnalysis_Daily_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TerminalAnalysis_Daily_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DELETE_Term",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "populate_TerminalStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_DaysData_Terminal_analysis_Daily]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.ProcessDate",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "populate_TerminalFinal",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DELETE_Term",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "parallelCopies": 8,
                            "dataIntegrationUnits": 16,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "acquirer_client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issuer_client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "issuer_client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transmission_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "transmission_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "product_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "product_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_premise",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "on_premise",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_TerminalAnalysis_Daily_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TerminalAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "ProcessDate": {
                        "type": "string",
                        "defaultValue": "1/1/2019"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Daily"
                },
                "annotations": [],
                "lastPublishTime": "2020-09-14T20:05:17Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semMerchantAnalysis_singleDay')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "populate_MerchStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_merchant_analysis_daily_Days_Data_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.ProcessDate",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[merchant_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_MerchantAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_MerchatAnalysis_Daily_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DELETE_Merch",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "populate_MerchStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_DaysData_Merchant_analysis_Daily]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.ProcessDate",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "populate_MerchFinal",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DELETE_Merch",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "parallelCopies": 8,
                            "dataIntegrationUnits": 16,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_MerchatAnalysis_Daily_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_MerchantAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "ProcessDate": {
                        "type": "string",
                        "defaultValue": "1/1/2019"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Daily"
                },
                "annotations": [],
                "lastPublishTime": "2020-09-14T20:05:14Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semMerchantAnalysis')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Lookup1",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderQuery": "SELECT count(*) as records FROM [Audit].[vw_load_settlement_date]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "dataset": {
                                "referenceName": "populate_AuditTransactionsLog",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "If Condition1",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "Lookup1",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@greater(activity('Lookup1').output.firstRow.records,0)",
                                "type": "Expression"
                            },
                            "ifTrueActivities": [
                                {
                                    "name": "populate_MerchStaging",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "SqlDWSource",
                                            "queryTimeout": "02:00:00",
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "AzureSqlSink",
                                            "preCopyScript": "TRUNCATE TABLE [staging].[merchant_analysis_daily]",
                                            "disableMetricsCollection": false
                                        },
                                        "enableStaging": false,
                                        "parallelCopies": 4,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "account_key",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "account_number",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_outcome_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_outcome_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_address",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_address",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_city",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_city",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_state",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_state",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_zipcode",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_zipcode",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "vw_MerchantAnalysis_Daily",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "sem_MerchatAnalysis_Daily_staging",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                },
                                {
                                    "name": "DELETE_MERCH",
                                    "type": "SqlServerStoredProcedure",
                                    "dependsOn": [
                                        {
                                            "activity": "populate_MerchStaging",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "storedProcedureName": "[[sem].[s_merchant_analysis_daily_delete]"
                                    },
                                    "linkedServiceName": {
                                        "referenceName": "Consolidation",
                                        "type": "LinkedServiceReference"
                                    }
                                },
                                {
                                    "name": "populate_MerchFinal",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "DELETE_MERCH",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "AzureSqlSource",
                                            "queryTimeout": "02:00:00",
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "AzureSqlSink"
                                        },
                                        "enableStaging": false,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "account_number",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "account_number",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_code_outcome_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_outcome_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_address",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_address",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_city",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_city",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_state",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_state",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_zipcode",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_zipcode",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_country",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_country",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "sem_MerchatAnalysis_Daily_staging",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "sem_MerchantAnalysis_Daily",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:35Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semAccountAnalysis_Bulk')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "populate_AcctStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "Truncate Table [sem].[account_analysis_daily];",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "import_file_date_Key",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_activation_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "activation_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_expiration_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "expiration_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FrstTrxn",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "first_txn_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsActive",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_activation_flag",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "days_to_first_usage",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "days_to_first_usage",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "days_to_activation",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "days_to_activation",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "dailyNumTrxns",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DailyAmount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_AccountAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_AccountAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:35Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTransactionAnalysis')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Lookup1",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderQuery": "SELECT count(*) as records FROM [Audit].[vw_load_settlement_date]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "dataset": {
                                "referenceName": "populate_AuditTransactionsLog",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "If Condition1",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "Lookup1",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@greater(activity('Lookup1').output.firstRow.records,0)",
                                "type": "Expression"
                            },
                            "ifTrueActivities": [
                                {
                                    "name": "populate_TransStaging",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "SqlDWSource",
                                            "queryTimeout": "02:00:00",
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "AzureSqlSink",
                                            "preCopyScript": "TRUNCATE TABLE [staging].[transaction_analysis_daily]",
                                            "disableMetricsCollection": false
                                        },
                                        "enableStaging": false,
                                        "parallelCopies": 4,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "account_key",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "account_number",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "settlement_date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "vw_TransactionAnalysis_Daily",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "sem_TransactionAnalysis_Daily_staging",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                },
                                {
                                    "name": "DELETE_TRANS",
                                    "type": "SqlServerStoredProcedure",
                                    "dependsOn": [
                                        {
                                            "activity": "populate_TransStaging",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "storedProcedureName": "[[sem].[s_transaction_analysis_daily_delete]"
                                    },
                                    "linkedServiceName": {
                                        "referenceName": "Consolidation",
                                        "type": "LinkedServiceReference"
                                    }
                                },
                                {
                                    "name": "populate_TransFinal",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "DELETE_TRANS",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "AzureSqlSource",
                                            "queryTimeout": "02:00:00",
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "AzureSqlSink"
                                        },
                                        "enableStaging": false,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "account_number",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "account_number",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "settlement_date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "settlement_date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "sem_TransactionAnalysis_Daily_staging",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "sem_TransactionAnalysis_Daily",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:35Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semCardholderAnalysis')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Lookup1",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderQuery": "SELECT count(*) as records FROM [Audit].[vw_load_settlement_date]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "dataset": {
                                "referenceName": "populate_AuditTransactionsLog",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "If Condition1",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "Lookup1",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@greater(activity('Lookup1').output.firstRow.records,0)",
                                "type": "Expression"
                            },
                            "ifTrueActivities": [
                                {
                                    "name": "populate_CHStaging",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "SqlDWSource",
                                            "queryTimeout": "02:00:00",
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "AzureSqlSink",
                                            "preCopyScript": "TRUNCATE TABLE [staging].[cardholder_analysis_daily]",
                                            "disableMetricsCollection": false
                                        },
                                        "enableStaging": false,
                                        "parallelCopies": 4,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "settlement_date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_outcome_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_outcome_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "vw_CardholderAnalysis_Daily",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "sem_CardholderAnalysis_Daily_staging",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                },
                                {
                                    "name": "DELETE_CH",
                                    "type": "SqlServerStoredProcedure",
                                    "dependsOn": [
                                        {
                                            "activity": "populate_CHStaging",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "storedProcedureName": "[[sem].[s_cardholder_analysis_daily_delete]"
                                    },
                                    "linkedServiceName": {
                                        "referenceName": "Consolidation",
                                        "type": "LinkedServiceReference"
                                    }
                                },
                                {
                                    "name": "populate_CHFinal",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "DELETE_CH",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "AzureSqlSource",
                                            "queryTimeout": "02:00:00",
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "AzureSqlSink"
                                        },
                                        "enableStaging": false,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "token_request_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "card_entry_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "CardPresence_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "recurring_Desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_code_outcome_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_outcome_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "sem_CardholderAnalysis_Daily_staging",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "sem_CardholderAnalysis_Daily",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:35Z"
            },
            "dependsOn": []
        }
    ]
}