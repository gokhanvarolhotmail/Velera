{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "EnterpriseDataSourceProdDF"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/Rewards_PaymentToken')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Reference table to load Payment_Token_Requestor(Wallet)",
                "activities": [
                    {
                        "name": "Rewards_Payment_Token_Data_Load",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": true,
                                    "wildcardFileName": "*",
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "SqlDWSink",
                                "preCopyScript": "truncate table [Staging].[rewards_map_wallet_payment_token_requestor]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "token_request_ID",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_ID",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_description",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_description",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "rewards_sub_type",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "rewards_sub_type",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "rewards_sub_type_code",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "rewards_sub_type_code",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "load_date",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "load_date",
                                            "type": "DateTime",
                                            "physicalType": "date"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "load_by",
                                            "type": "String",
                                            "physicalType": "String"
                                        },
                                        "sink": {
                                            "name": "load_by",
                                            "type": "String",
                                            "physicalType": "nvarchar"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Reference_Payment_Token",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Ref_Payment_Token",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "s_rewards_map_wallet_payment_token_requestor",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Rewards_Payment_Token_Data_Load",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[Staging].[s_rewards_map_wallet_payment_token_requestor]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidated_DW",
                            "type": "LinkedServiceReference"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "ReferenceData/Rewards"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-17T03:59:31Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_CountryCodeSubdivision')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzCountryCodeSubdivision_Meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'CountryCodeSubdivision')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzCountryCodeSubdivision",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_CountryCodeSubdivision",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDrpZoneFile",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzCountryCodeSubdivision",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [
                    "Chargebacks"
                ],
                "lastPublishTime": "2020-10-09T22:34:54Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_Interchange')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_drpReferenceInterchange_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "CopyInterchange",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings",
                                                "compressionProperties": {
                                                    "type": "ZipDeflateReadSettings",
                                                    "preserveZipFileNameAsFolder": false
                                                }
                                            }
                                        },
                                        "sink": {
                                            "type": "DelimitedTextSink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings"
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextWriteSettings",
                                                "quoteAllText": true,
                                                "fileExtension": ".csv"
                                            }
                                        },
                                        "enableStaging": false
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "src_drpReferenceInterchange",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "fileName": {
                                                    "value": "@item().name",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "snk_rawReferenceInterchange",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "fileName": {
                                                    "value": "@item().name",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "name": "DeleteDropZone",
                                    "type": "Delete",
                                    "dependsOn": [
                                        {
                                            "activity": "CopyInterchange",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataset": {
                                            "referenceName": "src_drpReferenceInterchange",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "fileName": {
                                                    "value": "@item().name",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        "enableLogging": false,
                                        "storeSettings": {
                                            "type": "AzureBlobFSReadSettings",
                                            "recursive": false
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "FIS/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2021-07-30T22:10:08Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_CountryCode')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzCountryCode_Meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'CountryCode')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzCountryCode",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_CountryCode",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDrpZoneFile",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzCountryCode",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [
                    "Chargebacks"
                ],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_PaymentTokenRequest')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "droptoraw_PaymentTokenRequest_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'paymenttokenrequestor')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "src_drpPaymentTokenRequestor",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "snk_rawPaymentTokenRequestor",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDropFile",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "src_drpPaymentTokenRequestor",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "ReferenceData"
                },
                "annotations": [],
                "lastPublishTime": "2020-09-14T20:05:17Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semDigitalTransactionAnalysis_singleDay')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "populate_TransStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_analysis_daily_Days_Data_noFilter_dci]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.ProcessDate",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeV2Sink",
                                "preCopyScript": "truncate table stage.transaction_analysis_daily_dci",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/SnowflakeStage"
                            },
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_key",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "days_to_transacts",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "days_to_transact",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "digital_card_issued_ind",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "digital_card_issued_ind",
                                            "type": "Boolean"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionAnalysis_Daily_NoFilter_dci",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_Stage_Transaction_Analysis_Daily_DCI",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "populate_TransFinal",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Delete TRANS",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeV2Source",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeV2Sink",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/SnowflakeStage"
                            },
                            "parallelCopies": 8,
                            "dataIntegrationUnits": 16,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "ACCOUNT_KEY",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_KEY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DAYS_TO_TRANSACT",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "DAYS_TO_TRANSACT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DIGITAL_CARD_ISSUED_IND",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "DIGITAL_CARD_ISSUED_IND",
                                            "type": "Boolean"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_SF_Stage_Transaction_Analysis_Daily_DCI",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_SEM_Transaction_Analysis_DCI",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Delete TRANS",
                        "description": "Delete rows from snowflake table.",
                        "type": "Script",
                        "dependsOn": [
                            {
                                "activity": "populate_TransStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "linkedServiceName": {
                            "referenceName": "LS_SF_CONSOLIDATE",
                            "type": "LinkedServiceReference"
                        },
                        "typeProperties": {
                            "scripts": [
                                {
                                    "type": "NonQuery",
                                    "text": {
                                        "value": "use database CONSOLIDATE;\nuse schema SEM;\ndelete from transaction_analysis_daily_dci\nwhere \nsettlement_date = '@{pipeline().parameters.ProcessDate}';",
                                        "type": "Expression"
                                    }
                                }
                            ]
                        }
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "ProcessDate": {
                        "type": "string",
                        "defaultValue": "1/1/2019"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Daily"
                },
                "annotations": [],
                "lastPublishTime": "2025-01-17T02:10:10Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semOnboardingAnalysis_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "pop_OnboardStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "isolationLevel": "ReadUncommitted",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.ONBOARDING_ANALYSIS_STAGE",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "CONTINUE"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ISSUE_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "activation_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ACTIVATION_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "expiration_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "EXPIRATION_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "first_txn_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "FIRST_TXN_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_OnboardingAnalysis",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_OnboardingAnalys_Stage",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "SEM OnboardAnalysis To Archive OnboardAnalysis",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "pop_OnboardStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.ARCHIVE.ONBOARDING_ANALYSIS_ARCHIVE",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "CONTINUE"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ISSUE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ISSUE_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTIVATION_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ACTIVATION_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EXPIRATION_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "EXPIRATION_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FIRST_TXN_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "FIRST_TXN_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_SEM_OnboardingAnalysis",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_ARCHIVE_OnboardingAnalysis_Archive",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "STAGE OnboardAnalysis To SEM OnboardAnalysis_copy1",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SEM OnboardAnalysis To Archive OnboardAnalysis",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.SEM.ONBOARDING_ANALYSIS",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "CONTINUE"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ISSUE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ISSUE_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTIVATION_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ACTIVATION_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EXPIRATION_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "EXPIRATION_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FIRST_TXN_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "FIRST_TXN_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_OnboardingAnalys_Stage",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_OnboardingAnalysis",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SnowFlake/Demographic"
                },
                "annotations": [],
                "lastPublishTime": "2024-11-22T02:57:34Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semCardUsageAnalysis_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "pop_CardUsageStaging_preagg",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "pop_CardUsageStaging_monthly",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "03:00:00",
                                "isolationLevel": "ReadUncommitted",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.CARDUSAGE_ANALYSIS_PREAGG_STAGE",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "CONTINUE"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "active_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "not_activated_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "active_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "not_activated_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_CardUsageAnalysis_preagg",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_CardUsageAnalysisPREAGG_Stage",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "pop_CardUsageStaging_monthly",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "03:00:00",
                                "isolationLevel": "ReadUncommitted",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.CARDUSAGE_ANALYSIS_MONTHLY_STAGE",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "CONTINUE"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "active_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "not_activated_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "active_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "not_activated_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_CardUsageAnalysis_monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_CardUsageAnalysisMonthly_Stage",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Move Stage To SEM CardUsage PreAGG",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Move SEM To ArchiveCardUsage PreAGG_copy1",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.SEM.CARDUSAGE_ANALYSIS_PREAGG;\n\n",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "CONTINUE"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTIVE_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NOT_ACTIVATED_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTIVE_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NOT_ACTIVATED_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_CardUsageAnalysisPREAGG_Stage",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_CardUsageAnalysisPREAGG",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Move SEM To ArchiveCardUsage PreAGG_copy1",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "pop_CardUsageStaging_preagg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.ARCHIVE.CARDUSAGE_ANALYSIS_PREAGG_ARCHIVE;\n\n",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "CONTINUE"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTIVE_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NOT_ACTIVATED_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTIVE_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NOT_ACTIVATED_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_SEM_CardUsageAnalysisPREAGG",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_ARCHIVE_CardUsageAnalysisPREAGG_Archive",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Move SEM To ArchiveCardUsageAnalysisMonthly",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "pop_CardUsageStaging_monthly",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.ARCHIVE.CARDUSAGE_ANALYSIS_MONTHLY_ARCHIVE\n\n",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "CONTINUE"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTIVE_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NOT_ACTIVATED_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTIVE_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NOT_ACTIVATED_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_SEM_CardUsageAnalysisMonthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_ARCHIVE_CardUsageAnalysisMonthly_Archive",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Move Stage To SEM CardUsageAnalysisMonthly",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Move SEM To ArchiveCardUsageAnalysisMonthly",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.SEM.CARDUSAGE_ANALYSIS_MONTHLY\n\n",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "CONTINUE"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTIVE_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NOT_ACTIVATED_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTIVE_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "ACTIVE_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NOT_ACTIVATED_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NOT_ACTIVATED_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_CardUsageAnalysisMonthly_Stage",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_CardUsageAnalysisMonthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "report_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SnowFlake/Demographic"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T15:17:15Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semCardholderDeclineAnalysis_singleMonth_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "DeclineToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_cardholder_decline_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "truncate table CONSOLIDATE.STAGE.CARDHOLDER_DECLINE_ANALYSIS_MONTHLY_STAGE",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "ABORT_STATEMENT"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ORIGIN_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RESPONSE_CODE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RESPONSE_CODE_OUTCOME_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANT_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANT_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_CardholderDeclineAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_CARDHOLDER_DECLINE_ANALYSIS_MONTHLY_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Decline_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DeclineToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": {
                                    "value": "@{concat('Delete From CONSOLIDATE.SEM.CARDHOLDER_DECLINE_ANALYSIS_MONTHLY\nwhere ORIGIN_DATE =''',pipeline().parameters.start_date,'''',' OR ORIGIN_DATE <  (Select DATEADD(month,-25, MAX(ORIGIN_DATE)) from CONSOLIDATE.SEM.CARDHOLDER_DECLINE_ANALYSIS_MONTHLY)')}",
                                    "type": "Expression"
                                },
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ORIGIN_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ORIGIN_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RESPONSE_CODE_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RESPONSE_CODE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RESPONSE_CODE_OUTCOME_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RESPONSE_CODE_OUTCOME_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MERCHANT_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANT_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MERCHANT_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANT_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_CARDHOLDER_DECLINE_ANALYSIS_MONTHLY_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_CARDHOLDER_DECLINE_ANALYSIS_MONTHLY",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SnowFlake/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T15:14:59Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTransactionAnalysis_singleDay_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "populate_TransStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_analysis_daily_Days_Data_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.ProcessDate",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.TRANSACTION_ANALYSIS_DAILY_STAGE;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "ABORT_STATEMENT"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "parallelCopies": 4,
                            "enableSkipIncompatibleRow": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionAnalysis_Daily_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "SnowFlake_STAGE_TransactionAnalysisDaily_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "populate_TransFinal",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "populate_TransStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "Select * From CONSOLIDATE.STAGE.TRANSACTION_ANALYSIS_DAILY_STAGE\nOrder by client_id, settlement_date",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": {
                                    "value": "@{concat('Delete From CONSOLIDATE.SEM.TRANSACTION_ANALYSIS_DAILY\nwhere settlement_date =''',pipeline().parameters.ProcessDate,'''',' OR settlement_date <  (Select DATEADD(month,-13, MAX(settlement_date)) from sem.transaction_analysis_daily)')}",
                                    "type": "Expression"
                                },
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "parallelCopies": 8,
                            "dataIntegrationUnits": 16,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "SnowFlake_STAGE_TransactionAnalysisDaily_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_TRANSACTION_ANALYSIS_DAILY",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "ProcessDate": {
                        "type": "string",
                        "defaultValue": "1/5/2020"
                    }
                },
                "folder": {
                    "name": "SnowFlake/Daily"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-29T15:03:36Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTransactionAnalysis_singleMonth_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "TransToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.TRANSACTION_ANALYSIS_MONTHLY_STAGE;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "ABORT_STATEMENT"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_TransactionAnalysisMonthly_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "TransToStaging_noaccount",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_analysis_monthly_no_account_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.TRANSACTION_ANALYSIS_MONTHLY_NO_ACCOUNT_STAGE;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "ABORT_STATEMENT"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionsAnalysis_Monthly_NoAccount",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_TransactionAnalysisMonthly_NoAccount_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Trans_StagingToMain_noaccount",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "TransToStaging_noaccount",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": {
                                    "value": "@{concat('Delete From CONSOLIDATE.SEM.TRANSACTION_ANALYSIS_MONTHLY_NO_ACCOUNT\nwhere settlement_date =''',pipeline().parameters.start_date,'''',' OR settlement_date <  (Select DATEADD(month,-25, MAX(settlement_date)) from CONSOLIDATE.SEM.TRANSACTION_ANALYSIS_MONTHLY_NO_ACCOUNT)')}",
                                    "type": "Expression"
                                },
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_YEAR",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_YEAR",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_MONTH",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_MONTH",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_TransactionAnalysisMonthly_NoAccount_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_TransactionAnalysis_Monthly_NoAccount",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Trans_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "TransToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "Select * From CONSOLIDATE.STAGE.TRANSACTION_ANALYSIS_MONTHLY_STAGE\nOrder By client_id, settlement_date",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": {
                                    "value": "@{concat('Delete From CONSOLIDATE.SEM.TRANSACTION_ANALYSIS_MONTHLY\nwhere settlement_date =''',pipeline().parameters.start_date,'''',' OR settlement_date <  (Select DATEADD(month,-25, MAX(settlement_date)) from sem.transaction_analysis_monthly)')}",
                                    "type": "Expression"
                                },
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_ENTRY_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RECURRING_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDPRESENCE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_TransactionAnalysisMonthly_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_Transaction_Analysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string",
                        "defaultValue": "01/01/2020"
                    }
                },
                "folder": {
                    "name": "SnowFlake/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T15:20:53Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semATMTransactionAnalysis_singleMonth_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ATMTransactionToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_atm_transaction_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.ATM_TRANSACTION_ANALYSIS_MONTHLY_STAGE",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "ABORT_STATEMENT"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ON_US_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_KEY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_income_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INCOME_AMOUNT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_ATMTransactionAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_AtmTransactionAnalysisMonthly_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "ATMTransaction_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "ATMTransactionToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "Select * From CONSOLIDATE.STAGE.ATM_TRANSACTION_ANALYSIS_MONTHLY_STAGE\nOrder By client_id, settlement_date",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": {
                                    "value": "@{concat('Delete From CONSOLIDATE.SEM.ATM_TRANSACTION_ANALYSIS_MONTHLY\n where settlement_date =''',pipeline().parameters.start_date,'''',' OR settlement_date <  (Select DATEADD(month,-25, MAX(settlement_date)) from CONSOLIDATE.SEM.ATM_TRANSACTION_ANALYSIS_MONTHLY)')}",
                                    "type": "Expression"
                                },
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ON_US_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ON_US_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERMINAL_KEY",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_KEY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INCOME_AMOUNT",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SUM_INCOME_AMOUNT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_AtmTransactionAnalysisMonthly_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_Atm_Transaction_Analysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SnowFlake/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T15:12:35Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTransactionVolumeAnalysis_singleMonth_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "VolumeToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_volume_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.TRANSACTION_VOLUME_ANALYSIS_MONTHLY_STAGE",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "ABORT_STATEMENT"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionSummaryAnalysis_Monthly_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_TransactionVolumeAnalysisMonthly_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Volume_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "VolumeToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "Select * From CONSOLIDATE.STAGE.TRANSACTION_VOLUME_ANALYSIS_MONTHLY_STAGE\nOrder By client_id, settlement_date",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": {
                                    "value": "@{concat('Delete From CONSOLIDATE.SEM.TRANSACTION_VOLUME_ANALYSIS_MONTHLY\nwhere settlement_date =''',pipeline().parameters.start_date,'''',' OR settlement_date <  (Select DATEADD(month,-25, MAX(settlement_date)) from CONSOLIDATE.SEM.TRANSACTION_VOLUME_ANALYSIS_MONTHLY)')}",
                                    "type": "Expression"
                                },
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_TransactionVolumeAnalysisMonthly_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_TRANSACTION_VOLUME_ANALYSIS_MONTHLY",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SnowFlake/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T15:22:38Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTransactionSpendAnalysis_singleMonth_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SpendToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_spend_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.TRANSACTION_SPEND_ANALYSIS_MONTHLY_STAGE",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "ABORT_STATEMENT"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionSummaryAnalysis_Monthly_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_TransactionSpendAnalysisMonthly_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Spend_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SpendToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "Select * From CONSOLIDATE.STAGE.TRANSACTION_SPEND_ANALYSIS_MONTHLY_STAGE\nOrder by client_id, settlement_date",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": {
                                    "value": "@{concat('Delete From CONSOLIDATE.SEM.TRANSACTION_SPEND_ANALYSIS_MONTHLY\nwhere settlement_date =''',pipeline().parameters.start_date,'''',' OR settlement_date <  (Select DATEADD(month,-25, MAX(settlement_date)) from CONSOLIDATE.SEM.TRANSACTION_SPEND_ANALYSIS_MONTHLY)')}",
                                    "type": "Expression"
                                },
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_TransactionSpendAnalysisMonthly_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_TransactionSpendAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SnowFlake/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2024-11-22T02:59:04Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semATMTerminalAnalysis_singleMonth_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ATMTerminalToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_atm_terminal_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.ATM_TERMINAL_ANALYSIS_MONTHLY_STAGE",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "ABORT_STATEMENT"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ON_US_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_KEY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_CITY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_STATE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_ZIPCODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_COUNTRY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_income_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INCOME_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_ATMTerminalAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_AtmTerminalAnalysisMonthly_Stage",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "ATMTerminal_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "ATMTerminalToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": {
                                    "value": "@{concat('Delete From CONSOLIDATE.SEM.ATM_TERMINAL_ANALYSIS_MONTHLY\nwhere settlement_date =''',pipeline().parameters.start_date,'''',' OR settlement_date <  (Select DATEADD(month,-25, MAX(settlement_date)) from CONSOLIDATE.SEM.ATM_TERMINAL_ANALYSIS_MONTHLY)')}",
                                    "type": "Expression"
                                },
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ON_US_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ON_US_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERMINAL_KEY",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_KEY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERMINAL_CITY",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_CITY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERMINAL_STATE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_STATE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERMINAL_ZIPCODE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_ZIPCODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERMINAL_COUNTRY",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL_COUNTRY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INCOME_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INCOME_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_AtmTerminalAnalysisMonthly_Stage",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_ATMTerminalAnalysisMonthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SnowFlake/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T15:11:47Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semMerchantCategoryAnalysis_singleMonth_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ToStaging_MerchCat",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_merchant_category_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "Truncate Table CONSOLIDATE.STAGE.MERCHANT_CATEGORY_ANALYSIS_MONTHLY_STAGE",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand",
                                    "additionalCopyOptions": {
                                        "ON_ERROR": "ABORT_STATEMENT"
                                    }
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANT_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANT_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "digital_card_issued_ind",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DIGITAL_CARD_ISSUED_IND",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_MerchantCategory_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_STAGE_MerchantCategoryAnalysisMonthly_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "StagingToMain_MerchCat",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "ToStaging_MerchCat",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "Select * From CONSOLIDATE.STAGE.MERCHANT_CATEGORY_ANALYSIS_MONTHLY_STAGE\nOrder By client_id, settlement_date",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": {
                                    "value": "@{concat('Delete From CONSOLIDATE.SEM.MERCHANT_CATEGORY_ANALYSIS_MONTHLY\nwhere settlement_date =''',pipeline().parameters.start_date,'''',' OR settlement_date <  (Select DATEADD(month,-25, MAX(settlement_date)) from CONSOLIDATE.SEM.MERCHANT_CATEGORY_ANALYSIS_MONTHLY)')}",
                                    "type": "Expression"
                                },
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SETTLEMENT_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NETWORK_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MERCHANT_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANT_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MERCHANT_GROUP",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANT_GROUP",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_TRANSACTION_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_SETTLEMENT_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "SUM_INTERCHANGE_AMOUNT",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "CNT_TRANSACTIONS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DIGITAL_CARD_ISSUED_IND",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DIGITAL_CARD_ISSUED_IND",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "Snowflake_STAGE_MerchantCategoryAnalysisMonthly_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Snowflake_SEM_MerchantCategoryAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SnowFlake/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T15:18:03Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/process_User_bkup')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_drpUser",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach1",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "CopyToRaw",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "wildcardFileName": {
                                                    "value": "@{item().name}",
                                                    "type": "Expression"
                                                },
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "DelimitedTextSink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings"
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextWriteSettings",
                                                "quoteAllText": true,
                                                "fileExtension": ".csv"
                                            }
                                        },
                                        "enableStaging": false
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "src_drpUser",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "snk_rawUser",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                },
                                {
                                    "name": "CopyToConsolidation",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "CopyToRaw",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": true,
                                                "wildcardFileName": {
                                                    "value": "@{item().name}",
                                                    "type": "Expression"
                                                },
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "AzureSqlSink",
                                            "preCopyScript": "TRUNCATE TABLE [staging].[user]",
                                            "disableMetricsCollection": false
                                        },
                                        "enableStaging": false,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "ClientID",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "ClientID",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "BINID",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "BINID",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "UserName",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "UserName",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "BIN",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "BIN",
                                                        "type": "String"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "snk_rawUser",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "dest_Staging_User_Consolidation",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                },
                                {
                                    "name": "CopyToProcessed",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "Stored procedure2",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        },
                                        {
                                            "activity": "partition_switch_user_consolidation",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": true,
                                                "wildcardFileName": {
                                                    "value": "@{item().name}",
                                                    "type": "Expression"
                                                },
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "DelimitedTextSink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings"
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextWriteSettings",
                                                "quoteAllText": true,
                                                "fileExtension": ".csv"
                                            }
                                        },
                                        "enableStaging": false
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "snk_rawUser",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "snk_rawUser_processed",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                },
                                {
                                    "name": "DeleteFromDrop",
                                    "type": "Delete",
                                    "dependsOn": [
                                        {
                                            "activity": "CopyToProcessed",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataset": {
                                            "referenceName": "src_drpUser",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        },
                                        "enableLogging": false,
                                        "storeSettings": {
                                            "type": "AzureBlobFSReadSettings",
                                            "recursive": true,
                                            "wildcardFileName": {
                                                "value": "@{item().name}",
                                                "type": "Expression"
                                            }
                                        }
                                    }
                                },
                                {
                                    "name": "DeleteFromRaw",
                                    "type": "Delete",
                                    "dependsOn": [
                                        {
                                            "activity": "CopyToProcessed",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataset": {
                                            "referenceName": "snk_rawUser",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        },
                                        "enableLogging": false,
                                        "storeSettings": {
                                            "type": "AzureBlobFSReadSettings",
                                            "recursive": false,
                                            "wildcardFileName": {
                                                "value": "@{item().name}",
                                                "type": "Expression"
                                            }
                                        }
                                    }
                                },
                                {
                                    "name": "CopyToMerchantAndCardholder",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "CopyToRaw",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": true,
                                                "wildcardFileName": {
                                                    "value": "@{item().name}",
                                                    "type": "Expression"
                                                },
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "AzureSqlSink",
                                            "preCopyScript": "TRUNCATE TABLE [staging].[user]",
                                            "disableMetricsCollection": false
                                        },
                                        "enableStaging": false,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "ClientID",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "ClientID",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "BINID",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "BINID",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "UserName",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "UserName",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "BIN",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "BIN",
                                                        "type": "String"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "snk_rawUser",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "dest_staging_User_MerchantandCardholder",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                },
                                {
                                    "name": "partition_switch_user_consolidation",
                                    "type": "SqlServerStoredProcedure",
                                    "dependsOn": [
                                        {
                                            "activity": "CopyToConsolidation",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "storedProcedureName": "[[staging].[p_switch_user]"
                                    },
                                    "linkedServiceName": {
                                        "referenceName": "Consolidation",
                                        "type": "LinkedServiceReference"
                                    }
                                },
                                {
                                    "name": "Stored procedure2",
                                    "type": "SqlServerStoredProcedure",
                                    "dependsOn": [
                                        {
                                            "activity": "CopyToMerchantAndCardholder",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "storedProcedureName": "[[staging].[p_switch_user]"
                                    },
                                    "linkedServiceName": {
                                        "referenceName": "MerchantandCardholder",
                                        "type": "LinkedServiceReference"
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "All Master Pipelines/Dimension Masters"
                },
                "annotations": [],
                "lastPublishTime": "2020-09-21T21:24:37Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_InterchangeRaw')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "populate_InterchangeRaw",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "additionalColumns": [
                                    {
                                        "name": "file_name",
                                        "value": {
                                            "value": "@pipeline().parameters.fileName",
                                            "type": "Expression"
                                        }
                                    },
                                    {
                                        "name": "processed",
                                        "value": {
                                            "value": "0",
                                            "type": "Expression"
                                        }
                                    },
                                    {
                                        "name": "create_date",
                                        "value": {
                                            "value": "@formatDateTime(utcnow(),'MM/dd/yyyy HH:mm:ss')",
                                            "type": "Expression"
                                        }
                                    }
                                ],
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings",
                                    "skipLineCount": 1
                                }
                            },
                            "sink": {
                                "type": "SqlDWSink",
                                "preCopyScript": {
                                    "value": "@{concat('DELETE [Staging].[FIS_Interchange_RAW] where [file_name] = ''',string(pipeline().parameters.fileName),'''')}",
                                    "type": "Expression"
                                },
                                "allowPolyBase": true,
                                "polyBaseSettings": {
                                    "rejectValue": 0,
                                    "rejectType": "value",
                                    "useTypeDefault": true
                                },
                                "disableMetricsCollection": false
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/FIS/ReferenceFile",
                                "enableCompression": true
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 1
                                        },
                                        "sink": {
                                            "name": "PAN",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 2
                                        },
                                        "sink": {
                                            "name": "SWITCH DATE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 3
                                        },
                                        "sink": {
                                            "name": "LOCAL DATE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 4
                                        },
                                        "sink": {
                                            "name": "DEBIT AMOUNT",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 5
                                        },
                                        "sink": {
                                            "name": "CREDIT AMOUNT",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 6
                                        },
                                        "sink": {
                                            "name": "MEMO AMOUNT",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 7
                                        },
                                        "sink": {
                                            "name": "TERMINAL INTERCHANGE FEE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 8
                                        },
                                        "sink": {
                                            "name": "SIGN7",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 9
                                        },
                                        "sink": {
                                            "name": "CARDHOLDER INTERCHANGE FEE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 10
                                        },
                                        "sink": {
                                            "name": "SIGN9",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 11
                                        },
                                        "sink": {
                                            "name": "ACQ",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 12
                                        },
                                        "sink": {
                                            "name": "ISS",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 13
                                        },
                                        "sink": {
                                            "name": "TERM INST",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 14
                                        },
                                        "sink": {
                                            "name": "CARD INST",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 15
                                        },
                                        "sink": {
                                            "name": "TRAN TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 16
                                        },
                                        "sink": {
                                            "name": "TRAN ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 17
                                        },
                                        "sink": {
                                            "name": "RRN",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 18
                                        },
                                        "sink": {
                                            "name": "SEQ NO",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 19
                                        },
                                        "sink": {
                                            "name": "ACQ/ISS",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 20
                                        },
                                        "sink": {
                                            "name": "ACTION CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 21
                                        },
                                        "sink": {
                                            "name": "TRANSACTION DESCRIPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 22
                                        },
                                        "sink": {
                                            "name": "REV REASON",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 23
                                        },
                                        "sink": {
                                            "name": "REJ REASON",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 24
                                        },
                                        "sink": {
                                            "name": "TRACE DATA",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 25
                                        },
                                        "sink": {
                                            "name": "Prop_24",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "type": "String",
                                            "ordinal": 26
                                        },
                                        "sink": {
                                            "name": "Prop_25",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "file_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "file_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "processed",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "processed",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_date",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "create_date",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "src_rawInterchange",
                                "type": "DatasetReference",
                                "parameters": {
                                    "fileName": {
                                        "value": "@pipeline().parameters.fileName",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "dw_FISInterchangeRaw",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "populate_InvalidInterchange",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "populate_InterchangeRaw",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderQuery": {
                                    "value": "@concat('Select * from Staging.FIS_Interchange_RAW where PAN like ''%XXXX%'' and [file_name] = ''',string(pipeline().parameters.fileName),'''')",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SqlDWSink",
                                "allowPolyBase": true,
                                "polyBaseSettings": {
                                    "rejectValue": 0,
                                    "rejectType": "value",
                                    "useTypeDefault": true
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/FIS/Interchange",
                                "enableCompression": true
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "ROWID",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "ROWID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PAN",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PAN",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SWITCH DATE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SWITCH DATE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOCAL DATE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOCAL DATE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DEBIT AMOUNT",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DEBIT AMOUNT",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREDIT AMOUNT",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREDIT AMOUNT",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MEMO AMOUNT",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MEMO AMOUNT",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERMINAL INTERCHANGE FEE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERMINAL INTERCHANGE FEE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SIGN7",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SIGN7",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDHOLDER INTERCHANGE FEE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDHOLDER INTERCHANGE FEE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SIGN9",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SIGN9",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACQ",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACQ",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ISS",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ISS",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERM INST",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERM INST",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARD INST",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD INST",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRAN TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRAN TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRAN ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRAN ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RRN",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "RRN",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SEQ NO",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SEQ NO",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACQ/ISS",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACQ/ISS",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACTION CODE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACTION CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION DESCRIPTION",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION DESCRIPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "REV REASON",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REV REASON",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "REJ REASON",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REJ REASON",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRACE DATA",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRACE DATA",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Prop_24",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Prop_24",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Prop_25",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Prop_25",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "file_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "file_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "create_date",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "create_date",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "dw_FISInterchangeRaw",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "populate_AuditInvalidInterchange",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "fileName": {
                        "type": "string",
                        "defaultValue": "FX08303.D200118.CUSA.INTGPULS.ZIP"
                    }
                },
                "folder": {
                    "name": "FIS"
                },
                "annotations": [],
                "lastPublishTime": "2021-07-30T22:10:08Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDATMList')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "drp_FDATMList_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "BinaryReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "moveDrpToRaw_copy",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "BinarySource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "deleteFilesAfterCompletion": true
                                            },
                                            "formatSettings": {
                                                "type": "BinaryReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "BinarySink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings"
                                            }
                                        },
                                        "enableStaging": false
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "drp_FDATMList",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "fileName": {
                                                    "value": "@item().name",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "snk_rawFDATMList",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "fileName": {
                                                    "value": "@item().name",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDParReference')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "drp_FDParReference_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "BinaryReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "moveDrpToRaw_copy",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "BinarySource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "deleteFilesAfterCompletion": true
                                            },
                                            "formatSettings": {
                                                "type": "BinaryReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "BinarySink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings"
                                            }
                                        },
                                        "enableStaging": false
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "drp_FDParReference",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "fileName": {
                                                    "value": "@item().name",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "snk_rawFDPrinReference",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "fileName": {
                                                    "value": "@item().name",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        }
    ]
}