{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "EnterpriseDataSourceProdDF"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/PL_droptoRaw_Rewards_Response_Error')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "getMeta_Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ADLS_dropZone_Rewards_Demographic",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "forEach_ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "getMeta_Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('getMeta_Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "if_If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'COOP_OB_Member_Errors')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "copy_moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "DS_ADLS_dropZoneDemographics_Rewards",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "DS_ABLB_rawRewardsDemographicError",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "delete_DeleteDrop_Response",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "copy_moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "DS_ADLS_dropZoneDemographics_Rewards",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "Rewards/Response_Master"
                },
                "annotations": [
                    "Rewards"
                ],
                "lastPublishTime": "2022-05-17T21:34:20Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Rewards_ProgramBINs_to_SF_Daily')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Copies data from ASQL Rewards to Rewards schema in Snowflake Application_DB.",
                "activities": [
                    {
                        "name": "Copy_RewardsProgramBINs_to_SF",
                        "description": "Copies data from ASQL Rewards.dbo.RewardsProgramBINs to Rewards schema in Snowflake Application_DB.",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSPROGRAMBINS;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "RewardsProgramBINId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMBINID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsProgramId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATEDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATEBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "MODIFYDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MODIFYBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SourceCodeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "SOURCECODEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Status",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "STATUS",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DeleteDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DELETEDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DeleteBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DELETEBY",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsProgramBINs",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsProgramBINs",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_RewardsProgramBINExtensions_to_SF",
                        "description": "Copies data from ASQL Rewards.dbo.RewardsProgramBINExtensions to Rewards schema in Snowflake Application_DB.",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy_RewardsProgramBINs_to_SF",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSPROGRAMBINEXTENSIONS",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "RewardsProgramBINExtensionId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMBINEXTENSIONID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsProgramBINId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMBINID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Extension",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EXTENSION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATEDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATEBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "MODIFYDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MODIFYBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SourceCodeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "SOURCECODEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Status",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "STATUS",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DeleteDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DELETEDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DeleteBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DELETEBY",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsProgramBINExtensions",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsProgramBINExtensions",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_RewardsPrograms",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy_RewardsProgramBINExtensions_to_SF",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT\n[RewardsProgramId],\n\t[RewardsConfigurationId],\n\t[RewardsProgramTypeId],\n\t[RewardsTypeId],\n\t[RewardsRoundingRuleId],\n\t[RewardsProgramURL],\n\t[RewardsProgramExternalId],\n\t[StartDate],\n\t[EndDate],\n\t[CreateDate],\n\t[CreateBy],\n\t[ModifyDate],\n\t[ModifyBy],\n\t[ProgramCode]\n\t,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\nfrom [dbo].[RewardsPrograms]\n",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSPROGRAMS",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "RewardsProgramId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsConfigurationId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSCONFIGURATIONID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsProgramTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsRoundingRuleId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSROUNDINGRULEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsProgramURL",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMURL",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsProgramExternalId",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMEXTERNALID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "StartDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "STARTDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EndDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ENDDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SRC_CREATEDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATEBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SRC_MODIFYDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MODIFYBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ProgramCode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PROGRAMCODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsPrograms",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_REWARDSPROGRAMS",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SnowFlake/Rewards"
                },
                "annotations": [
                    "Rewards"
                ],
                "lastPublishTime": "2024-10-30T14:30:50Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Rewards_Configuration_to_SF_Weekly')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Copies data from ASQL Rewards to Rewards schema in Snowflake Application_DB.",
                "activities": [
                    {
                        "name": "Copy_RewardsConfiguration_to_SF",
                        "description": "Copies data from ASQL Rewards.dbo.RewardsConfiguration to Rewards schema in Snowflake Application_DB.",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT \nRewardsConfigurationId ,\n\tClientId  ,\n\tClientNumber ,\n\tEnableRewardsAPI,\n\tCashbackSourceAccountTypeId ,\n\tCashbackFundingAccountNumber ,\n\tCashbackRoutingTransitNumber ,\n\tCashbackMethodId ,\n\tCallCenter800Number ,\n\tCreateBy ,\n\tCreateDate ,\n\tModifyBy,\n\tModifyDate ,\n\tCashbackMethodTestId ,\n\tMerchantName ,\n   MerchantNumber,\n\tSftpLocation,\n\tExternalOrgId ,\nCURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n\nfrom [dbo].[RewardsConfiguration]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE APPLICATION_DB.REWARDS.REWARDSCONFIGURATION ",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "RewardsConfigurationId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSCONFIGURATIONID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ClientId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CLIENTID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ClientNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENTNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EnableRewardsAPI",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "ENABLEREWARDSAPI",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CashbackSourceAccountTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CASHBACKSOURCEACCOUNTTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CashbackFundingAccountNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CASHBACKFUNDINGACCOUNTNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CashbackRoutingTransitNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CASHBACKROUTINGTRANSITNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CashbackMethodId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CASHBACKMETHODID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CallCenter800Number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CALLCENTER800NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATEBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATEDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MODIFYBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "MODIFYDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CashbackMethodTestId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CASHBACKMETHODTESTID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MerchantName",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANTNAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MerchantNumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANTNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SftpLocation",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SFTPLOCATION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ExternalOrgId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "EXTERNALORGID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsConfiguration",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsConfiguration",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_RewardsConfigurationStatementOptions_to_SF",
                        "description": "Copies data from ASQL Rewards.dbo.RewardsConfigurationStatementOptions to Rewards schema in Snowflake Application_DB.",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy_RewardsConfiguration_to_SF",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT RewardsConfigurationId\n      ,[RewardsStatementOptionId]\n      ,[Status]\n      ,[CreateDate]\n      ,[CreateBy]\n      ,[ModifyDate]\n      ,[ModifyBy]\n      ,[DeleteDate]\n      ,[DeleteBy]\n,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\nFROM [dbo].[RewardsConfigurationStatementOptions]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSCONFIGURATIONSTATEMENTOPTIONS",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/Snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "RewardsConfigurationId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSCONFIGURATIONID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsStatementOptionId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSSTATEMENTOPTIONID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Status",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "STATUS",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATEDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATEBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "MODIFYDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MODIFYBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DeleteDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DELETEDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DeleteBy",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DELETEBY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsConfigurationStatementOptions",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsConfigurationStatementOptions",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_RewardsProgramTypes",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Copy_RewardsConfigurationStatementOptions_to_SF",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "select [RewardsProgramTypeId],\n\t[Name],\n\t[Code],\nCURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\nfrom [dbo].[RewardsProgramTypes]\n",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSPROGRAMTYPES",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "RewardsProgramTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsProgramTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsProgramTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SnowFlake/Rewards"
                },
                "annotations": [
                    "Rewards"
                ],
                "lastPublishTime": "2024-10-30T14:31:44Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_droptoRaw_Rewards_Transaction_Error')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "getMeta_Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('getMeta_Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "if_Response File",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'COOP_OB_Transaction_Errors')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "Copy_moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "DS_ABLB_dropZone_Rewards_Transaction",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "DS_ABLB_rawRewardsTransactionError",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDrop_Response",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "Copy_moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "DS_ABLB_dropZone_Rewards_Transaction",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false,
                                                        "enablePartitionDiscovery": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "getMeta_Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ABLB_dropzone_RewardsTransaction",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "Rewards/Rewards_Transaction"
                },
                "annotations": [
                    "Rewards"
                ],
                "lastPublishTime": "2022-02-23T17:14:30Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_RecursiveCopy_MultiFiles_to_OneFile')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Recursive_Copy",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": true,
                                    "wildcardFileName": "*.csv",
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings",
                                    "copyBehavior": "MergeFiles"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ABLB_PIPE_Header_Folder",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": {
                                        "value": "@pipeline().parameters.Source_Container",
                                        "type": "Expression"
                                    },
                                    "Directory": {
                                        "value": "@pipeline().parameters.Source_Directory",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "snk_fully_parameterized",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": {
                                        "value": "@pipeline().parameters.Sink_Container",
                                        "type": "Expression"
                                    },
                                    "Directory": {
                                        "value": "@pipeline().parameters.Sink_Directory",
                                        "type": "Expression"
                                    },
                                    "File": {
                                        "value": "@pipeline().parameters.Sink_FileName",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Source_Container": {
                        "type": "string",
                        "defaultValue": "raw"
                    },
                    "Source_Directory": {
                        "type": "string",
                        "defaultValue": "Visa/ChargeBack/"
                    },
                    "Sink_Container": {
                        "type": "string",
                        "defaultValue": "stage"
                    },
                    "Sink_Directory": {
                        "type": "string",
                        "defaultValue": "VISA/ChargeBack/Current/"
                    },
                    "Sink_FileName": {
                        "type": "string",
                        "defaultValue": "UpdatedVisa.csv"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2022-02-23T00:22:15Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Zelle_AuditLog')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "sp_s_zelle_File_Audit_Log",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[Staging].[s_zelle_File_Audit_Log]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidated_DW",
                            "type": "LinkedServiceReference"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Zelle"
                },
                "annotations": [],
                "lastPublishTime": "2022-04-01T00:38:38Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Cardholder_Sys_Reward_Admin')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "sp_s_insert_Cardholder_Sys_Reward_Admin",
                        "description": "sp to refresh data in member.Cardholder_Sys_Reward_Admin",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[Member].[s_insert_Cardholder_Sys_Reward_Admin]"
                        },
                        "linkedServiceName": {
                            "referenceName": "DataWarehouse",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Lookup menberCardholder_Sys_Reward_Admin",
                        "description": "Refresh and build the table member.Cardholder_Sys_Reward_Admin",
                        "type": "Lookup",
                        "dependsOn": [
                            {
                                "activity": "sp_s_insert_Cardholder_Sys_Reward_Admin",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "dataset": {
                                "referenceName": "DS_ASDW_Member_Cardholder_Sys_Reward_Admin",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Rewards"
                },
                "annotations": [],
                "lastPublishTime": "2022-03-01T22:13:46Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_RawToStage_FeedzAI')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "metaGetYears",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Object",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "varSetLatestYear",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterYears",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Year",
                            "value": {
                                "value": "@last(activity('filterYears').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "metaGetMonths",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "varSetLatestYear",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Year",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "varSetLatestMonth",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterMonths",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Month",
                            "value": {
                                "value": "@last(activity('filterMonths').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "metaGetDays",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "varSetLatestMonth",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Month",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('var_Month')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "LatestDay",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterDays",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Day",
                            "value": {
                                "value": "@last(activity('filterDays').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterYears",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetYears",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetYears').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@startswith(item().name,'20')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterMonths",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetMonths",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetMonths').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@and(greater(item().name,'0'),less(item().name,'13'))",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterDays",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetDays",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetDays').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@and(greater(item().name,'0'),less(item().name,'32'))",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "validationFileExists",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "LatestDay",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('var_Month')",
                                        "type": "Expression"
                                    },
                                    "Directory_Day": {
                                        "value": "@variables('var_Day')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "timeout": "0.00:15:00",
                            "sleep": 30,
                            "childItems": true
                        }
                    },
                    {
                        "name": "failMissingFiles",
                        "type": "Fail",
                        "dependsOn": [
                            {
                                "activity": "validationFileExists",
                                "dependencyConditions": [
                                    "Failed"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "message": {
                                "value": "@concat('No files were found in the desired location. Location: raw/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                "type": "Expression"
                            },
                            "errorCode": "200"
                        }
                    },
                    {
                        "name": "if_validDate",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "validationFileExists",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@greater(utcnow(),formatDateTime(concat(variables('var_Year'),'-',variables('var_Month'),'-',variables('var_Day'))))",
                                "type": "Expression"
                            },
                            "ifFalseActivities": [
                                {
                                    "name": "fail_InvalidDate",
                                    "type": "Fail",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "message": "300",
                                        "errorCode": {
                                            "value": "@concat('Date of file/folder is greater than the current date/time.  Location: raw/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                            "type": "Expression"
                                        }
                                    }
                                }
                            ],
                            "ifTrueActivities": [
                                {
                                    "name": "MergeAndCopy",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "wildcardFileName": "*sv",
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "DelimitedTextSink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings",
                                                "copyBehavior": "MergeFiles"
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextWriteSettings",
                                                "quoteAllText": true,
                                                "fileExtension": ".txt"
                                            }
                                        },
                                        "enableStaging": false,
                                        "enableSkipIncompatibleRow": true,
                                        "logStorageSettings": {
                                            "linkedServiceName": {
                                                "referenceName": "EnterpriseDataSource",
                                                "type": "LinkedServiceReference"
                                            },
                                            "path": {
                                                "value": "@concat('logging/errors/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                "type": "Expression"
                                            }
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "DS_ABLB_FeedzAI_Folder",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": "raw",
                                                "Directory_Client": {
                                                    "value": "@pipeline().parameters.par_Source",
                                                    "type": "Expression"
                                                },
                                                "Directory_Type": {
                                                    "value": "@pipeline().parameters.par_Object",
                                                    "type": "Expression"
                                                },
                                                "Directory_Year": {
                                                    "value": "@variables('var_Year')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Month": {
                                                    "value": "@variables('var_Month')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Day": {
                                                    "value": "@variables('var_Day')",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "snk_fully_parameterized",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": {
                                                    "value": "@pipeline().parameters.par_destContainer",
                                                    "type": "Expression"
                                                },
                                                "Directory": {
                                                    "value": "@pipeline().parameters.par_destFilePath",
                                                    "type": "Expression"
                                                },
                                                "File": {
                                                    "value": "@pipeline().parameters.par_destFilename",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "par_Source": {
                        "type": "string",
                        "defaultValue": "Coop"
                    },
                    "par_Object": {
                        "type": "string",
                        "defaultValue": "COOPER/CardTransaction"
                    },
                    "par_destFilename": {
                        "type": "string",
                        "defaultValue": "UpdatedFeedzai.csv"
                    },
                    "par_destContainer": {
                        "type": "string",
                        "defaultValue": "stage"
                    },
                    "par_destFilePath": {
                        "type": "string",
                        "defaultValue": "Coop/COOPER/CardTransaction/Currentcsv"
                    }
                },
                "variables": {
                    "var_Year": {
                        "type": "String"
                    },
                    "var_Month": {
                        "type": "String"
                    },
                    "var_Day": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2022-03-11T22:58:00Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_RawToStage_FindLatestPath')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "metaGetYears",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Object",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "varSetLatestYear",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterYears",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Year",
                            "value": {
                                "value": "@last(activity('filterYears').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "metaGetMonths",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "varSetLatestYear",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Year",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "varSetLatestMonth",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterMonths",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Month",
                            "value": {
                                "value": "@last(activity('filterMonths').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "metaGetDays",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "varSetLatestMonth",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Month",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('var_Month')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "LatestDay",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterDays",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Day",
                            "value": {
                                "value": "@last(activity('filterDays').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterYears",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetYears",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetYears').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@startswith(item().name,'20')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterMonths",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetMonths",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetMonths').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@and(greater(item().name,'0'),less(item().name,'13'))",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterDays",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetDays",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetDays').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@and(greater(item().name,'0'),less(item().name,'32'))",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "validationFileExists",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "LatestDay",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('var_Month')",
                                        "type": "Expression"
                                    },
                                    "Directory_Day": {
                                        "value": "@variables('var_Day')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "timeout": "0.00:15:00",
                            "sleep": 30,
                            "childItems": true
                        }
                    },
                    {
                        "name": "failMissingFiles",
                        "type": "Fail",
                        "dependsOn": [
                            {
                                "activity": "validationFileExists",
                                "dependencyConditions": [
                                    "Failed"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "message": {
                                "value": "@concat('No files were found in the desired location. Location: raw/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                "type": "Expression"
                            },
                            "errorCode": "200"
                        }
                    },
                    {
                        "name": "if_validDate",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "validationFileExists",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@greater(utcnow(),formatDateTime(concat(variables('var_Year'),'-',variables('var_Month'),'-',variables('var_Day'))))",
                                "type": "Expression"
                            },
                            "ifFalseActivities": [
                                {
                                    "name": "fail_InvalidDate",
                                    "type": "Fail",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "message": "300",
                                        "errorCode": {
                                            "value": "@concat('Date of file/folder is greater than the current date/time.  Location: raw/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                            "type": "Expression"
                                        }
                                    }
                                }
                            ],
                            "ifTrueActivities": [
                                {
                                    "name": "MergeAndCopy",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "wildcardFileName": "*sv",
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "DelimitedTextSink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings",
                                                "copyBehavior": "MergeFiles"
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextWriteSettings",
                                                "quoteAllText": true,
                                                "fileExtension": ".txt"
                                            }
                                        },
                                        "enableStaging": false,
                                        "enableSkipIncompatibleRow": true,
                                        "logStorageSettings": {
                                            "linkedServiceName": {
                                                "referenceName": "EnterpriseDataSource",
                                                "type": "LinkedServiceReference"
                                            },
                                            "path": {
                                                "value": "@concat('logging/errors/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                "type": "Expression"
                                            }
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "src_fully_parameterized",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": "raw",
                                                "Directory_Client": {
                                                    "value": "@pipeline().parameters.par_Source",
                                                    "type": "Expression"
                                                },
                                                "Directory_Type": {
                                                    "value": "@pipeline().parameters.par_Object",
                                                    "type": "Expression"
                                                },
                                                "Directory_Year": {
                                                    "value": "@variables('var_Year')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Month": {
                                                    "value": "@variables('var_Month')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Day": {
                                                    "value": "@variables('var_Day')",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "snk_fully_parameterized",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": {
                                                    "value": "@pipeline().parameters.par_destContainer",
                                                    "type": "Expression"
                                                },
                                                "Directory": {
                                                    "value": "@pipeline().parameters.par_destFilePath",
                                                    "type": "Expression"
                                                },
                                                "File": {
                                                    "value": "@pipeline().parameters.par_destFilename",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "par_Source": {
                        "type": "string",
                        "defaultValue": "FIS"
                    },
                    "par_Object": {
                        "type": "string",
                        "defaultValue": "Demographics"
                    },
                    "par_destFilename": {
                        "type": "string",
                        "defaultValue": "FISDebitDemographic.csv"
                    },
                    "par_destContainer": {
                        "type": "string",
                        "defaultValue": "stage"
                    },
                    "par_destFilePath": {
                        "type": "string",
                        "defaultValue": "FIS/ReferenceFile"
                    }
                },
                "variables": {
                    "var_Year": {
                        "type": "String"
                    },
                    "var_Month": {
                        "type": "String"
                    },
                    "var_Day": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2022-03-14T15:04:39Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_CopyGZipFile')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "This pipeline takes a file and GZIP's it. It also deletes the original file after completion.",
                "activities": [
                    {
                        "name": "CopyGZipFile",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "BinarySource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": false,
                                    "deleteFilesAfterCompletion": false
                                },
                                "formatSettings": {
                                    "type": "BinaryReadSettings"
                                }
                            },
                            "sink": {
                                "type": "BinarySink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ABLB_Binary_File",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "@first(split(pipeline().parameters.par_srcFolderPath,'/'))",
                                    "Directory": "@substring(pipeline().parameters.par_srcFolderPath,indexof(pipeline().parameters.par_srcFolderPath,'/'),sub(length(pipeline().parameters.par_srcFolderPath),indexof(pipeline().parameters.par_srcFolderPath,'/')))",
                                    "FileName": "@pipeline().parameters.par_fileName"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_ABLB_Binary_GZIP_Folder",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "@first(split(pipeline().parameters.par_snkFolderPath,'/'))",
                                    "Directory": "@substring(pipeline().parameters.par_snkFolderPath,indexof(pipeline().parameters.par_snkFolderPath,'/'),sub(length(pipeline().parameters.par_snkFolderPath),indexof(pipeline().parameters.par_snkFolderPath,'/')))"
                                }
                            }
                        ]
                    },
                    {
                        "name": "deleteFile",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "CopyGZipFile",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ABLB_Binary_File",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "@first(split(pipeline().parameters.par_srcFolderPath,'/'))",
                                    "Directory": "@substring(pipeline().parameters.par_srcFolderPath,indexof(pipeline().parameters.par_srcFolderPath,'/'),sub(length(pipeline().parameters.par_srcFolderPath),indexof(pipeline().parameters.par_srcFolderPath,'/')))",
                                    "FileName": "@pipeline().parameters.par_fileName"
                                }
                            },
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "logging/copyactivity-logs/delete"
                            },
                            "enableLogging": true,
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": false,
                                "enablePartitionDiscovery": false
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "par_srcFolderPath": {
                        "type": "string",
                        "defaultValue": "raw/FIS/Demographics/Daily/2022/03/15"
                    },
                    "par_snkFolderPath": {
                        "type": "string",
                        "defaultValue": "raw/FIS/Demographics/Daily/2022/03/15"
                    },
                    "par_fileName": {
                        "type": "string",
                        "defaultValue": "D220315.OP.TXT"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [
                    "Utility"
                ],
                "lastPublishTime": "2022-03-29T14:57:17Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_DataFlowSplitFiles')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "This pipeline takes source and sink parameters, calculates the number of partitions based on the FileSizeByteLimit parameter (default is 1GB or 1073741824 bytes), and splits the files.",
                "activities": [
                    {
                        "name": "metaSourceFolder",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ABLB_Binary_Folder",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": {
                                        "value": "@pipeline().parameters.par_srcContainer",
                                        "type": "Expression"
                                    },
                                    "Directory": {
                                        "value": "@pipeline().parameters.par_srcDirectory",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true,
                                "enablePartitionDiscovery": false
                            },
                            "formatSettings": {
                                "type": "BinaryReadSettings"
                            }
                        }
                    },
                    {
                        "name": "forEachFile",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "filterOnlyFiles",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('filterOnlyFiles').output.Value",
                                "type": "Expression"
                            },
                            "activities": [
                                {
                                    "name": "metaGetFileSize",
                                    "type": "GetMetadata",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataset": {
                                            "referenceName": "DS_ABLB_Binary_File",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": {
                                                    "value": "@pipeline().parameters.par_srcContainer",
                                                    "type": "Expression"
                                                },
                                                "Directory": {
                                                    "value": "@pipeline().parameters.par_srcDirectory",
                                                    "type": "Expression"
                                                },
                                                "FileName": {
                                                    "value": "@item().name",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        "fieldList": [
                                            "size"
                                        ],
                                        "storeSettings": {
                                            "type": "AzureBlobFSReadSettings",
                                            "recursive": true,
                                            "enablePartitionDiscovery": false
                                        },
                                        "formatSettings": {
                                            "type": "BinaryReadSettings"
                                        }
                                    }
                                },
                                {
                                    "name": "if_FileSizeGreater",
                                    "type": "IfCondition",
                                    "dependsOn": [
                                        {
                                            "activity": "metaGetFileSize",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@and(greater(activity('metaGetFileSize').output.size,pipeline().parameters.par_fileSizeByteLimit),equals(pipeline().parameters.par_header,bool(1)))",
                                            "type": "Expression"
                                        },
                                        "ifFalseActivities": [
                                            {
                                                "name": "get_varPartitions_NoHeader",
                                                "type": "SetVariable",
                                                "dependsOn": [],
                                                "policy": {
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "variableName": "varPartitions",
                                                    "value": {
                                                        "value": "@first(split(string(add(div(activity('metaGetFileSize').output.size,pipeline().parameters.par_fileSizeByteLimit),1)),'.'))",
                                                        "type": "Expression"
                                                    }
                                                }
                                            },
                                            {
                                                "name": "DF_SplitFiles_NoHeader",
                                                "type": "ExecuteDataFlow",
                                                "dependsOn": [
                                                    {
                                                        "activity": "get_varPartitions_NoHeader",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "1.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataflow": {
                                                        "referenceName": "DF_SplitFiles_NoHeader",
                                                        "type": "DataFlowReference",
                                                        "parameters": {
                                                            "snk_Container": {
                                                                "value": "'@{pipeline().parameters.par_snkContainer}'",
                                                                "type": "Expression"
                                                            },
                                                            "src_Directory": {
                                                                "value": "'@{pipeline().parameters.par_srcDirectory}'",
                                                                "type": "Expression"
                                                            },
                                                            "src_Container": {
                                                                "value": "'@{pipeline().parameters.par_srcContainer}'",
                                                                "type": "Expression"
                                                            },
                                                            "snk_Directory": {
                                                                "value": "'@{pipeline().parameters.par_snkDirectory}'",
                                                                "type": "Expression"
                                                            },
                                                            "src_FileName": {
                                                                "value": "'@{item().name}'",
                                                                "type": "Expression"
                                                            },
                                                            "snk_Partitions": {
                                                                "value": "@int(variables('varPartitions'))",
                                                                "type": "Expression"
                                                            }
                                                        },
                                                        "datasetParameters": {
                                                            "Source": {},
                                                            "Sink": {}
                                                        }
                                                    },
                                                    "staging": {},
                                                    "compute": {
                                                        "coreCount": 8,
                                                        "computeType": "General"
                                                    },
                                                    "traceLevel": "Fine"
                                                }
                                            }
                                        ],
                                        "ifTrueActivities": [
                                            {
                                                "name": "get_varPartitions",
                                                "type": "SetVariable",
                                                "dependsOn": [],
                                                "policy": {
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "variableName": "varPartitions",
                                                    "value": {
                                                        "value": "@first(split(string(add(div(activity('metaGetFileSize').output.size,pipeline().parameters.par_fileSizeByteLimit),1)),'.'))",
                                                        "type": "Expression"
                                                    }
                                                }
                                            },
                                            {
                                                "name": "DF_SplitFiles",
                                                "type": "ExecuteDataFlow",
                                                "dependsOn": [
                                                    {
                                                        "activity": "get_varPartitions",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "1.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataflow": {
                                                        "referenceName": "DF_SplitFiles_Header",
                                                        "type": "DataFlowReference",
                                                        "parameters": {
                                                            "snk_Container": {
                                                                "value": "'@{pipeline().parameters.par_snkContainer}'",
                                                                "type": "Expression"
                                                            },
                                                            "src_Directory": {
                                                                "value": "'@{pipeline().parameters.par_srcDirectory}'",
                                                                "type": "Expression"
                                                            },
                                                            "src_Container": {
                                                                "value": "'@{pipeline().parameters.par_srcContainer}'",
                                                                "type": "Expression"
                                                            },
                                                            "snk_Partitions": {
                                                                "value": "@int(variables('varPartitions'))",
                                                                "type": "Expression"
                                                            },
                                                            "src_FileName": {
                                                                "value": "'@{item().name}'",
                                                                "type": "Expression"
                                                            },
                                                            "snk_Directory": {
                                                                "value": "'@{pipeline().parameters.par_snkDirectory}'",
                                                                "type": "Expression"
                                                            }
                                                        },
                                                        "datasetParameters": {
                                                            "Source": {},
                                                            "Sink": {}
                                                        }
                                                    },
                                                    "staging": {},
                                                    "compute": {
                                                        "coreCount": 8,
                                                        "computeType": "General"
                                                    },
                                                    "traceLevel": "Fine"
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "filterOnlyFiles",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaSourceFolder",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaSourceFolder').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@equals(item().type,'File')",
                                "type": "Expression"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "par_srcContainer": {
                        "type": "string",
                        "defaultValue": "raw"
                    },
                    "par_snkContainer": {
                        "type": "string",
                        "defaultValue": "stage"
                    },
                    "par_srcDirectory": {
                        "type": "string",
                        "defaultValue": "Fiserv/PI_Status/2022/02/15"
                    },
                    "par_snkDirectory": {
                        "type": "string",
                        "defaultValue": "Fiserv/ReferenceFile/split_files_dataflow"
                    },
                    "par_fileSizeByteLimit": {
                        "type": "int",
                        "defaultValue": 1073741824
                    },
                    "par_header": {
                        "type": "bool",
                        "defaultValue": true
                    }
                },
                "variables": {
                    "varPartitions": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2022-03-29T15:17:01Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Mastercard_Fallback_Tran')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Loads the latest dated Mastercard Fallback Transaction summary files from ADLS Raw into SF. ",
                "activities": [
                    {
                        "name": "getMeta_MasterCard_Fallback_Tran_Files",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "setVar_Src_Directory",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ABLB_Binary_Folder1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": {
                                        "value": "@pipeline().parameters.par_Src_Container",
                                        "type": "Expression"
                                    },
                                    "Directory": {
                                        "value": "@variables('var_Src_Directory')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true,
                                "enablePartitionDiscovery": false
                            },
                            "formatSettings": {
                                "type": "BinaryReadSettings"
                            }
                        }
                    },
                    {
                        "name": "forEach_RawFile",
                        "description": "Process one file at a time end-to-end as the data in the file needs to be internally joined between header and transactions to flatten the data and load to table",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "getMeta_MasterCard_Fallback_Tran_Files",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('getMeta_MasterCard_Fallback_Tran_Files').Output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "setVar_FileRename",
                                    "description": "Set Sink file name by removing spaces in source file names",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "var_FileRename",
                                        "value": {
                                            "value": "@string(replace(replace(item().name,'''',''),' ',''))",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "copy_RenameFile",
                                    "description": "Copy the data in the file to new file with no spaces in the file name. Spaces cause SF load to fail.",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "setVar_RunID",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "BinarySource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "deleteFilesAfterCompletion": false
                                            },
                                            "formatSettings": {
                                                "type": "BinaryReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "BinarySink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings"
                                            }
                                        },
                                        "enableStaging": false,
                                        "enableSkipIncompatibleRow": true,
                                        "validateDataConsistency": false,
                                        "logSettings": {
                                            "enableCopyActivityLog": true,
                                            "copyActivityLogSettings": {
                                                "logLevel": "Warning",
                                                "enableReliableLogging": false
                                            },
                                            "logLocationSettings": {
                                                "linkedServiceName": {
                                                    "referenceName": "EnterpriseDataSource",
                                                    "type": "LinkedServiceReference"
                                                },
                                                "path": "audit/ADF/Logging/DropToRaw"
                                            }
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "DS_ABLB_Binary_File1",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": {
                                                    "value": "@pipeline().parameters.par_Src_Container",
                                                    "type": "Expression"
                                                },
                                                "Directory": {
                                                    "value": "@variables('var_Src_Directory')",
                                                    "type": "Expression"
                                                },
                                                "FileName": {
                                                    "value": "@item().name",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "DS_ABLB_Binary_File1",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": {
                                                    "value": "@pipeline().parameters.par_Sink_Container",
                                                    "type": "Expression"
                                                },
                                                "Directory": {
                                                    "value": "@pipeline().parameters.par_Sink_Directory",
                                                    "type": "Expression"
                                                },
                                                "FileName": {
                                                    "value": "@variables('var_FileRename')",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "name": "lkp_sp_data_load_blob_to_raw",
                                    "description": "Calls stored procedure that loads data from file to Raw table in SF",
                                    "type": "Lookup",
                                    "dependsOn": [
                                        {
                                            "activity": "lkp_sp_Delete_Raw_MasterCard_Fallback_Tran",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "SnowflakeSource",
                                            "query": {
                                                "value": "call raw.common_util.sp_data_load_blob_to_raw(\n'RAW.FIS',\n'RAW_MASTERCARD_FALLBACK_TRAN',\n'\"RAW\".\"COMMON_UTIL\".\"CSVPIPE_NO_HEADER\"',\n'@{variables('var_SF_UTIL')}',\nFALSE,\n'@{variables('var_RunID')}'\n);",
                                                "type": "Expression"
                                            },
                                            "exportSettings": {
                                                "type": "SnowflakeExportCopyCommand"
                                            }
                                        },
                                        "dataset": {
                                            "referenceName": "ds_SF_Mastercard_FallbackTrans",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        },
                                        "firstRowOnly": true
                                    }
                                },
                                {
                                    "name": "lkp_sp_Load_Raw_to_Stage_MasterCard_Fallback_Tran",
                                    "description": "Load the data from Raw to Stage by parsing the attributes from the top 3 header rows and the transaction data",
                                    "type": "Lookup",
                                    "dependsOn": [
                                        {
                                            "activity": "lkp_sp_data_load_blob_to_raw",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "SnowflakeSource",
                                            "query": {
                                                "value": "call STAGE.FIS.SP_LOAD_MASTERCARD_FALLBACK_TRAN_RAW_TO_STAGE('@{variables('var_RunID')}')",
                                                "type": "Expression"
                                            },
                                            "exportSettings": {
                                                "type": "SnowflakeExportCopyCommand"
                                            }
                                        },
                                        "dataset": {
                                            "referenceName": "ds_SF_Mastercard_FallbackTrans",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        },
                                        "firstRowOnly": true
                                    }
                                },
                                {
                                    "name": "lkp_sp_Load_Stage_to_EDW_Master_Card_Fallback_Tran",
                                    "description": "Load data from Stage to EDW",
                                    "type": "Lookup",
                                    "dependsOn": [
                                        {
                                            "activity": "lkp_sp_Load_Raw_to_Stage_MasterCard_Fallback_Tran",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "SnowflakeSource",
                                            "query": {
                                                "value": "call EDW.TRANSACTION.SP_LOAD_MASTERCARD_FALLBACK_TRAN_STAGE_TO_EDW ('@{variables('var_RunID')}');",
                                                "type": "Expression"
                                            },
                                            "exportSettings": {
                                                "type": "SnowflakeExportCopyCommand"
                                            }
                                        },
                                        "dataset": {
                                            "referenceName": "ds_SF_Mastercard_FallbackTrans",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        },
                                        "firstRowOnly": true
                                    }
                                },
                                {
                                    "name": "del_StageFolder_afterLoad",
                                    "type": "Delete",
                                    "dependsOn": [
                                        {
                                            "activity": "lkp_sp_Load_Stage_to_EDW_Master_Card_Fallback_Tran",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataset": {
                                            "referenceName": "DS_ABLB_Binary_Folder1",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": {
                                                    "value": "@pipeline().parameters.par_Sink_Container",
                                                    "type": "Expression"
                                                },
                                                "Directory": {
                                                    "value": "@pipeline().parameters.par_Sink_Directory",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        "enableLogging": false,
                                        "storeSettings": {
                                            "type": "AzureBlobFSReadSettings",
                                            "recursive": true,
                                            "enablePartitionDiscovery": false
                                        }
                                    }
                                },
                                {
                                    "name": "lkp_sp_Delete_Raw_MasterCard_Fallback_Tran",
                                    "description": "Call Snowflake stored procedure to truncate the table RAW_MASTERCARD_FALLBACK_TRAN",
                                    "type": "Lookup",
                                    "dependsOn": [
                                        {
                                            "activity": "copy_RenameFile",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "SnowflakeSource",
                                            "query": {
                                                "value": "call RAW.FIS.SP_DELETE_RAW_MASTERCARD_FALLBACK_TRAN('@{variables('var_RunID')}')",
                                                "type": "Expression"
                                            },
                                            "exportSettings": {
                                                "type": "SnowflakeExportCopyCommand"
                                            }
                                        },
                                        "dataset": {
                                            "referenceName": "ds_SF_Mastercard_FallbackTrans",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        },
                                        "firstRowOnly": false
                                    }
                                },
                                {
                                    "name": "setVar_RunID",
                                    "description": "",
                                    "type": "SetVariable",
                                    "dependsOn": [
                                        {
                                            "activity": "setVar_SF_UTIL",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "var_RunID",
                                        "value": {
                                            "value": "@pipeline().RunId",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "setVar_SF_UTIL",
                                    "description": "",
                                    "type": "SetVariable",
                                    "dependsOn": [
                                        {
                                            "activity": "setVar_FileRename",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "var_SF_UTIL",
                                        "value": {
                                            "value": "@concat('RAW.COMMON_UTIL.ext_stage_raw/',pipeline().parameters.par_Sink_Directory,'/',variables('var_FileRename'))",
                                            "type": "Expression"
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "metaGetYears",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Object1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "filterYears",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetYears",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetYears').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@startswith(item().name,'20')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "varSetLatestYear",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterYears",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Year",
                            "value": {
                                "value": "@last(activity('filterYears').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "metaGetMonths",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "varSetLatestYear",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Year1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "varSetLatestMonth",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterMonths",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Month",
                            "value": {
                                "value": "@last(activity('filterMonths').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterMonths",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetMonths",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetMonths').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@and(greater(item().name,'0'),less(item().name,'13'))",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "metaGetDays",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "varSetLatestMonth",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Month1",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('var_Month')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "LatestDay",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterDays",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Day",
                            "value": {
                                "value": "@last(activity('filterDays').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterDays",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetDays",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetDays').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@and(greater(item().name,'0'),less(item().name,'32'))",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "setVar_Src_Directory",
                        "description": "Set variable with the latest date directory path to process the latest files",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "LatestDay",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Src_Directory",
                            "value": {
                                "value": "@concat(pipeline().parameters.par_Source,'/',\npipeline().parameters.par_Object,'/',\nvariables('var_Year'),'/',\nvariables('var_Month'),'/',\nvariables('var_Day'))",
                                "type": "Expression"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "par_Src_Container": {
                        "type": "string",
                        "defaultValue": "raw"
                    },
                    "par_Source": {
                        "type": "string",
                        "defaultValue": "FIS"
                    },
                    "par_Object": {
                        "type": "string",
                        "defaultValue": "Mastercard_FallBack_Trans"
                    },
                    "par_Sink_Container": {
                        "type": "string",
                        "defaultValue": "raw"
                    },
                    "par_Sink_Directory": {
                        "type": "string",
                        "defaultValue": "FIS/Mastercard_FallBack_Trans/Renamed_Output"
                    }
                },
                "variables": {
                    "var_FileRename": {
                        "type": "String"
                    },
                    "var_SF_UTIL": {
                        "type": "String",
                        "defaultValue": "COMMON_UTIL.ext_stage_raw/FIS/Mastercard_FallBack_Renamed"
                    },
                    "var_RunID": {
                        "type": "String",
                        "defaultValue": "123QWEASDZXXX"
                    },
                    "var_Year": {
                        "type": "String"
                    },
                    "var_Month": {
                        "type": "String"
                    },
                    "var_Day": {
                        "type": "String"
                    },
                    "var_Src_Directory": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "MasterCard"
                },
                "annotations": [],
                "lastPublishTime": "2024-11-22T02:29:27Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_droptoRaw_Rewards_CustomDemographic')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'AncillaryDemographic')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "dropZoneTransactions_Rewards_Custom_Demo",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "DS_ADLS_rawRewardsCustomDemographic",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDrop_Response",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "dropZoneTransactions_Rewards_Custom_Demo",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ADLS_dropZone_Rewards_Custom_Demographic",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "Rewards/CustomDemographic"
                },
                "annotations": [],
                "lastPublishTime": "2022-05-17T21:39:47Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Rewards_to_SF_One_Time_Load')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Copies data from ASQL Rewards to Rewards schema in Snowflake Application_DB. Single data load.",
                "activities": [
                    {
                        "name": "Copy_RewardsAdjustmentCodes",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [AdjustmentCodeId]\n      ,[Name]\n      ,[Code]\n      ,[Description]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[RewardsAdjustmentCodes]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSADJUSTMENTCODES",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "AdjustmentCodeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "ADJUSTMENTCODEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Description",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DESCRIPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsAdjustmentCodes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsAdjustmentCode",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_programSettings",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [programSettingsId]\n      ,[externalSettingId]\n      ,[CreateDate]\n      ,[ModifyDate]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[programSettings]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.PROGRAMSETTINGS",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "programSettingsId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "PROGRAMSETTINGSID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "externalSettingId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "EXTERNALSETTINGID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CreateDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SRC_CREATEDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ModifyDate",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "SRC_MODIFYDATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_programSettings",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_programSettings",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_AccountTypes",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [AccountTypeId]\n,[Name]\n,[Description]\n,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\nFROM [dbo].[AccountTypes]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.ACCOUNTTYPES",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "AccountTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "ACCOUNTTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Description",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DESCRIPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_AccountTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_AccountTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_CashbackMethods",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [CashbackMethodId]\n      ,[Name]\n      ,[Description]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[CashbackMethods]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.CASHBACKMETHODS",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "CashbackMethodId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CASHBACKMETHODID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Description",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DESCRIPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_CashbackMethods",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_CashbackMethods",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "CopyCashbackSourceAccountTypes",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT TOP (1000) [CashbackSourceAccountTypeId]\n      ,[Name]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[CashbackSourceAccountTypes]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.CASHBACKSOURCEACCOUNTTYPES",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "CashbackSourceAccountTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "CASHBACKSOURCEACCOUNTTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_CashbackSourceAccountTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_CashbackSourceAccountTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_map_status",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [source_system_key]\n      ,[source_system]\n      ,[external_status_code]\n      ,[external_status_code_desc]\n      ,[internal_status_code]\n      ,[internal_status_code_desc]\n      ,[rewards_status_code]\n      ,[rewards_status]\n      ,[rewards_status_reason_code]\n      ,[rewards_status_reason]\n      ,[earn]\n      ,[redeem]\n      ,[points_are_forfeited]\n      ,[load_by]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[map_status]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.MAP_STATUS",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "source_system",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "external_status_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EXTERNAL_STATUS_CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "external_status_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EXTERNAL_STATUS_CODE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "internal_status_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "INTERNAL_STATUS_CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "internal_status_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "INTERNAL_STATUS_CODE_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "rewards_status_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REWARDS_STATUS_CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "rewards_status",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REWARDS_STATUS",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "rewards_status_reason_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REWARDS_STATUS_REASON_CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "rewards_status_reason",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REWARDS_STATUS_REASON",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "earn",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EARN",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "redeem",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REDEEM",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "points_are_forfeited",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "POINTS_ARE_FORFEITED",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "load_by",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_BY",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_map_status",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_map_status",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_RewardsBonusCodes",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [BonusCodeId]\n      ,[Name]\n      ,[Code]\n      ,[Description]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[RewardsBonusCodes]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSBONUSCODES",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "BonusCodeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "BONUSCODEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Description",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DESCRIPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsBonusCodes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsBonusCodes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_RewardsProgramDefaults",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [RewardsProgramDefaultId]\n      ,[RewardsProgramURL]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[RewardsProgramDefaults]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSPROGRAMDEFAULTS",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "RewardsProgramDefaultId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMDEFAULTID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsProgramURL",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMURL",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsProgramDefaults",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsProgramDefaults",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_RewardsRoundingRules",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [RewardsRoundingRuleId]\n      ,[Name]\n      ,[Code]\n      ,[DefaultFg]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[RewardsRoundingRules]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSROUNDINGRULES",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "RewardsRoundingRuleId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSROUNDINGRULEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DefaultFg",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "DEFAULTFG",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsRoundingRules",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsRoundingRules",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_RewardsTransactionTypes",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [RewardsTransactionTypeId]\n      ,[RewardsProgramId]\n      ,[TransactionTypeId]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[RewardsTransactionTypes]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSTRANSACTIONTYPES",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "RewardsTransactionTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSTRANSACTIONTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "RewardsProgramId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSPROGRAMID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TransactionTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "TRANSACTIONTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsTransactionTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsTransactionTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_RewardsTypes",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [RewardsTypeId]\n      ,[Name]\n      ,[Code]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[RewardsTypes]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.REWARDSTYPES",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "RewardsTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "REWARDSTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_RewardsTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_RewardsTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy_TransactionTypes",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT [TransactionTypeId]\n      ,[AccountTypeId]\n      ,[Name]\n      ,[Description]\n      ,[DefaultOption]\n\t  ,CURRENT_TIMESTAMP as LOAD_DATE\n,'ADF - ETL' as LOAD_TYPE\n,'ADF' as CREATED_USER\n,CURRENT_TIMESTAMP as CREATE_DATE\n  FROM [dbo].[TransactionTypes]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE REWARDS.TRANSACTIONTYPES",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "enableSkipIncompatibleRow": true,
                            "logSettings": {
                                "enableCopyActivityLog": true,
                                "copyActivityLogSettings": {
                                    "logLevel": "Warning",
                                    "enableReliableLogging": false
                                },
                                "logLocationSettings": {
                                    "linkedServiceName": {
                                        "referenceName": "AzureBlobStorage_SnowFlake",
                                        "type": "LinkedServiceReference"
                                    }
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "TransactionTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "TRANSACTIONTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "AccountTypeId",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "ACCOUNTTYPEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Description",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "DESCRIPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DefaultOption",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "DEFAULTOPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAD_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "LOAD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREATED_USER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATE_DATE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_TransactionTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_TransactionTypes",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SnowFlake/Rewards"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T14:39:21Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_populate_semDigitalCardUsageAnalysis_dci')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "pop_CardUsageStaging_preagg_dci",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Cardusage_Analysis_Preagg_DCI_NoToken_Load",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "03:00:00",
                                "isolationLevel": "ReadUncommitted",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "truncate table stage.cardusage_analysis_preagg_dci;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/SnowflakeStage"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "total_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_digital_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "total_digital_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "non_transacting_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_digital_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "non_transacting_digital_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "total_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_digital_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "total_digital_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "non_transacting_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_digital_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "non_transacting_digital_cards_prev",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_CardUsageAnalysis_preagg_dci",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_Cardusage_Analysis_Preagg_DCI_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "copy_cardusage_analysis_monthly_dci",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Cardusage_Analysis_Monthly_DCI_NoToken_Load",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "03:00:00",
                                "isolationLevel": "ReadUncommitted",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "truncate table stage.cardusage_analysis_monthly_dci;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/SnowflakeStage"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "timeperiod"
                                        },
                                        "sink": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date"
                                        },
                                        "sink": {
                                            "name": "date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards"
                                        },
                                        "sink": {
                                            "name": "total_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_digital_cards"
                                        },
                                        "sink": {
                                            "name": "total_digital_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards"
                                        },
                                        "sink": {
                                            "name": "non_transacting_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_digital_cards"
                                        },
                                        "sink": {
                                            "name": "non_transacting_digital_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards_prev"
                                        },
                                        "sink": {
                                            "name": "total_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_digital_cards_prev"
                                        },
                                        "sink": {
                                            "name": "total_digital_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards_prev"
                                        },
                                        "sink": {
                                            "name": "non_transacting_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_digital_cards_prev"
                                        },
                                        "sink": {
                                            "name": "non_transacting_digital_cards_prev",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_CardUsageAnalysis_monthly_dci",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_Cardusage_Analysis_Monthly_DCI_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "SEM_Monthly_DCI_To_Archive",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "copy_cardusage_analysis_monthly_dci",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "truncate table archive.cardusage_analysis_monthly_dci;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/SnowflakeStage"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_DIGITAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_DIGITAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_SF_CardUsage_Analysis_Monthly_SEM",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_CardUsage_Analysis_Monthly_DCI_ARCHIVE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Stage_Monthly_DCI_To_SEM",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SEM_Monthly_DCI_To_Archive",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "truncate table sem.cardusage_analysis_monthly_dci;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/SnowflakeStage"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_DIGITAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_DIGITAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_SF_Cardusage_Analysis_Monthly_DCI_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_CardUsage_Analysis_Monthly_SEM",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "SEM_Preagg_DCI_To_Archive",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "pop_CardUsageStaging_preagg_dci",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "truncate table archive.cardusage_analysis_preagg_dci;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/SnowflakeStage"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_DIGITAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_DIGITAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_SF_CardUsage_Analysis_Preagg_DCI_SEM",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_CardUsage_Analysis_Preagg_DCI_ARCHIVE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Stage_Preagg_DCI_To_SEM",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "SEM_Preagg_DCI_To_Archive",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "truncate table sem.cardusage_analysis_preagg_dci;\n",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/SnowflakeStage"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TIMEPERIOD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BINNUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TOKEN_REQUEST_DESC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_DIGITAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_DIGITAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TOTAL_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "TOTAL_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "NON_TRANSACTING_DIGITAL_CARDS_PREV",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_SF_Cardusage_Analysis_Preagg_DCI_STAGE",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_CardUsage_Analysis_Preagg_DCI_SEM",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Transacting_Accounts_Curr_DCI_Load",
                        "description": "",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[transaction].[usp_Transacting_Accounts_Curr_DCI_Load]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidated_DW",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Transacting_Accounts_Prev_DCI_Load",
                        "description": "",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Transacting_Accounts_Curr_DCI_Load",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[transaction].[usp_Transacting_Accounts_Prev_DCI_Load]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidated_DW",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Cardusage_Analysis_Monthly_DCI_Load",
                        "description": "",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Transacting_Accounts_Prev_DCI_Load",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[usp_Cardusage_Analysis_Monthly_DCI_Load]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidated_DW",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Cardusage_Analysis_Monthly_DCI_NoToken_Load",
                        "description": "",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Cardusage_Analysis_Monthly_DCI_Load",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[usp_Cardusage_Analysis_Monthly_NoToken_DCI_Load]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidated_DW",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Cardusage_Analysis_Preagg_DCI_Load",
                        "description": "",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Cardusage_Analysis_Monthly_DCI_NoToken_Load",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[usp_Cardusage_Analysis_Preagg_DCI_Load]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidated_DW",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Cardusage_Analysis_Preagg_DCI_NoToken_Load",
                        "description": "",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Cardusage_Analysis_Preagg_DCI_Load",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[usp_Cardusage_Analysis_Preagg_NoToken_DCI_Load]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidated_DW",
                            "type": "LinkedServiceReference"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-29T15:03:37Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_CopyBinaryFolder')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Get Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ABLB_Binary_Folder",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": {
                                        "value": "@pipeline().parameters.Source_Container",
                                        "type": "Expression"
                                    },
                                    "Directory": {
                                        "value": "@pipeline().parameters.Source_Directory",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true,
                                "enablePartitionDiscovery": false
                            },
                            "formatSettings": {
                                "type": "BinaryReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach1",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "fil_FileName",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@if(equals(pipeline().parameters.par_FileName_optional,'NULL'),activity('Get Metadata').output.childitems,activity('fil_FileName').output.value)",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "cpy_DropToRaw",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "BinarySource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "deleteFilesAfterCompletion": false
                                            },
                                            "formatSettings": {
                                                "type": "BinaryReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "BinarySink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings"
                                            }
                                        },
                                        "enableStaging": false,
                                        "enableSkipIncompatibleRow": true,
                                        "validateDataConsistency": false,
                                        "logSettings": {
                                            "enableCopyActivityLog": true,
                                            "copyActivityLogSettings": {
                                                "logLevel": "Warning",
                                                "enableReliableLogging": false
                                            },
                                            "logLocationSettings": {
                                                "linkedServiceName": {
                                                    "referenceName": "EnterpriseDataSource",
                                                    "type": "LinkedServiceReference"
                                                },
                                                "path": "audit/ADF/Logging/DropToRaw"
                                            }
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "DS_ABLB_Binary_File",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": {
                                                    "value": "@pipeline().parameters.Source_Container",
                                                    "type": "Expression"
                                                },
                                                "Directory": {
                                                    "value": "@pipeline().parameters.Source_Directory",
                                                    "type": "Expression"
                                                },
                                                "FileName": {
                                                    "value": "@item().name",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "DS_ABLB_Binary_Folder",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": {
                                                    "value": "@pipeline().parameters.Sink_Container",
                                                    "type": "Expression"
                                                },
                                                "Directory": {
                                                    "value": "@pipeline().parameters.Sink_Directory",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    },
                    {
                        "name": "fil_FileName",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "Get Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Get Metadata').output.childitems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@contains(item().name,pipeline().parameters.par_FileName_optional)",
                                "type": "Expression"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Source_Container": {
                        "type": "string"
                    },
                    "Sink_Container": {
                        "type": "string"
                    },
                    "Source_Directory": {
                        "type": "string"
                    },
                    "Sink_Directory": {
                        "type": "string"
                    },
                    "par_FileName_optional": {
                        "type": "string",
                        "defaultValue": "NULL"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2022-10-24T22:12:58Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_DCI_CardIssuance_ASQL_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "DigitalCardIssuance",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": "SELECT\n    t.TABLE_NAME,\n    t.TABLE_SCHEMA AS schema_name,\n    STRING_AGG(c.COLUMN_NAME, ',') WITHIN GROUP (ORDER BY c.COLUMN_NAME) AS key_column,\n    STRING_AGG('DSTG.' + c.COLUMN_NAME + '= DCI.' + c.COLUMN_NAME, ' AND ') WITHIN GROUP (ORDER BY c.COLUMN_NAME) AS join_column,\n    STRING_AGG('DCI.' + c.COLUMN_NAME + ' IS NULL', ' AND ') WITHIN GROUP (ORDER BY c.COLUMN_NAME) AS key_column_condition\nFROM\n    INFORMATION_SCHEMA.TABLES t\nJOIN\n    INFORMATION_SCHEMA.COLUMNS c ON t.TABLE_NAME = c.TABLE_NAME\n                                 AND t.TABLE_SCHEMA = c.TABLE_SCHEMA\nJOIN\n    INFORMATION_SCHEMA.TABLE_CONSTRAINTS con ON con.TABLE_NAME = c.TABLE_NAME\n                                             AND con.TABLE_SCHEMA = c.TABLE_SCHEMA\nJOIN\n    INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE ccu ON ccu.CONSTRAINT_NAME = con.CONSTRAINT_NAME\n                                                 AND ccu.TABLE_NAME = c.TABLE_NAME\n                                                 AND ccu.TABLE_SCHEMA = c.TABLE_SCHEMA\nWHERE\n    con.CONSTRAINT_TYPE = 'PRIMARY KEY'  -- Only primary key constraints\n    AND ccu.COLUMN_NAME = c.COLUMN_NAME  -- Ensuring only columns that are part of the primary key\n    AND t.TABLE_NAME IN ('DigitalCardIssuance')  -- Filter to only include DigitalCardIssuance table\n    AND t.TABLE_SCHEMA = 'dci'  -- Filter to the schema SA\nGROUP BY\n    t.TABLE_NAME, t.TABLE_SCHEMA;\n",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "dataset": {
                                "referenceName": "DS_ASQL_AppODS_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "dci",
                                    "par_table": "NULL"
                                }
                            }
                        }
                    },
                    {
                        "name": "DCI_COLUMNS",
                        "type": "Lookup",
                        "dependsOn": [
                            {
                                "activity": "DigitalCardIssuance",
                                "dependencyConditions": [
                                    "Completed"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT\n   \n    STUFF((\n        SELECT ', ' + COLUMN_NAME\n        FROM INFORMATION_SCHEMA.COLUMNS\n        WHERE TABLE_SCHEMA = '@{activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME}'\n        AND TABLE_NAME = '@{activity('DigitalCardIssuance').output.firstRow.TABLE_NAME}'\n        FOR XML PATH(''), TYPE\n    ).value('.', 'VARCHAR(MAX)'), 1, 2, '') AS COLUMNNAMES,\n\n   \n    STUFF((\n        SELECT ', ' + COLUMN_NAME + ' = ' + 'DSTG.' + COLUMN_NAME\n        FROM INFORMATION_SCHEMA.COLUMNS\n        WHERE TABLE_SCHEMA = '@{activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME}'\n        AND TABLE_NAME = '@{activity('DigitalCardIssuance').output.firstRow.TABLE_NAME}'       \n        FOR XML PATH(''), TYPE\n    ).value('.', 'VARCHAR(MAX)'), 1, 2, '') AS CORECOLUMNNAMES,\n\n \n    STUFF((\n        SELECT ' OR ' + '(DCI.' + COLUMN_NAME + ' <> DSTG.' + COLUMN_NAME + ' OR ' +\n               '(DCI.' + COLUMN_NAME + ' IS NULL AND DSTG.' + COLUMN_NAME + ' IS NOT NULL) OR ' +\n               '(DCI.' + COLUMN_NAME + ' IS NOT NULL AND DSTG.' + COLUMN_NAME + ' IS NULL))'\n        FROM INFORMATION_SCHEMA.COLUMNS\n        WHERE TABLE_SCHEMA = '@{activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME}'\n        AND TABLE_NAME = '@{activity('DigitalCardIssuance').output.firstRow.TABLE_NAME}'       \n        FOR XML PATH(''), TYPE\n    ).value('.', 'VARCHAR(MAX)'), 1, 4, '') AS CONDITIONCHECK;",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "dataset": {
                                "referenceName": "DS_ASQL_AppODS_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "@activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME",
                                    "par_table": "NULL"
                                }
                            }
                        }
                    },
                    {
                        "name": "DCI_STAGE",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DCI_COLUMNS",
                                "dependencyConditions": [
                                    "Completed"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT DIGITALCARDISSUANCEID, CLIENTNUM, CARDNUM, CARDACCESSEDDTE, ISSUEDTE, CARDACTIVATIONDTE,  TRY_CAST(SOURCE_SYSTEM_KEY AS INT) AS SOURCE_SYSTEM_KEY, CREATEDTE, MODIFYDTE,\n  EOMONTH(cast(LEFT(CARDEXPIRATIONDTE,2)+'/01'+'/'+'20'+SUBSTRING(CARDEXPIRATIONDTE,3,2) as date))  AS CARDEXPIRATIONDTE FROM @{activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME}.@{activity('DigitalCardIssuance').output.firstRow.TABLE_NAME}\nWHERE (cast(left(CardExpirationDte, 2) as int) between 1 and 12)\n  and ClientNum <> '0000'\n  and len(trim(CardExpirationDte)) = 4",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeV2Sink",
                                "preCopyScript": {
                                    "value": "TRUNCATE TABLE @{activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME}.@{activity('DigitalCardIssuance').output.firstRow.TABLE_NAME}_stg;",
                                    "type": "Expression"
                                },
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "DIGITALCARDISSUANCEID",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "DIGITALCARDISSUANCEID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENTNUM",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENTNUM",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDNUM",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARDNUM",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDACCESSEDDTE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CARDACCESSEDDTE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ISSUEDTE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ISSUEDTE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDACTIVATIONDTE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CARDACTIVATIONDTE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATEDTE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CREATEDTE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MODIFYDTE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "MODIFYDTE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDEXPIRATIONDTE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "CARDEXPIRATIONDTE",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQL_AppODS_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": {
                                        "value": "@activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME",
                                        "type": "Expression"
                                    },
                                    "par_table": "@activity('DigitalCardIssuance').output.firstRow.TABLE_NAME"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_Application_DB_DCI_Stg",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": {
                                        "value": "@toUpper(activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME)",
                                        "type": "Expression"
                                    },
                                    "par_table": {
                                        "value": "@toUpper(concat(activity('DigitalCardIssuance').output.firstRow.TABLE_NAME,'_STG'))",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "name": "DCI_DIGITALCARDISSUANCE",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DCI_STAGE",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeV2Source",
                                "query": {
                                    "value": "SELECT DSTG.*, GETDATE() AS load_dte, \n\nFROM @{activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME}.@{activity('DigitalCardIssuance').output.firstRow.TABLE_NAME}_stg  DSTG \nleft join @{activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME}.@{activity('DigitalCardIssuance').output.firstRow.TABLE_NAME} \nDCI ON @{activity('DigitalCardIssuance').output.firstRow.JOIN_COLUMN} \nWHERE @{activity('DigitalCardIssuance').output.firstRow.KEY_COLUMN_CONDITION}",
                                    "type": "Expression"
                                },
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "sink": {
                                "type": "SnowflakeV2Sink",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                }
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "DIGITALCARDISSUANCEID"
                                        },
                                        "sink": {
                                            "name": "DIGITALCARDISSUANCEID"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENTNUM"
                                        },
                                        "sink": {
                                            "name": "CLIENTNUM"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDNUM"
                                        },
                                        "sink": {
                                            "name": "CARDNUM"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDACCESSEDDTE"
                                        },
                                        "sink": {
                                            "name": "CARDACCESSEDTE"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ISSUEDTE"
                                        },
                                        "sink": {
                                            "name": "ISSUEDTE"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDACTIVATIONDTE"
                                        },
                                        "sink": {
                                            "name": "CARDACTIVATIONDTE"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SOURCE_SYSTEM_KEY"
                                        },
                                        "sink": {
                                            "name": "SOURCE_SYSTEM_KEY"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREATEDTE"
                                        },
                                        "sink": {
                                            "name": "CREATEDTE"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MODIFYDTE"
                                        },
                                        "sink": {
                                            "name": "MODIFYDTE"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARDEXPIRATIONDTE"
                                        },
                                        "sink": {
                                            "name": "CARDEXPIRATIONDTE"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAD_DTE"
                                        },
                                        "sink": {
                                            "name": "LOADDTE"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_SF_Application_DB_DCI_Stg",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": {
                                        "value": "@toUpper(activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME)",
                                        "type": "Expression"
                                    },
                                    "par_table": "@toUpper(concat(activity('DigitalCardIssuance').output.firstRow.TABLE_NAME,'_STG'))"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_APPLICATIONDB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": {
                                        "value": "@toUpper(activity('DigitalCardIssuance').output.firstRow.SCHEMA_NAME)",
                                        "type": "Expression"
                                    },
                                    "par_table": {
                                        "value": "@toUpper(activity('DigitalCardIssuance').output.firstRow.TABLE_NAME)",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "name": "DigitalCardIssuance_Update",
                        "type": "Script",
                        "dependsOn": [
                            {
                                "activity": "DCI_DIGITALCARDISSUANCE",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "linkedServiceName": {
                            "referenceName": "LS_SF_Application_DB",
                            "type": "LinkedServiceReference"
                        },
                        "typeProperties": {
                            "scripts": [
                                {
                                    "type": "Query",
                                    "text": {
                                        "value": "UPDATE DCI.DIGITALCARDISSUANCE DCI\nSET DigitalCardIssuanceId = DSTG.DigitalCardIssuanceId, ClientNum = DSTG.ClientNum, CardNum = DSTG.CardNum, CardAccesseDte = DSTG.CardAccessedDte, IssueDte = DSTG.IssueDte, CardActivationDte = DSTG.CardActivationDte, CardExpirationDte = DSTG.CardExpirationDte, source_system_key = DSTG.source_system_key, CreateDte = DSTG.CreateDte, ModifyDte = DSTG.ModifyDte,\n    LoadDte= GETDATE()\n\tFROM DCI.DIGITALCARDISSUANCE_STG DSTG\n\tWHERE  DSTG.DigitalCardIssuanceId= DCI.DigitalCardIssuanceId\n\tAND ((DCI.DigitalCardIssuanceId <> DSTG.DigitalCardIssuanceId OR (DCI.DigitalCardIssuanceId IS NULL AND DSTG.DigitalCardIssuanceId IS NOT NULL) OR (DCI.DigitalCardIssuanceId IS NOT NULL AND DSTG.DigitalCardIssuanceId IS NULL)) OR (DCI.ClientNum <> DSTG.ClientNum OR (DCI.ClientNum IS NULL AND DSTG.ClientNum IS NOT NULL) OR (DCI.ClientNum IS NOT NULL AND DSTG.ClientNum IS NULL)) OR (DCI.CardNum <> DSTG.CardNum OR (DCI.CardNum IS NULL AND DSTG.CardNum IS NOT NULL) OR (DCI.CardNum IS NOT NULL AND DSTG.CardNum IS NULL)) OR (DCI.CardAccesseDte <> DSTG.CardAccessedDte OR (DCI.CardAccesseDte IS NULL AND DSTG.CardAccessedDte IS NOT NULL) OR (DCI.CardAccesseDte IS NOT NULL AND DSTG.CardAccessedDte IS NULL)) OR (DCI.IssueDte <> DSTG.IssueDte OR (DCI.IssueDte IS NULL AND DSTG.IssueDte IS NOT NULL) OR (DCI.IssueDte IS NOT NULL AND DSTG.IssueDte IS NULL)) OR (DCI.CardActivationDte <> DSTG.CardActivationDte OR (DCI.CardActivationDte IS NULL AND DSTG.CardActivationDte IS NOT NULL) OR (DCI.CardActivationDte IS NOT NULL AND DSTG.CardActivationDte IS NULL)) OR (DCI.CardExpirationDte <> DSTG.CardExpirationDte OR (DCI.CardExpirationDte IS NULL AND DSTG.CardExpirationDte IS NOT NULL) OR (DCI.CardExpirationDte IS NOT NULL AND DSTG.CardExpirationDte IS NULL)) OR (DCI.source_system_key <> DSTG.source_system_key OR (DCI.source_system_key IS NULL AND DSTG.source_system_key IS NOT NULL) OR (DCI.source_system_key IS NOT NULL AND DSTG.source_system_key IS NULL)) OR (DCI.CreateDte <> DSTG.CreateDte OR (DCI.CreateDte IS NULL AND DSTG.CreateDte IS NOT NULL) OR (DCI.CreateDte IS NOT NULL AND DSTG.CreateDte IS NULL)) OR (DCI.ModifyDte <> DSTG.ModifyDte OR (DCI.ModifyDte IS NULL AND DSTG.ModifyDte IS NOT NULL) OR (DCI.ModifyDte IS NOT NULL AND DSTG.ModifyDte IS NULL)))\n\t",
                                        "type": "Expression"
                                    }
                                }
                            ],
                            "scriptBlockExecutionTimeout": "02:00:00"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "DCI"
                },
                "annotations": [],
                "lastPublishTime": "2025-08-15T01:26:01Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_RawToStage_GetYesterdayFile')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "by default this pipeline get the file from current date minus 1 folder but if the date is specified in the parameter it can get files for that date\n\nit copies multiples from raw container and merge into a single file in stage",
                "activities": [
                    {
                        "name": "SetYear",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "SetLoadDate",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Year",
                            "value": {
                                "value": "@formatDateTime(variables('var_LoadDate'),'yyyy')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetMonth",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "SetYear",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Month",
                            "value": {
                                "value": "@formatDateTime(variables('var_LoadDate'),'MM')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "SetDay",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "SetMonth",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Day",
                            "value": {
                                "value": "@formatDateTime(variables('var_LoadDate'),'dd')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "validationFileExists",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "SetDay",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('var_Month')",
                                        "type": "Expression"
                                    },
                                    "Directory_Day": {
                                        "value": "@variables('var_Day')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "timeout": "0.00:01:00",
                            "sleep": 30,
                            "childItems": true
                        }
                    },
                    {
                        "name": "failMissingFiles",
                        "type": "Fail",
                        "dependsOn": [
                            {
                                "activity": "validationFileExists",
                                "dependencyConditions": [
                                    "Failed"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "message": {
                                "value": "@concat('No files were found in the desired location. Location: raw/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                "type": "Expression"
                            },
                            "errorCode": "200"
                        }
                    },
                    {
                        "name": "if_validDate",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "validationFileExists",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@greater(utcnow(),formatDateTime(concat(variables('var_Year'),'-',variables('var_Month'),'-',variables('var_Day'))))",
                                "type": "Expression"
                            },
                            "ifFalseActivities": [
                                {
                                    "name": "fail_InvalidDate",
                                    "type": "Fail",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "message": "300",
                                        "errorCode": {
                                            "value": "@concat('Date of file/folder is greater than the current date/time.  Location: raw/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                            "type": "Expression"
                                        }
                                    }
                                }
                            ],
                            "ifTrueActivities": [
                                {
                                    "name": "MergeAndCopy",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "wildcardFileName": "*sv",
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "DelimitedTextSink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings",
                                                "copyBehavior": "MergeFiles"
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextWriteSettings",
                                                "quoteAllText": true,
                                                "fileExtension": ".txt"
                                            }
                                        },
                                        "enableStaging": false,
                                        "enableSkipIncompatibleRow": true,
                                        "logStorageSettings": {
                                            "linkedServiceName": {
                                                "referenceName": "EnterpriseDataSource",
                                                "type": "LinkedServiceReference"
                                            },
                                            "path": {
                                                "value": "@concat('logging/errors/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                "type": "Expression"
                                            }
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "src_fully_parameterized",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": "raw",
                                                "Directory_Client": {
                                                    "value": "@pipeline().parameters.par_Source",
                                                    "type": "Expression"
                                                },
                                                "Directory_Type": {
                                                    "value": "@pipeline().parameters.par_Object",
                                                    "type": "Expression"
                                                },
                                                "Directory_Year": {
                                                    "value": "@variables('var_Year')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Month": {
                                                    "value": "@variables('var_Month')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Day": {
                                                    "value": "@variables('var_Day')",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "snk_fully_parameterized",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": {
                                                    "value": "@pipeline().parameters.par_destContainer",
                                                    "type": "Expression"
                                                },
                                                "Directory": {
                                                    "value": "@pipeline().parameters.par_destFilePath",
                                                    "type": "Expression"
                                                },
                                                "File": {
                                                    "value": "@pipeline().parameters.par_destFilename",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    },
                    {
                        "name": "SetLoadDate",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_LoadDate",
                            "value": {
                                "value": "@formatDateTime(coalesce(pipeline().parameters.par_LoadDate,adddays(formatDateTime(utcnow()),-1)))",
                                "type": "Expression"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "par_Source": {
                        "type": "string"
                    },
                    "par_Object": {
                        "type": "string"
                    },
                    "par_destFilename": {
                        "type": "string",
                        "defaultValue": "UpdatedFeedzaiTest.csv"
                    },
                    "par_destContainer": {
                        "type": "string",
                        "defaultValue": "stage"
                    },
                    "par_destFilePath": {
                        "type": "string",
                        "defaultValue": "Coop/COOPER/CardTransaction/Currentcsv"
                    },
                    "par_LoadDate": {
                        "type": "string"
                    }
                },
                "variables": {
                    "var_Year": {
                        "type": "String"
                    },
                    "var_Month": {
                        "type": "String"
                    },
                    "var_Day": {
                        "type": "String"
                    },
                    "var_LoadDate": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2022-12-17T01:28:07Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_RawToStage_FindLatestPath_FalconFad')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "metaGetYears",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Object",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "varSetLatestYear",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterYears",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Year",
                            "value": {
                                "value": "@last(activity('filterYears').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "metaGetMonths",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "varSetLatestYear",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Year",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "varSetLatestMonth",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterMonths",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Month",
                            "value": {
                                "value": "@last(activity('filterMonths').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "metaGetDays",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "varSetLatestMonth",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Month",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('var_Month')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "LatestDay",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "filterDays",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "var_Day",
                            "value": {
                                "value": "@last(activity('filterDays').output.value).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterYears",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetYears",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetYears').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@startswith(item().name,'20')",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterMonths",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetMonths",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetMonths').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@and(greater(item().name,'0'),less(item().name,'13'))",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "filterDays",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "metaGetDays",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('metaGetDays').output.childItems",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@and(greater(item().name,'0'),less(item().name,'32'))",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "validationFileExists",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "LatestDay",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.par_Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.par_Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('var_Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('var_Month')",
                                        "type": "Expression"
                                    },
                                    "Directory_Day": {
                                        "value": "@variables('var_Day')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "timeout": "0.00:15:00",
                            "sleep": 30,
                            "childItems": true
                        }
                    },
                    {
                        "name": "failMissingFiles",
                        "type": "Fail",
                        "dependsOn": [
                            {
                                "activity": "validationFileExists",
                                "dependencyConditions": [
                                    "Failed"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "message": {
                                "value": "@concat('No files were found in the desired location. Location: raw/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                "type": "Expression"
                            },
                            "errorCode": "200"
                        }
                    },
                    {
                        "name": "if_validDate",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "validationFileExists",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@greater(utcnow(),formatDateTime(concat(variables('var_Year'),'-',variables('var_Month'),'-',variables('var_Day'))))",
                                "type": "Expression"
                            },
                            "ifFalseActivities": [
                                {
                                    "name": "fail_InvalidDate",
                                    "type": "Fail",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "message": "300",
                                        "errorCode": {
                                            "value": "@concat('Date of file/folder is greater than the current date/time.  Location: raw/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                            "type": "Expression"
                                        }
                                    }
                                }
                            ],
                            "ifTrueActivities": [
                                {
                                    "name": "MergeAndCopy",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "wildcardFileName": "*sv",
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "DelimitedTextSink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings",
                                                "copyBehavior": "MergeFiles"
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextWriteSettings",
                                                "quoteAllText": true,
                                                "fileExtension": ".txt"
                                            }
                                        },
                                        "enableStaging": false,
                                        "enableSkipIncompatibleRow": true,
                                        "logStorageSettings": {
                                            "linkedServiceName": {
                                                "referenceName": "EnterpriseDataSource",
                                                "type": "LinkedServiceReference"
                                            },
                                            "path": {
                                                "value": "@concat('logging/errors/',pipeline().parameters.par_Source,'/',pipeline().parameters.par_Object,'/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                "type": "Expression"
                                            }
                                        },
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "type": "String",
                                                        "ordinal": 7
                                                    },
                                                    "sink": {
                                                        "type": "String",
                                                        "ordinal": 1
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "type": "String",
                                                        "ordinal": 10
                                                    },
                                                    "sink": {
                                                        "type": "String",
                                                        "ordinal": 2
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "type": "String",
                                                        "ordinal": 11
                                                    },
                                                    "sink": {
                                                        "type": "String",
                                                        "ordinal": 3
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "type": "String",
                                                        "ordinal": 39
                                                    },
                                                    "sink": {
                                                        "type": "String",
                                                        "ordinal": 4
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "type": "String",
                                                        "ordinal": 132
                                                    },
                                                    "sink": {
                                                        "type": "String",
                                                        "ordinal": 5
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "type": "String",
                                                        "ordinal": 581
                                                    },
                                                    "sink": {
                                                        "type": "String",
                                                        "ordinal": 6
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "src_fully_parameterized",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": "raw",
                                                "Directory_Client": {
                                                    "value": "@pipeline().parameters.par_Source",
                                                    "type": "Expression"
                                                },
                                                "Directory_Type": {
                                                    "value": "@pipeline().parameters.par_Object",
                                                    "type": "Expression"
                                                },
                                                "Directory_Year": {
                                                    "value": "@variables('var_Year')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Month": {
                                                    "value": "@variables('var_Month')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Day": {
                                                    "value": "@variables('var_Day')",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "snk_fully_parameterized",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": {
                                                    "value": "@pipeline().parameters.par_destContainer",
                                                    "type": "Expression"
                                                },
                                                "Directory": {
                                                    "value": "@pipeline().parameters.par_destFilePath",
                                                    "type": "Expression"
                                                },
                                                "File": {
                                                    "value": "@pipeline().parameters.par_destFilename",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "par_Source": {
                        "type": "string",
                        "defaultValue": "FIS"
                    },
                    "par_Object": {
                        "type": "string",
                        "defaultValue": "Demographics"
                    },
                    "par_destFilename": {
                        "type": "string",
                        "defaultValue": "FISDebitDemographic.csv"
                    },
                    "par_destContainer": {
                        "type": "string",
                        "defaultValue": "stage"
                    },
                    "par_destFilePath": {
                        "type": "string",
                        "defaultValue": "FIS/ReferenceFile"
                    }
                },
                "variables": {
                    "var_Year": {
                        "type": "String"
                    },
                    "var_Month": {
                        "type": "String"
                    },
                    "var_Day": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2025-11-14T02:39:24Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Staging_zelle_transaction_analysis_daily')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "SharedBranchDM",
                    "type": "LinkedServiceReference"
                },
                "folder": {
                    "name": "Azure SQL DB"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "transaction_id",
                        "type": "bigint",
                        "precision": 19
                    },
                    {
                        "name": "client_id",
                        "type": "nvarchar"
                    },
                    {
                        "name": "client_name",
                        "type": "varchar"
                    },
                    {
                        "name": "br_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "member_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "transaction_amount",
                        "type": "decimal",
                        "precision": 12,
                        "scale": 2
                    },
                    {
                        "name": "transaction_notification",
                        "type": "nvarchar"
                    },
                    {
                        "name": "transaction_type",
                        "type": "nvarchar"
                    },
                    {
                        "name": "transaction_status",
                        "type": "nvarchar"
                    },
                    {
                        "name": "Retrieval_Reference_Number",
                        "type": "nvarchar"
                    },
                    {
                        "name": "originating_org_id",
                        "type": "nvarchar"
                    },
                    {
                        "name": "originating_org_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "receiving_or_id",
                        "type": "nvarchar"
                    },
                    {
                        "name": "receiving_org_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "transaction_start_date",
                        "type": "date"
                    },
                    {
                        "name": "transaction_complete_date",
                        "type": "date"
                    },
                    {
                        "name": "file_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "file_run_date",
                        "type": "date"
                    },
                    {
                        "name": "load_date",
                        "type": "date"
                    },
                    {
                        "name": "loaded_by",
                        "type": "nvarchar"
                    }
                ],
                "typeProperties": {
                    "schema": "staging",
                    "table": "zelle_transaction_analysis_daily"
                }
            },
            "dependsOn": []
        }
    ]
}