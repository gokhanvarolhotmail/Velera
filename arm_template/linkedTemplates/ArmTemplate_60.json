{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "EnterpriseDataSourceProdDF"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/Chargebacks_FiservMembers')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Populate_Chargebacks",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "stgCountryCodeSubdivision",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "populate_Chargebacks_FiservMembers",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "srcPIRecord": {},
                                    "srcBalanceStatus": {},
                                    "scrCustExpanded": {},
                                    "srcAltCustIdentification": {},
                                    "srcExpAddr": {},
                                    "srcPIStatus": {},
                                    "srcEmail": {},
                                    "srcCountryCode": {},
                                    "srcCountryCodeSubdivision": {},
                                    "snkCardHolderWithBASTAddr": {},
                                    "snkCardHolderEmail": {},
                                    "snkCardHolderWithExpAddr": {},
                                    "snkNoAddr": {}
                                }
                            },
                            "staging": {},
                            "integrationRuntime": {
                                "referenceName": "Chargebacks-16core-15TTL",
                                "type": "IntegrationRuntimeReference"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "stgPIStatus",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "stgExpAddr",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_stgPI_Status",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "timeout": "7.00:00:00",
                            "sleep": 10
                        }
                    },
                    {
                        "name": "stgAltCustIdentification",
                        "type": "Validation",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_stgAltCustIdentification",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "timeout": "7.00:00:00",
                            "sleep": 10
                        }
                    },
                    {
                        "name": "stgCustExpanded",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "stgAltCustIdentification",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_stgCustExpanded",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "timeout": "7.00:00:00",
                            "sleep": 10
                        }
                    },
                    {
                        "name": "stgEmail",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "stgCustExpanded",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_stgEmail",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "timeout": "7.00:00:00",
                            "sleep": 10
                        }
                    },
                    {
                        "name": "stgExpAddr",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "stgEmail",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_stgExpAddr",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "timeout": "7.00:00:00",
                            "sleep": 10
                        }
                    },
                    {
                        "name": "stgBalanceStatus",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "stgPIStatus",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ADLS_stage_BalanceStatus",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "timeout": "7.00:00:00",
                            "sleep": 10
                        }
                    },
                    {
                        "name": "stgPIRecord",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "stgBalanceStatus",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_stgPIRecord",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "timeout": "7.00:00:00",
                            "sleep": 10
                        }
                    },
                    {
                        "name": "partition_switch_CardHolder",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Populate_Chargebacks",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[usp_switch_CardHolder]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Chargebacks",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "partition_switch_CardHolderEmail",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "partition_switch_CardHolder",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[usp_switch_CardHolderEmail]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Chargebacks",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "stgCountryCode",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "stgPIRecord",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_stgCountryCode",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "timeout": "7.00:00:00",
                            "sleep": 10
                        }
                    },
                    {
                        "name": "stgCountryCodeSubdivision",
                        "type": "Validation",
                        "dependsOn": [
                            {
                                "activity": "stgCountryCode",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_stgCountryCodeSubdivision",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "timeout": "7.00:00:00",
                            "sleep": 10
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "FirstData"
                },
                "annotations": [],
                "lastPublishTime": "2022-05-17T20:44:15Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/RawToStage_FDReferenceFiles')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "PI_Record Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "PI_Record",
                                "par_destFilename": "PI_Record.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "AltCustIdentification Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "AltCustIdentification",
                                "par_destFilename": "AltCustIdentification.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "BalanceStatus Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "BalanceStatus",
                                "par_destFilename": "BalanceStatus.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "CustExpanded Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "CustExpanded",
                                "par_destFilename": "CustExpanded.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "Email Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "Email",
                                "par_destFilename": "Email.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "ExpAddr Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "ExpAddr",
                                "par_destFilename": "ExpAddr.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "PI_Status Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "PI_Status",
                                "par_destFilename": "PI_Status.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "BaseData Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "BaseData",
                                "par_destFilename": "BaseData.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "AcctHierarchy Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "AccountHierarchy",
                                "par_destFilename": "AccountHierarchy.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "CustomerData Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "CustomerData",
                                "par_destFilename": "CustomerData.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "CountryCode Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "ISO",
                                "par_Object": "CountryCode",
                                "par_destFilename": "CountryCode.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Reference"
                            }
                        }
                    },
                    {
                        "name": "CountryCodeSubdivision Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "ISO",
                                "par_Object": "CountryCodeSubdivision",
                                "par_destFilename": "CountryCodeSubdivision.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Reference"
                            }
                        }
                    },
                    {
                        "name": "CCUMSTR Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "CCUMSTR",
                                "par_destFilename": "CCUMSTR.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "CD495DTL Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "CD495MergeAllFiles",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {}
                        }
                    },
                    {
                        "name": "CustRole Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "CustRole",
                                "par_destFilename": "CustRole.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    },
                    {
                        "name": "Phone Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "Phone",
                                "par_destFilename": "Phone.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/ReferenceFile"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData"
                },
                "annotations": [
                    "Chargebacks"
                ],
                "lastPublishTime": "2022-12-27T21:54:09Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/FDTransactions')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "FDTransactions",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FDTransactions",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "fileName": {
                                        "value": "'@{pipeline().parameters.fileName}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "MonetaryDetailTransactions": {
                                        "fileName": {
                                            "value": "@pipeline().parameters.fileName",
                                            "type": "Expression"
                                        }
                                    },
                                    "CCUMSTR": {},
                                    "FDCriteria": {},
                                    "sink1": {
                                        "Directory_Year": {
                                            "value": "@pipeline().parameters.Directory_Year",
                                            "type": "Expression"
                                        },
                                        "Directory_Month": {
                                            "value": "@pipeline().parameters.Directory_Month",
                                            "type": "Expression"
                                        },
                                        "Directory_Day": {
                                            "value": "@pipeline().parameters.Directory_Day",
                                            "type": "Expression"
                                        }
                                    }
                                }
                            },
                            "staging": {},
                            "integrationRuntime": {
                                "referenceName": "FDTrans-Compute-16Cores-30TTL",
                                "type": "IntegrationRuntimeReference"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DeleteDrop_FDTrans",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "FDTransactions",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneTransactions_FD",
                                "type": "DatasetReference",
                                "parameters": {
                                    "fileName": {
                                        "value": "@pipeline().parameters.fileName",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "enableLogging": false,
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": false
                            }
                        }
                    }
                ],
                "concurrency": 10,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Directory_Year": {
                        "type": "string"
                    },
                    "Directory_Month": {
                        "type": "string"
                    },
                    "Directory_Day": {
                        "type": "string"
                    },
                    "fileName": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "FirstData"
                },
                "annotations": [],
                "lastPublishTime": "2021-11-08T23:29:35Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semantic_IterativeMonthRange')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Loads Semantic Layer by Month Desc.\nValid Dashboard Parameter Values are:\nMerchantAnalysis\nMerchantCategoryAnalysis\nTransactionSpendAnalysis\nTransactionVolumeAnalysis\nTransactionAnalysis\nCardholderDeclineAnalysis\nATMTerminalAnalysis\nATMTransactionAnalysis",
                "activities": [
                    {
                        "name": "Until1",
                        "type": "Until",
                        "dependsOn": [
                            {
                                "activity": "Start Date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@less(formatDateTime(variables('Date_Increment_End')),formatDateTime(pipeline().parameters.Date_Start))",
                                "type": "Expression"
                            },
                            "activities": [
                                {
                                    "name": "Switch_Dashboard",
                                    "type": "Switch",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "on": {
                                            "value": "@pipeline().parameters.Dashboard",
                                            "type": "Expression"
                                        },
                                        "cases": [
                                            {
                                                "value": "MerchantAnalysis",
                                                "activities": [
                                                    {
                                                        "name": "EndDateIncrement_Merch",
                                                        "type": "SetVariable",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "MerchantAnalysis",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_End",
                                                            "value": {
                                                                "value": "@addToTime(formatDateTime(variables('Date_Increment_Start')),-1, 'Month')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "StartDateIncrement_Merch",
                                                        "type": "SetVariable",
                                                        "dependsOn": [],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_Start",
                                                            "value": {
                                                                "value": "@variables('Date_Increment_End')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "MerchantAnalysis",
                                                        "type": "ExecutePipeline",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "StartDateIncrement_Merch",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "pipeline": {
                                                                "referenceName": "populate_semMerchantAnalysis_singleMonth",
                                                                "type": "PipelineReference"
                                                            },
                                                            "waitOnCompletion": true,
                                                            "parameters": {
                                                                "date_start": {
                                                                    "value": "@variables('Date_Increment_Start')",
                                                                    "type": "Expression"
                                                                }
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "value": "MerchantCategoryAnalysis",
                                                "activities": [
                                                    {
                                                        "name": "EndDateIncrement_MerchCat",
                                                        "type": "SetVariable",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "MerchantCategoryAnalysis",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_End",
                                                            "value": {
                                                                "value": "@addToTime(formatDateTime(variables('Date_Increment_Start')),-1, 'Month')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "StartDateIncrement_MerchCat",
                                                        "type": "SetVariable",
                                                        "dependsOn": [],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_Start",
                                                            "value": {
                                                                "value": "@variables('Date_Increment_End')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "MerchantCategoryAnalysis",
                                                        "type": "ExecutePipeline",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "StartDateIncrement_MerchCat",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "pipeline": {
                                                                "referenceName": "populate_semMerchantCategoryAnalysis_singleMonth",
                                                                "type": "PipelineReference"
                                                            },
                                                            "waitOnCompletion": true,
                                                            "parameters": {
                                                                "date_start": {
                                                                    "value": "@variables('Date_Increment_Start')",
                                                                    "type": "Expression"
                                                                }
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "value": "TransactionSpendAnalysis",
                                                "activities": [
                                                    {
                                                        "name": "EndDateIncrement_Spend",
                                                        "type": "SetVariable",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "TransactionSpendAnalysis",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_End",
                                                            "value": {
                                                                "value": "@addToTime(formatDateTime(variables('Date_Increment_Start')),-1, 'Month')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "StartDateIncrement_Spend",
                                                        "type": "SetVariable",
                                                        "dependsOn": [],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_Start",
                                                            "value": {
                                                                "value": "@variables('Date_Increment_End')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "TransactionSpendAnalysis",
                                                        "type": "ExecutePipeline",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "StartDateIncrement_Spend",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "pipeline": {
                                                                "referenceName": "populate_semTransactionSpendAnalysis_singleMonth",
                                                                "type": "PipelineReference"
                                                            },
                                                            "waitOnCompletion": true,
                                                            "parameters": {
                                                                "start_date": {
                                                                    "value": "@variables('Date_Increment_Start')",
                                                                    "type": "Expression"
                                                                }
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "value": "TransactionVolumeAnalysis",
                                                "activities": [
                                                    {
                                                        "name": "EndDateIncrement_Volume",
                                                        "type": "SetVariable",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "TransactionVolumeAnalysis",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_End",
                                                            "value": {
                                                                "value": "@addToTime(formatDateTime(variables('Date_Increment_Start')),-1, 'Month')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "StartDateIncrement_Volume",
                                                        "type": "SetVariable",
                                                        "dependsOn": [],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_Start",
                                                            "value": {
                                                                "value": "@variables('Date_Increment_End')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "TransactionVolumeAnalysis",
                                                        "type": "ExecutePipeline",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "StartDateIncrement_Volume",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "pipeline": {
                                                                "referenceName": "populate_semTransactionVolumeAnalysis_singleMonth",
                                                                "type": "PipelineReference"
                                                            },
                                                            "waitOnCompletion": true,
                                                            "parameters": {
                                                                "start_date": {
                                                                    "value": "@variables('Date_Increment_Start')",
                                                                    "type": "Expression"
                                                                }
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "value": "TransactionAnalysis",
                                                "activities": [
                                                    {
                                                        "name": "EndDateIncrement_Trans",
                                                        "type": "SetVariable",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "TransactionAnalysis",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_End",
                                                            "value": {
                                                                "value": "@addToTime(formatDateTime(variables('Date_Increment_Start')),-1, 'Month')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "StartDateIncrement_Trans",
                                                        "type": "SetVariable",
                                                        "dependsOn": [],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_Start",
                                                            "value": {
                                                                "value": "@variables('Date_Increment_End')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "TransactionAnalysis",
                                                        "type": "ExecutePipeline",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "StartDateIncrement_Trans",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "pipeline": {
                                                                "referenceName": "populate_semTransactionAnalysis_singleMonth",
                                                                "type": "PipelineReference"
                                                            },
                                                            "waitOnCompletion": true,
                                                            "parameters": {
                                                                "start_date": {
                                                                    "value": "@variables('Date_Increment_Start')",
                                                                    "type": "Expression"
                                                                }
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "value": "CardholderDeclineAnalysis",
                                                "activities": [
                                                    {
                                                        "name": "EndDateIncrement_Decline",
                                                        "type": "SetVariable",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "CardholderDecline",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_End",
                                                            "value": {
                                                                "value": "@addToTime(formatDateTime(variables('Date_Increment_Start')),-1, 'Month')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "StartDateIncrement_Decline",
                                                        "type": "SetVariable",
                                                        "dependsOn": [],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_Start",
                                                            "value": {
                                                                "value": "@variables('Date_Increment_End')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "CardholderDecline",
                                                        "type": "ExecutePipeline",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "StartDateIncrement_Decline",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "pipeline": {
                                                                "referenceName": "populate_semCardholderDeclineAnalysis_singleMonth",
                                                                "type": "PipelineReference"
                                                            },
                                                            "waitOnCompletion": true,
                                                            "parameters": {
                                                                "start_date": {
                                                                    "value": "@variables('Date_Increment_Start')",
                                                                    "type": "Expression"
                                                                }
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "value": "ATMTerminalAnalysis",
                                                "activities": [
                                                    {
                                                        "name": "EndDateIncrement_ATMTerminal",
                                                        "type": "SetVariable",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "ATMTerminal",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_End",
                                                            "value": {
                                                                "value": "@addToTime(formatDateTime(variables('Date_Increment_Start')),-1, 'Month')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "StartDateIncrement_ATMTerminal",
                                                        "type": "SetVariable",
                                                        "dependsOn": [],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_Start",
                                                            "value": {
                                                                "value": "@variables('Date_Increment_End')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "ATMTerminal",
                                                        "type": "ExecutePipeline",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "StartDateIncrement_ATMTerminal",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "pipeline": {
                                                                "referenceName": "populate_semATMTerminalAnalysis_singleMonth",
                                                                "type": "PipelineReference"
                                                            },
                                                            "waitOnCompletion": true,
                                                            "parameters": {
                                                                "start_date": {
                                                                    "value": "@variables('Date_Increment_Start')",
                                                                    "type": "Expression"
                                                                }
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "value": "ATMTransactionAnalysis",
                                                "activities": [
                                                    {
                                                        "name": "EndDateIncrement_ATMTransaction",
                                                        "type": "SetVariable",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "ATMTransactionAnalysis",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_End",
                                                            "value": {
                                                                "value": "@addToTime(formatDateTime(variables('Date_Increment_Start')),-1, 'Month')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "StartDateIncrement_ATMTransaction",
                                                        "type": "SetVariable",
                                                        "dependsOn": [],
                                                        "policy": {
                                                            "secureOutput": false,
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "variableName": "Date_Increment_Start",
                                                            "value": {
                                                                "value": "@variables('Date_Increment_End')",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "name": "ATMTransactionAnalysis",
                                                        "type": "ExecutePipeline",
                                                        "dependsOn": [
                                                            {
                                                                "activity": "StartDateIncrement_ATMTransaction",
                                                                "dependencyConditions": [
                                                                    "Succeeded"
                                                                ]
                                                            }
                                                        ],
                                                        "policy": {
                                                            "secureInput": false
                                                        },
                                                        "userProperties": [],
                                                        "typeProperties": {
                                                            "pipeline": {
                                                                "referenceName": "populate_semATMTransactionAnalysis_singleMonth",
                                                                "type": "PipelineReference"
                                                            },
                                                            "waitOnCompletion": true,
                                                            "parameters": {
                                                                "start_date": {
                                                                    "value": "@variables('Date_Increment_Start')",
                                                                    "type": "Expression"
                                                                }
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ],
                            "timeout": "7.00:00:00"
                        }
                    },
                    {
                        "name": "Start Date",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "Date_Increment_End",
                            "value": {
                                "value": "@startOfMonth(formatDateTime(pipeline().parameters.Date_End))",
                                "type": "Expression"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Date_Start": {
                        "type": "string",
                        "defaultValue": "01/01/2018"
                    },
                    "Date_End": {
                        "type": "string",
                        "defaultValue": "01/01/2020"
                    },
                    "Dashboard": {
                        "type": "string",
                        "defaultValue": "CardholderDeclineAnalysis"
                    }
                },
                "variables": {
                    "Date_Increment_Start": {
                        "type": "String"
                    },
                    "Date_Increment_End": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:52Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PMTREQ')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "DropToDWRaw",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 2,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "PMTREQ",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "fileName": {
                                        "value": "'@{pipeline().parameters.fileName}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "PMTREQSource": {
                                        "filename": {
                                            "value": "@pipeline().parameters.fileName",
                                            "type": "Expression"
                                        }
                                    },
                                    "paymentraw": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "staging/zelle"
                            },
                            "integrationRuntime": {
                                "referenceName": "Core-8Cores-15TTL",
                                "type": "IntegrationRuntimeReference"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "concurrency": 10,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Directory_Year": {
                        "type": "string"
                    },
                    "Directory_Month": {
                        "type": "string"
                    },
                    "Directory_Day": {
                        "type": "string"
                    },
                    "fileName": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "Zelle/DropToDW"
                },
                "annotations": [
                    "Zelle"
                ],
                "lastPublishTime": "2022-06-21T22:13:18Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_zelle_transaction_analysis_daily')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Stage_zelle_transaction_analysis_daily",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderQuery": {
                                    "value": "Select distinct File_Name INTO #Temp_zelle_payment from [zelle].[zelle_payment]\nselect v.* from sem.vw_zelle_transaction_analysis_daily v\ninner join #Temp_zelle_payment z on v.file_name = z.file_name",
                                    "type": "Expression"
                                },
                                "queryTimeout": "15:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[zelle_transaction_analysis_daily];",
                                "writeBehavior": "insert",
                                "sqlWriterUseTableLock": true,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 16,
                            "dataIntegrationUnits": 16,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "transaction_id",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "transaction_id",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "br_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "br_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "member_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "member_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_notification",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_notification",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_status",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_status",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Retrieval_Reference_Number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Retrieval_Reference_Number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "originating_org_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "originating_org_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "originating_org_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "originating_org_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "receiving_org_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "receiving_or_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "receiving_org_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "receiving_org_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_start_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "transaction_start_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_complete_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "transaction_complete_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "file_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "file_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "file_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "file_run_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "load_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "load_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "loaded_by",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "loaded_by",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_zelle_transaction_analysis_daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Staging_zelle_transaction_analysis_daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "s_p_switch_purge_zelle_transaction_analysis_daily",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "s_p_switch_load_zelle_transaction_analysis_daily",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[s_p_switch_purge_zelle_transaction_analysis_daily]"
                        },
                        "linkedServiceName": {
                            "referenceName": "SharedBranchDM",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "s_p_switch_load_zelle_transaction_analysis_daily",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Stage_zelle_transaction_analysis_daily",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[s_p_switch_load_zelle_transaction_analysis_daily]"
                        },
                        "linkedServiceName": {
                            "referenceName": "SharedBranchDM",
                            "type": "LinkedServiceReference"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Zelle/Semantic"
                },
                "annotations": [
                    "Zelle"
                ],
                "lastPublishTime": "2024-11-16T12:36:38Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_zelle_reporting')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "sem_zelle_report_daily",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderQuery": {
                                    "value": "select * from [sem].[vw_zelle_daily_report]\nwhere (file_name in (Select distinct file_name from [zelle].[zelle_payment]) \nor file_name in (Select distinct file_name from [zelle].[zelle_member]))",
                                    "type": "Expression"
                                },
                                "queryTimeout": "03:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[zelle_daily_report];",
                                "writeBehavior": "insert",
                                "sqlWriterUseTableLock": true,
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "dataIntegrationUnits": 16,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "calendar_year",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "calendar_year",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calendar_quarter",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "calendar_quarter",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calendar_num_quarter",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "calendar_num_quarter",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calendar_month",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "calendar_month",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calendar_num_month",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "calendar_num_month",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calendar_day_of_month",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "calendar_day_of_month",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calendar_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "calendar_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calendar_num_date",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "calender_num_date",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "service_level",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "service_level",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_volume",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "transaction_volume",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "transaction_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "number_of_enrollments",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "number_of_enrollments",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "outgoing_payment_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "outgoing_payment_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "incoming_payment_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "incoming_payment_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "file_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "file_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "file_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "file_run_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "load_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "load_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "loaded_by",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "loaded_by",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_zelle_reporting",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "staging_zelle_reporting",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "s_p_switch_purge_zelle_daily_report",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "s_p_switch_load_zelle_daily_report",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[s_p_switch_purge_zelle_daily_report]"
                        },
                        "linkedServiceName": {
                            "referenceName": "SharedBranchDM",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "s_p_switch_load_zelle_daily_report",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "sem_zelle_report_daily",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[s_p_switch_load_zelle_daily_report]"
                        },
                        "linkedServiceName": {
                            "referenceName": "SharedBranchDM",
                            "type": "LinkedServiceReference"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Zelle/Semantic"
                },
                "annotations": [
                    "Zelle"
                ],
                "lastPublishTime": "2022-07-30T04:08:36Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_shared_branch_acquirer_report')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "sem_shared_branch_acquirer_report",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderQuery": "select * from [sem].[vw_shared_branch_acquirer_report] Where FIle_Name in(Select distinct File_Name from Staging.shared_branch_transactions_daily);",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[shared_branch_acquirer_report];",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "calender_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "calendar_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calender_num_date",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "calender_num_date",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "trans_id",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "trans_id",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transmission_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "transmission_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "local_transaction_time",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "local_transaction_time",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "retrieval_reference_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "retrieval_reference_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "pan",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "pan",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_qualifier",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_qualifier",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "product_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "product_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "product_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "product_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "acquirer_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquiring_institution_rt_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "acquiring_institution_rt_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "authorizing_institution_rt_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "authorizing_institution_rt_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "processing_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "processing_code",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "processing_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "processing_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "trace_audit_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "trace_audit_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reversal_reason_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "reversal_reason_code",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_credit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "acquirer_credit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_debit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "acquirer_debit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_credit_suspense_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "acquirer_credit_suspense_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_debit_suspense_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "acquirer_debit_suspense_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "file_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "file_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "file_run_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "file_run_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "load_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "load_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "loaded_by",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "loaded_by",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_shared_branch_acquirer_report",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_shared_branch_acquirer_report",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "s_p_switch_load_shared_branch_acquirer_report",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "sem_shared_branch_acquirer_report",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[s_p_switch_load_shared_branch_acquirer_report]"
                        },
                        "linkedServiceName": {
                            "referenceName": "SharedBranchDM",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "s_p_switch_purge_shared_branch_acquirer_report",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "s_p_switch_load_shared_branch_acquirer_report",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[s_p_switch_purge_shared_branch_acquirer_report]"
                        },
                        "linkedServiceName": {
                            "referenceName": "SharedBranchDM",
                            "type": "LinkedServiceReference"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Shared Branch/Semantic"
                },
                "annotations": [
                    "Shared Branch"
                ],
                "lastPublishTime": "2021-05-17T21:08:57Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_shared_branch_issuer_report')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "sem_shared_branch_issuer_report",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderQuery": "select * from [sem].[vw_shared_branch_issuer_report] Where FIle_Name in (Select distinct File_Name from Staging.shared_branch_transactions_daily);",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[shared_branch_issuer_report];\nALTER INDEX ALL ON staging.shared_branch_issuer_report DISABLE;",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "calender_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "calendar_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "calender_num_date",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "calender_num_date",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "trans_id",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "trans_id",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transmission_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "transmission_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "local_transaction_time",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "local_transaction_time",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "retrieval_reference_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "retrieval_reference_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "pan",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "pan",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_qualifier",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_qualifier",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "product_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "product_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "product_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "product_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issuer_client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "issuer_client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "acquirer_client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issuer_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "issuer_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "acquirer_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquiring_institution_rt_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "acquiring_institution_rt_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "authorizing_institution_rt_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "authorizing_institution_rT_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "processing_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "processing_code",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "processing_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "processing_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "trace_audit_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "trace_audit_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "reversal_reason_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "reversal_reason_code",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issuer_credit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "issuer_credit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issuer_debit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "issuer_debit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issuer_credit_suspense_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "issuer_credit_suspense_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issuer_debit_suspense_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "issuer_debit_suspense_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "processing_code_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "processing_code_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "fee_month",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "fee_month",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issuer_network_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "issuer_network_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_network_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "acquirer_network_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "no_of_transactions",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "no_of_transactions",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_acceptor_branch_street",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_acceptor_branch_street",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_acceptor_branch_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_acceptor_branch_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_acceptor_branch_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_acceptor_branch_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_acceptor_branch_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_acceptor_branch_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "file_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "file_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "file_run_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "file_run_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "load_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "load_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "loaded_by",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "loaded_by",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_credit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "acquirer_credit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_debit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "acquirer_debit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_credit_suspense_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "acquirer_credit_suspense_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_debit_suspense_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "acquirer_debit_suspense_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Acquirer_branch_street",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Acquirer_branch_street",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Acquirer_branch_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Acquirer_branch_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Acquirer_branch_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Acquirer_branch_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Acquirer_branch_zip",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Acquirer_branch_zip",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Issuer_branch_street",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Issuer_branch_street",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Issuer_branch_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Issuer_branch_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Issuer_branch_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Issuer_branch_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Issuer_branch_zip",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "Issuer_branch_zip",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_shared_branch_issuer_report",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "staging_shared_branch_issuer_report",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "s_p_switch_load_shared_branch_issuer_report",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "sem_shared_branch_issuer_report",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[s_p_switch_load_shared_branch_issuer_report]"
                        },
                        "linkedServiceName": {
                            "referenceName": "SharedBranchDM",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "s_p_switch_purge_shared_branch_issuer_report",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "s_p_switch_load_shared_branch_issuer_report",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[s_p_switch_purge_shared_branch_issuer_report]"
                        },
                        "linkedServiceName": {
                            "referenceName": "SharedBranchDM",
                            "type": "LinkedServiceReference"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Shared Branch/Semantic"
                },
                "annotations": [
                    "Shared Branch"
                ],
                "lastPublishTime": "2022-01-05T22:47:15Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Shared_Branch')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "DropToDWRaw",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "Shared_Branch",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "fileName": {
                                        "value": "'@{pipeline().parameters.fileName}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "SBSource": {
                                        "Year": "@pipeline().parameters.Directory_Year",
                                        "Month": "@pipeline().parameters.Directory_Month",
                                        "Day": "@pipeline().parameters.Directory_Day"
                                    },
                                    "SBDWRaw": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "staging/SB"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "concurrency": 10,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Directory_Year": {
                        "type": "string"
                    },
                    "Directory_Month": {
                        "type": "string"
                    },
                    "Directory_Day": {
                        "type": "string"
                    },
                    "fileName": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "Shared Branch/DropToDW"
                },
                "annotations": [
                    "Shared Branch"
                ],
                "lastPublishTime": "2021-05-17T21:08:57Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/MEMBERS')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "DropToDWMEMBERS",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 2,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "MEMBERS",
                                "type": "DataFlowReference",
                                "parameters": {
                                    "fileName": {
                                        "value": "'@{pipeline().parameters.fileName}'",
                                        "type": "Expression"
                                    }
                                },
                                "datasetParameters": {
                                    "MEMBERSSource": {
                                        "filename": {
                                            "value": "@pipeline().parameters.fileName",
                                            "type": "Expression"
                                        }
                                    },
                                    "memberraw": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "staging/zelle"
                            },
                            "integrationRuntime": {
                                "referenceName": "Core-8Cores-15TTL",
                                "type": "IntegrationRuntimeReference"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "concurrency": 10,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Directory_Year": {
                        "type": "string"
                    },
                    "Directory_Month": {
                        "type": "string"
                    },
                    "Directory_Day": {
                        "type": "string"
                    },
                    "fileName": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "Zelle/DropToDW"
                },
                "annotations": [
                    "Zelle"
                ],
                "lastPublishTime": "2022-06-21T22:13:18Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/OracleDataAutoCreate')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "FISDataPOTables",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "OracleDynamicTables",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "OracleDataFile": {
                                        "container": "drop-zone",
                                        "directory": "FIS/SBTransactions/D200922.CUSW.ISOUSEX.TXT"
                                    },
                                    "AutoCreateTable": {
                                        "TableName": "FIS_Data_Import"
                                    }
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Shared Branch/OracleMig"
                },
                "annotations": [
                    "Shared Branch"
                ],
                "lastPublishTime": "2021-05-17T21:08:57Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Oracle_SharedBranchLoadRaw1')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Oracle_SharedBranch_LoadFisDataRaw",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "SharedBranch_LoadFisDataRaw1",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "SharedBranchDailyFile": {
                                        "filename": "@pipeline().parameters.fileName"
                                    },
                                    "FisDataRaw": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DAILY_FIS_DATA_LOAD",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Oracle_SharedBranch_LoadFisDataRaw",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[DAILY_FIS_DATA_LOAD]"
                        },
                        "linkedServiceName": {
                            "referenceName": "COOPSB",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Update Locations",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "DAILY_FIS_DATA_LOAD",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[CU_LOCATIONS_UPDATE]",
                            "storedProcedureParameters": {
                                "RUNDATE": {
                                    "value": {
                                        "value": "@concat(substring(pipeline().parameters.fileName,3,2),'/',substring(pipeline().parameters.fileName,5,2),'/',substring(utcnow(),0,4))",
                                        "type": "Expression"
                                    },
                                    "type": "String"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "COOPSB",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Create TMG Export",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Update Locations",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[CREATE_TMG_EXPORT]",
                            "storedProcedureParameters": {
                                "RUNDATE": {
                                    "value": {
                                        "value": "@concat(substring(pipeline().parameters.fileName,3,2),'/',substring(pipeline().parameters.fileName,5,2),'/',substring(utcnow(),0,4))",
                                        "type": "Expression"
                                    },
                                    "type": "String"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "COOPSB",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "SB_Apps TMG Export",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Create TMG Export",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[RQS_TMG_DATA_EXPORT]",
                            "storedProcedureParameters": {
                                "RUNDATE": {
                                    "value": {
                                        "value": "@concat(substring(pipeline().parameters.fileName,3,2),'/',substring(pipeline().parameters.fileName,5,2),'/',substring(utcnow(),0,4))",
                                        "type": "Expression"
                                    },
                                    "type": "String"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "SB_Apps",
                            "type": "LinkedServiceReference"
                        }
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "fileName": {
                        "type": "string",
                        "defaultValue": "fileName"
                    }
                },
                "folder": {
                    "name": "Shared Branch/OracleMig"
                },
                "annotations": [
                    "Shared Branch"
                ],
                "lastPublishTime": "2021-05-17T21:08:57Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Oracle_SharedBranchLoadRaw')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Oracle_SharedBranch_LoadFisDataRaw",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "SharedBranch_LoadFisDataRaw",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "SharedBranchDailyFile": {
                                        "filename": "@pipeline().parameters.fileName"
                                    },
                                    "FisDataRaw": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "DAILY_FIS_DATA_LOAD",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Oracle_SharedBranch_LoadFisDataRaw",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[DAILY_FIS_DATA_LOAD]"
                        },
                        "linkedServiceName": {
                            "referenceName": "COOPSB",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Update Locations",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "DAILY_FIS_DATA_LOAD",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[CU_LOCATIONS_UPDATE]",
                            "storedProcedureParameters": {
                                "RUNDATE": {
                                    "value": {
                                        "value": "@concat(substring(pipeline().parameters.fileName,3,2),'/',substring(pipeline().parameters.fileName,5,2),'/',substring(utcnow(),0,4))",
                                        "type": "Expression"
                                    },
                                    "type": "String"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "COOPSB",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Create TMG Export",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Update Locations",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[CREATE_TMG_EXPORT]",
                            "storedProcedureParameters": {
                                "RUNDATE": {
                                    "value": {
                                        "value": "@concat(substring(pipeline().parameters.fileName,3,2),'/',substring(pipeline().parameters.fileName,5,2),'/',substring(utcnow(),0,4))",
                                        "type": "Expression"
                                    },
                                    "type": "String"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "COOPSB",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "SB_Apps TMG Export",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "Create TMG Export",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[dbo].[RQS_TMG_DATA_EXPORT]",
                            "storedProcedureParameters": {
                                "RUNDATE": {
                                    "value": {
                                        "value": "@concat(substring(pipeline().parameters.fileName,3,2),'/',substring(pipeline().parameters.fileName,5,2),'/',substring(utcnow(),0,4))",
                                        "type": "Expression"
                                    },
                                    "type": "String"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "SB_Apps",
                            "type": "LinkedServiceReference"
                        }
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "fileName": {
                        "type": "string",
                        "defaultValue": "fileName"
                    }
                },
                "folder": {
                    "name": "Shared Branch/OracleMig/Shared Branch Daily Load"
                },
                "annotations": [
                    "Shared Branch"
                ],
                "lastPublishTime": "2021-05-17T21:08:57Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/FD_DD553_Master_Populate')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Get Metadata1",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneDD553_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach1",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Get Metadata1",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Get Metadata1').output.childitems",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "DD553RawtoDW",
                                    "type": "ExecuteDataFlow",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataflow": {
                                            "referenceName": "populate_DD553RawtoDW",
                                            "type": "DataFlowReference",
                                            "parameters": {},
                                            "datasetParameters": {
                                                "srcDD553Drop": {
                                                    "file_name": "@item().name"
                                                },
                                                "snkDD553Raw": {}
                                            }
                                        },
                                        "staging": {
                                            "linkedService": {
                                                "referenceName": "EnterpriseDataSource",
                                                "type": "LinkedServiceReference"
                                            },
                                            "folderPath": "stage/Fiserv"
                                        },
                                        "compute": {
                                            "coreCount": 8,
                                            "computeType": "General"
                                        },
                                        "traceLevel": "Fine"
                                    }
                                },
                                {
                                    "name": "DD553Formatted",
                                    "type": "SqlServerStoredProcedure",
                                    "dependsOn": [
                                        {
                                            "activity": "DD553RawtoDW",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "storedProcedureName": "[[Staging].[USP_FORMATDD553]"
                                    },
                                    "linkedServiceName": {
                                        "referenceName": "DataWarehouse",
                                        "type": "LinkedServiceReference"
                                    }
                                },
                                {
                                    "name": "DD553Mapping",
                                    "type": "ExecuteDataFlow",
                                    "dependsOn": [
                                        {
                                            "activity": "DD553Formatted",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataflow": {
                                            "referenceName": "update_DD553Mapping",
                                            "type": "DataFlowReference",
                                            "parameters": {
                                                "file_name": {
                                                    "value": "'@{item().name}'",
                                                    "type": "Expression"
                                                }
                                            },
                                            "datasetParameters": {
                                                "DD553F": {},
                                                "Transactions1": {},
                                                "dwDimMerchantType": {},
                                                "dwDimNetwork": {},
                                                "Transactions2": {},
                                                "dwDimCardEntry": {},
                                                "dwDimTerminal": {},
                                                "TransactionsLog": {},
                                                "CCUMSTR": {},
                                                "FDCriteria": {},
                                                "snkFactTransactions": {},
                                                "snkNewMerchantType": {},
                                                "snkNewNetworks": {},
                                                "snkDD553Processed": {},
                                                "snkAuditUpdatedTransactions": {},
                                                "snkNewCardEntry": {},
                                                "snkNewTerminalKey": {},
                                                "snkTransactionLog": {},
                                                "snkAuditUpdatedTransactions2": {}
                                            }
                                        },
                                        "staging": {
                                            "linkedService": {
                                                "referenceName": "EnterpriseDataSource",
                                                "type": "LinkedServiceReference"
                                            },
                                            "folderPath": "stage/Fiserv"
                                        },
                                        "integrationRuntime": {
                                            "referenceName": "FDTrans-16Cores-15TTL",
                                            "type": "IntegrationRuntimeReference"
                                        },
                                        "traceLevel": "Fine"
                                    }
                                },
                                {
                                    "name": "DeleteDD553Drop",
                                    "type": "Delete",
                                    "dependsOn": [
                                        {
                                            "activity": "DD553Mapping",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataset": {
                                            "referenceName": "src_drpDD553",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "file_name": "@item().name"
                                            }
                                        },
                                        "enableLogging": false,
                                        "storeSettings": {
                                            "type": "AzureBlobFSReadSettings",
                                            "recursive": true
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "All Master Pipelines/FD Masters/FD_DD553"
                },
                "annotations": [],
                "lastPublishTime": "2021-11-08T23:18:02Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Populate_Semantic_IterativeDateRange_copy1')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ProcessEachDay",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "GetDistinctDates",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('GetDistinctDates').output.value",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "PopulateTransactionAnalysis",
                                    "type": "ExecutePipeline",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "pipeline": {
                                            "referenceName": "populate_semTransactionAnalysis_singleDay",
                                            "type": "PipelineReference"
                                        },
                                        "waitOnCompletion": true,
                                        "parameters": {
                                            "ProcessDate": {
                                                "value": "@item().settlement_date_key",
                                                "type": "Expression"
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "GetDistinctDates",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_settlementdates_by_dateRange]",
                                "storedProcedureParameters": {
                                    "EndDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.EndDate",
                                            "type": "Expression"
                                        }
                                    },
                                    "StartDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.StartDate",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "dataset": {
                                "referenceName": "dim_Transaction_Name",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "firstRowOnly": false
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "StartDate": {
                        "type": "string",
                        "defaultValue": "1/1/2019"
                    },
                    "EndDate": {
                        "type": "string",
                        "defaultValue": "1/2/2019"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Daily"
                },
                "annotations": [],
                "lastPublishTime": "2020-08-14T23:18:59Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/LoadOracleHistory')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "FISDataHistory",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FISDataHistory",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "FISdatafile": {},
                                    "FISDataHistorytbl": {},
                                    "HistoricalLoadErrorTbl": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "fileName": {
                        "type": "string",
                        "defaultValue": "fileName"
                    }
                },
                "folder": {
                    "name": "Shared Branch/OracleMig/Historical Load"
                },
                "annotations": [
                    "Shared Branch"
                ],
                "lastPublishTime": "2021-05-17T21:08:57Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_DimAccountGeography_NEW')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "This will populate DimAccountGeograpy in the member schema in Azure SQ DW. This will populate DimAccountGeograpy in the member schema in Azure SQ DW. We updated this table to include Account Address Line One, Account Address Line Two, as well as changed the hashkeys to Sha1. July 20th, 2020",
                "activities": [
                    {
                        "name": "populate_DimAccountGeography_New",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "populate_DimAccountGeography_NEW",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "FISDebitDemographic": {
                                        "filename": "@pipeline().parameters.fileName"
                                    },
                                    "dimAccountGeography": {},
                                    "RefAccountRegionReference": {},
                                    "SnkdimAccountGeography": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "stage/testrun"
                            },
                            "integrationRuntime": {
                                "referenceName": "dimAccountGeography-16Cores-15TTL",
                                "type": "IntegrationRuntimeReference"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "concurrency": 5,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "fileName": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "Dimensions"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:57Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_XrefMember')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "This is to populate a cross reference table  for Account, Customer, Account GEO to the Azure DW. Using Sha1 as the hashkey reference. Dim Account, Dim Customer, and Account Geography tables are all now using the Sha1 hashkey. July 20th, 2020",
                "activities": [
                    {
                        "name": "populate_XrefMember",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "populate_XrefMember",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "FISDebitDemographic": {},
                                    "XrefMember": {},
                                    "SnkXrefMember": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "staging/FIS/Demographics"
                            },
                            "compute": {
                                "coreCount": 16,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "concurrency": 5,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Dimensions"
                },
                "annotations": [],
                "lastPublishTime": "2024-06-04T20:36:53Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/LoadOracleHistory1')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "FISDataHistory",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "FISDataHistory1",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "FISdatafile": {},
                                    "FISDataHistorytbl": {},
                                    "HistoricalLoadErrorTbl": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "fileName": {
                        "type": "string",
                        "defaultValue": "fileName"
                    }
                },
                "folder": {
                    "name": "Shared Branch/OracleMig"
                },
                "annotations": [
                    "Shared Branch"
                ],
                "lastPublishTime": "2021-05-17T21:08:57Z"
            },
            "dependsOn": []
        }
    ]
}