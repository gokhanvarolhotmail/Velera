{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "EnterpriseDataSourceProdDF"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/RawToSmartGrowth')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SG8 Routing",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": false,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "dataset": {
                                "referenceName": "SG8Mapping",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "firstRowOnly": false
                        }
                    },
                    {
                        "name": "only relevent locations",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "SG8 Routing",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('SG8 Routing').output.value",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@greaterOrEquals(indexof(pipeline().parameters.FolderPath,item().SourcePath),0)",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "ForEach1",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "only relevent locations",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('only relevent locations').output.value",
                                "type": "Expression"
                            },
                            "activities": [
                                {
                                    "name": "SendFilestoSmartGrowth_copy1",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "RemoveContainerfromfilepath",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "wildcardFolderPath": {
                                                    "value": "@variables('SourceFolder')",
                                                    "type": "Expression"
                                                },
                                                "wildcardFileName": {
                                                    "value": "@{pipeline().parameters.FileName}",
                                                    "type": "Expression"
                                                },
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "DelimitedTextSink",
                                            "storeSettings": {
                                                "type": "AzureBlobStorageWriteSettings"
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextWriteSettings",
                                                "quoteAllText": true,
                                                "fileExtension": ".txt"
                                            }
                                        },
                                        "enableStaging": false,
                                        "enableSkipIncompatibleRow": true
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "src_fully_parameterized",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": "raw",
                                                "Directory_Client": "a",
                                                "Directory_Type": "a",
                                                "Directory_Year": "a",
                                                "Directory_Month": "a",
                                                "Directory_Day": "a"
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "snk_SmartGrowth",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Folder": {
                                                    "value": "@item().DestinationFolder",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "name": "RemoveContainerfromfilepath",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "SourceFolder",
                                        "value": {
                                            "value": "@replace(pipeline().parameters.FolderPath,'raw/','')",
                                            "type": "Expression"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "FolderPath": {
                        "type": "string",
                        "defaultValue": "@triggerBody().folderPath"
                    },
                    "FileName": {
                        "type": "string",
                        "defaultValue": "@triggerBody().fileName"
                    }
                },
                "variables": {
                    "DestinationFolder": {
                        "type": "String"
                    },
                    "DestinationContainer": {
                        "type": "String"
                    },
                    "SourceFolder": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "SmartGrowth"
                },
                "annotations": [
                    "SmartGrowth"
                ],
                "lastPublishTime": "2020-09-14T20:05:17Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDAcctHierarchy')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDAccountHierarchy_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'AccountHierarchy')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDAccountHierarchy",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDAccountHierarchy",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "Delete1",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzFDAccountHierarchy",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/drptoRawSmartGrowth')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "on arrival of a file the process will copy the file from Drop zone to Raw. If the file is not processed in another way it is then deleted from drop zone.",
                "activities": [
                    {
                        "name": "SG8 Routing drop to raw",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": false,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "dataset": {
                                "referenceName": "SG8Mapping_DropToRaw",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "firstRowOnly": false
                        }
                    },
                    {
                        "name": "only relevent locations",
                        "type": "Filter",
                        "dependsOn": [
                            {
                                "activity": "SG8 Routing drop to raw",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('SG8 Routing drop to raw').output.value",
                                "type": "Expression"
                            },
                            "condition": {
                                "value": "@greaterOrEquals(indexof(pipeline().parameters.FolderPath,item().SourcePath),0)",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "ForEach1",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "only relevent locations",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('only relevent locations').output.value",
                                "type": "Expression"
                            },
                            "activities": [
                                {
                                    "name": "SendFilestoSmartGrowth_copy1",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "RemoveContainerfromfilepath",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "DelimitedTextSource",
                                            "storeSettings": {
                                                "type": "AzureBlobFSReadSettings",
                                                "recursive": false,
                                                "wildcardFolderPath": {
                                                    "value": "@variables('SourceFolder')",
                                                    "type": "Expression"
                                                },
                                                "wildcardFileName": {
                                                    "value": "@{pipeline().parameters.FileName}",
                                                    "type": "Expression"
                                                },
                                                "enablePartitionDiscovery": false
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextReadSettings"
                                            }
                                        },
                                        "sink": {
                                            "type": "DelimitedTextSink",
                                            "storeSettings": {
                                                "type": "AzureBlobFSWriteSettings"
                                            },
                                            "formatSettings": {
                                                "type": "DelimitedTextWriteSettings",
                                                "quoteAllText": true,
                                                "fileExtension": ".txt"
                                            }
                                        },
                                        "enableStaging": false,
                                        "enableSkipIncompatibleRow": true
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "src_fully_parameterized",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": "drop-zone",
                                                "Directory_Client": "a",
                                                "Directory_Type": "a",
                                                "Directory_Year": "a",
                                                "Directory_Month": "a",
                                                "Directory_Day": "a"
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "src_fully_parameterized",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "Container": "raw",
                                                "Directory_Client": {
                                                    "value": "@variables('Source')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Type": {
                                                    "value": "@variables('Object')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Year": {
                                                    "value": "@variables('Year')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Month": {
                                                    "value": "@variables('Month')",
                                                    "type": "Expression"
                                                },
                                                "Directory_Day": {
                                                    "value": "@variables('Day')",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "name": "RemoveContainerfromfilepath",
                                    "type": "SetVariable",
                                    "dependsOn": [
                                        {
                                            "activity": "GetMonth",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        },
                                        {
                                            "activity": "GetYear",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        },
                                        {
                                            "activity": "GetDay",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        },
                                        {
                                            "activity": "GetObject",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        },
                                        {
                                            "activity": "GetSource",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "SourceFolder",
                                        "value": {
                                            "value": "@replace(pipeline().parameters.FolderPath,'drop-zone/','')",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "GetMonth",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "Month",
                                        "value": {
                                            "value": "@substring(pipeline().parameters.FileName,int(item().MonthStart),int(item().MonthLength))",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "GetYear",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "Year",
                                        "value": {
                                            "value": "@substring(pipeline().parameters.FileName,int(item().YearStart),int(item().YearLength))",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "GetDay",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "Day",
                                        "value": {
                                            "value": "@substring(pipeline().parameters.FileName,int(item().DayStart),int(item().DayLength))",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "GetObject",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "Object",
                                        "value": {
                                            "value": "@replace(item().DestinationFolder,concat(split(item().DestinationFolder,'/')[0],'/'),'')",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "GetSource",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "Source",
                                        "value": {
                                            "value": "@split(item().DestinationFolder,'/')[0]",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "SetCopiedFilesFlag",
                                    "type": "SetVariable",
                                    "dependsOn": [
                                        {
                                            "activity": "SendFilestoSmartGrowth_copy1",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "FileCopied",
                                        "value": true
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "If FilesCopied",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "ForEach1",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@variables('FileCopied')",
                                "type": "Expression"
                            },
                            "ifTrueActivities": [
                                {
                                    "name": "RemoveFromDropZone_copy1",
                                    "type": "Delete",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataset": {
                                            "referenceName": "src_Copy",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "container": "drop-zone",
                                                "directory": {
                                                    "value": "@variables('SourceFolder')",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        "enableLogging": false,
                                        "storeSettings": {
                                            "type": "AzureBlobFSReadSettings",
                                            "recursive": false,
                                            "wildcardFileName": {
                                                "value": "@{pipeline().parameters.FileName}",
                                                "type": "Expression"
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "FolderPath": {
                        "type": "string",
                        "defaultValue": "@triggerBody().folderPath"
                    },
                    "FileName": {
                        "type": "string",
                        "defaultValue": "@triggerBody().fileName"
                    }
                },
                "variables": {
                    "DestinationFolder": {
                        "type": "String"
                    },
                    "DestinationContainer": {
                        "type": "String"
                    },
                    "SourceFolder": {
                        "type": "String"
                    },
                    "Month": {
                        "type": "String"
                    },
                    "Year": {
                        "type": "String"
                    },
                    "Day": {
                        "type": "String"
                    },
                    "Object": {
                        "type": "String"
                    },
                    "Source": {
                        "type": "String"
                    },
                    "FileCopied": {
                        "type": "Boolean"
                    }
                },
                "folder": {
                    "name": "SmartGrowth"
                },
                "annotations": [
                    "SmartGrowth"
                ],
                "lastPublishTime": "2021-06-23T20:33:49Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semMerchantAnalysis_monthly')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "copy_MerchantAnalysis",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[merchant_analysis_monthly]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_MerchantAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_MerchantAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:28Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semMerchantCategory_monthly')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "copy_MerchantCategory",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[merchant_category_analysis_monthly]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_MerchantCategory_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_MerchantCategory_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:29Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDCustomerData')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dz_FDCustomerData_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'CustomerData')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDDemographics",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDDemographics",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "Delete1",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzFDDemographics",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:54Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_OracleSBTransactions')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzOracleSBTransactions_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'.CUSW.ISOUSEX.TXT')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzOracleSBTransactions",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_Oracle_SBTransactions",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "D200422.CUSW.ISOUSEX.TXT"
                    }
                },
                "folder": {
                    "name": "FIS/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:54Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semCardholderDeclineAnalysis_singleMonth')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "DeclineToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_cardholder_decline_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_CardholderDeclineAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_CardholderDeclineAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DeleteDecline",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "DeclineToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_MonthData_Cardholder_Decline_analysis_Monthly]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.start_date",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "MerchantandCardholder",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Decline_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DeleteDecline",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_CardholderDeclineAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_CardholderDeclineAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semMerchantAnalysis_singleMonth')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "MerchToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_merchant_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.date_start",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[merchant_analysis_monthly]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_MerchantAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_MerchantAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DeleteMerchMonthly",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "MerchToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_MonthData_Merchant_analysis_Monthly]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.date_start",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "MerchantandCardholder",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Merch_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DeleteMerchMonthly",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_MerchantAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_MerchantAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "date_start": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semMerchantCategoryAnalysis_singleMonth')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ToStaging_MerchCat",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_merchant_category_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.date_start",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[merchant_category_analysis_monthly]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "digital_card_issued_ind",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "digital_card_issued_ind",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_MerchantCategory_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_MerchantCategory_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DeleteMerchCatMonthly",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "ToStaging_MerchCat",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_MonthData_Merchant_Category_analysis_Monthly]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.date_start",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "MerchantandCardholder",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "StagingToMain_MerchCat",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DeleteMerchCatMonthly",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "digital_card_issued_ind",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "digital_card_issued_ind",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_MerchantCategory_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_MerchantCategory_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "date_start": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTransactionVolumeAnalysis_singleMonth')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "VolumeToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_volume_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[transaction_volume_analysis_monthly]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionSummaryAnalysis_Monthly_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionVolumeAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DeleteVolume",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "VolumeToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_MonthData_Transaction_Volume_analysis_Monthly]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.start_date",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Volume_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DeleteVolume",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_TransactionVolumeAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionVolumeAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTransactionSpendAnalysis_singleMonth')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "SpendToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_spend_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[transaction_spend_analysis_monthly]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionSummaryAnalysis_Monthly_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionSpendAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DeleteSpend",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "SpendToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_MonthData_Transaction_Spend_analysis_Monthly]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.start_date",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Spend_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DeleteSpend",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_TransactionSpendAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionSpendAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_SB')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'CUSW')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "BinarySource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "deleteFilesAfterCompletion": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "BinaryReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "BinarySink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "dz_TransactionsSharedBranch",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "raw_TransactionsSharedBranch",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "fileName": "@item().name"
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dz_TransactionsSharedBranch_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "BinaryReadSettings"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "Shared Branch/DropToRaw"
                },
                "annotations": [
                    "Shared Branch"
                ],
                "lastPublishTime": "2021-05-17T21:08:57Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semATMTerminalAnalysis_singleMonth')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ATMTerminalToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_atm_terminal_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[atm_terminal_analysis_monthly]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_income_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_income_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_ATMTerminalAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_ATMTerminalAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DeleteATMTerminal",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "ATMTerminalToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_MonthData_ATM_Terminal_analysis_Monthly]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.start_date",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "ATMTerminal_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DeleteATMTerminal",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_income_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_income_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_ATMTerminalAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_ATMTerminalAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTransactionAnalysis_singleMonth')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "TransToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[transaction_analysis_monthly]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DeleteTrans",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "TransToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_MonthData_Transaction_analysis_Monthly]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.start_date",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Trans_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DeleteTrans",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Trans_StagingToMain_noaccount",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DeleteTrans_noaccount",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_year",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "settlement_year",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_month",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "settlement_month",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Monthly_noaccount_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Monthly_NoAccount",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DeleteTrans_noaccount",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "TransToStaging_noaccount",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_MonthData_Transaction_analysis_Monthly_no_account]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.start_date",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "TransToStaging_noaccount",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_transaction_analysis_monthly_no_account_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[transaction_analysis_monthly_no_account]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionsAnalysis_Monthly_NoAccount",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Monthly_noaccount_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semATMTransactionAnalysis_singleMonth')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ATMTransactionToStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_atm_transaction_analysis_monthly_noFilter]",
                                "storedProcedureParameters": {
                                    "settlementDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.start_date",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[atm_transaction_analysis_monthly]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_income_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_income_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_ATMTransactionAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_ATMTransactionAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DeleteATMTransaction",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "ATMTransactionToStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_MonthData_ATM_Transaction_analysis_Monthly]",
                            "storedProcedureParameters": {
                                "Settlement_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.start_date",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "ATMTransaction_StagingToMain",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DeleteATMTransaction",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_income_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_income_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_ATMTransactionAnalysis_Monthly_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_ATMTransactionAnalysis_Monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "start_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad/Monthly"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_Zelle_PMTREQ')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'PMTREQ')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [
                                                    {
                                                        "activity": "Set variable1",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "dropZoneTransactions_ZellePMTREQ",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_ZellePMTREQ",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@variables('date')",
                                                                "type": "Expression"
                                                            },
                                                            "filename": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "Set variable1",
                                                "type": "SetVariable",
                                                "dependsOn": [],
                                                "policy": {
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "variableName": "date",
                                                    "value": {
                                                        "value": "@substring(item().name,sub(indexOf(item().name,'ZPPMTREQ-001'),8),8)",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneTransactions_meta_ZellePMTREQ",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    },
                    "date": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Zelle/DropToRaw"
                },
                "annotations": [
                    "Zelle"
                ],
                "lastPublishTime": "2021-05-17T21:08:57Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_Zelle_MEMBERS')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": true,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'MEMBERS')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [
                                                    {
                                                        "activity": "Set variable1",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "dropZoneTransactions_ZelleMembers",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_ZelleMembers",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@variables('date')",
                                                                "type": "Expression"
                                                            },
                                                            "filename": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "Set variable1",
                                                "type": "SetVariable",
                                                "dependsOn": [],
                                                "policy": {
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "variableName": "date",
                                                    "value": {
                                                        "value": "@substring(item().name,sub(indexOf(item().name,'ZPMEMBERS-001'),8),8)",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dropZoneTransactions_meta_ZellMEMBERS",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    },
                    "date": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Zelle/DropToRaw"
                },
                "annotations": [
                    "Zelle"
                ],
                "lastPublishTime": "2021-05-17T21:08:57Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_OracleSBTransactions1')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzOracleSBTransactions_meta1",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'.CUSW.ISOUSEX.TXT')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzOracleSBTransactions1",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_Oracle_SBTransactions1",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "D200422.CUSW.ISOUSEX.TXT"
                    }
                },
                "folder": {
                    "name": "FIS"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-12T19:19:00Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_OracleSBTransactions2')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzOracleSBTransactions_meta2",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'.CUSW.ISOUSEX.TXT')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzOracleSBTransactions2",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_Oracle_SBTransactions2",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": {
                                                                "value": "@item().name",
                                                                "type": "Expression"
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "D200422.CUSW.ISOUSEX.TXT"
                    }
                },
                "folder": {
                    "name": "FIS"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-12T19:25:26Z"
            },
            "dependsOn": []
        }
    ]
}