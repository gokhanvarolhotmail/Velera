{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "EnterpriseDataSourceProdDF"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDBaseData')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDBaseData_Meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'BaseData')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDBaseData",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDBaseData",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "Delete1",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzFDBaseData",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDPIIData')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDPIIData_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'PI')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDPIIData",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDPIIData",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-04-16T23:52:41Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semTerminalAnalysis')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Lookup1",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderQuery": "SELECT count(*) as records FROM [Audit].[vw_load_settlement_date]",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "dataset": {
                                "referenceName": "populate_AuditTransactionsLog",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "If Condition1",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "Lookup1",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@greater(activity('Lookup1').output.firstRow.records,0)",
                                "type": "Expression"
                            },
                            "ifTrueActivities": [
                                {
                                    "name": "populate_TermStaging",
                                    "type": "Copy",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "SqlDWSource",
                                            "queryTimeout": "02:00:00",
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "AzureSqlSink",
                                            "preCopyScript": "TRUNCATE TABLE [staging].[terminal_analysis_daily]",
                                            "disableMetricsCollection": false
                                        },
                                        "enableStaging": false,
                                        "parallelCopies": 4,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "account_key",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "account_number",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "acquirer_client_id",
                                                        "type": "Int64"
                                                    },
                                                    "sink": {
                                                        "name": "acquirer_client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "issuer_client_id",
                                                        "type": "Int64"
                                                    },
                                                    "sink": {
                                                        "name": "issuer_client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transmission_date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "transmission_date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "origin_date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "origin_date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "on_us_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "on_us_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "product_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "product_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_outcome_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_outcome_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "on_premise",
                                                        "type": "Boolean"
                                                    },
                                                    "sink": {
                                                        "name": "on_premise",
                                                        "type": "Boolean"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_key",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_key",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_address",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_address",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_city",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_city",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_state",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_state",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_zipcode",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_zipcode",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_country",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_country",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "vw_TerminalAnalysis_Daily",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "sem_TerminalAnalysis_Daily_staging",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                },
                                {
                                    "name": "DELETE_TERM",
                                    "type": "SqlServerStoredProcedure",
                                    "dependsOn": [
                                        {
                                            "activity": "populate_TermStaging",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "storedProcedureName": "[[sem].[s_terminal_analysis_daily_delete]"
                                    },
                                    "linkedServiceName": {
                                        "referenceName": "Consolidation",
                                        "type": "LinkedServiceReference"
                                    }
                                },
                                {
                                    "name": "populate_TermFinal",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "DELETE_TERM",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "7.00:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "AzureSqlSource",
                                            "queryTimeout": "02:00:00",
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "AzureSqlSink"
                                        },
                                        "enableStaging": false,
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "source_system_key",
                                                        "type": "Int32"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "account_number",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "account_number",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "acquirer_client_id",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "acquirer_client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "issuer_client_id",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "issuer_client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transmission_date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "transmission_date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "origin_date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "origin_date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "on_us_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "on_us_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "settlement_Date",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_id",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "client_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_name",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "transaction_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "product_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "product_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "binnumber",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "bin_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "network_cd",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_desc",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "response_code_outcome_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "response_code_outcome_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "on_premise",
                                                        "type": "Boolean"
                                                    },
                                                    "sink": {
                                                        "name": "on_premise",
                                                        "type": "Boolean"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_key",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_key",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_address",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_address",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_city",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_city",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_state",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_state",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_zipcode",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_zipcode",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "terminal_country",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "terminal_country",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_type",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "merchant_group",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_transaction_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_settlement_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    },
                                                    "sink": {
                                                        "name": "sum_interchange_amount",
                                                        "type": "Decimal"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "cnt_transactions",
                                                        "type": "Int32"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "sem_TerminalAnalysis_Daily_staging",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "sem_TerminalAnalysis_Daily",
                                            "type": "DatasetReference",
                                            "parameters": {}
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:35Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_SemanticDatabase_bulk')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "CardholderAnalysis_Copy",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "TerminalAnalysis_copy",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[cardholder_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_CardholderAnalysis_Daily_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_CardholderAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "MerchantAnalysis_copy",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "TransactionAnalysis_copy",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[merchant_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_MerchantAnalysis_Daily_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_MerchantAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "TransactionAnalysis_copy",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[transaction_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionAnalysis_Daily_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "TerminalAnalysis_copy",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[terminal_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "acquirer_client_id",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "acquirer_client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issuer_client_id",
                                            "type": "Int64"
                                        },
                                        "sink": {
                                            "name": "issuer_client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transmission_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "transmission_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "origin_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "on_us_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "product_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "product_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "on_premise",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "on_premise",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_key",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TerminalAnalysis_Daily_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TerminalAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "AccountAnalysis_Copy",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[account_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "import_file_date_Key",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_activation_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "activation_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_expiration_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "expiration_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FrstTrxn",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "first_txn_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsActive",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_activation_flag",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "days_to_first_usage",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "days_to_first_usage",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "days_to_activation",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "days_to_activation",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "dailyNumTrxns",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DailyAmount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_AccountAnalysis_Daily_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_AccountAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:35Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDHeirarchy')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDAccountHierarchy_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'AccountHierarchy')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDAccountHierarchy",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDAccountHierarchy",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:39Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDDemographics')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDDemographics_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'CustomerData')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDDemographics",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDDemographics",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:54Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDBalanceStatus')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDBalanceStatus_Meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'BalanceStatus')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDBalanceStatus",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDBalanceStatus",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "Delete1",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzFDBalanceStatus",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_SemanticDatabase_bulk_Transaction')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "TransactionAnalysis_copy",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Run_TransactionAnalysis",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[transaction_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_TransactionAnalysis_Daily_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_TransactionAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Run_TransactionAnalysis",
                        "type": "Wait",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "waitTimeInSeconds": 1
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:28Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semAccountAnalysis_singleDay')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "populate_AccountsStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "sqlReaderStoredProcedureName": "[[sem].[s_account_analysis_daily_Days_Data_noFilter]",
                                "storedProcedureParameters": {
                                    "reportDate": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@pipeline().parameters.ProcessDate",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [staging].[account_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "import_file_date_Key",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_activation_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "activation_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_expiration_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "expiration_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FrstTrxn",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "first_txn_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "IsActive",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_activation_flag",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "days_to_first_usage",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "days_to_first_usage",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "days_to_activation",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "days_to_activation",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "dailyNumTrxns",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "DailyAmount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_AccountAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_AccountAnalysis_Daily_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "DELETE_Account",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "populate_AccountsStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[d_DaysData_Account_analysis_Daily]",
                            "storedProcedureParameters": {
                                "Report_Date": {
                                    "value": {
                                        "value": "@pipeline().parameters.ProcessDate",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "populate_AccountFinal",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "DELETE_Account",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "parallelCopies": 8,
                            "dataIntegrationUnits": 16,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "activation_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "activation_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "expiration_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "expiration_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "first_txn_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "first_txn_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_activation_flag",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "account_activation_flag",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "days_to_first_usage",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "days_to_first_usage",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "days_to_activation",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "days_to_activation",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "sem_AccountAnalysis_Daily_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_AccountAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "concurrency": 1,
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "ProcessDate": {
                        "type": "string",
                        "defaultValue": "1/1/2019"
                    }
                },
                "folder": {
                    "name": "SemanticLayer/IterativeLoad"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:35Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_SemanticDatabase_bulk_Merchant')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "MerchantAnalysis_copy",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "Run_MerchantAnalysis",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [sem].[merchant_analysis_daily]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "parallelCopies": 4,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_key",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "settlement_Date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "transaction_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "network_cd",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "network_cd",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CardPresence_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "response_outcome_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "response_code_outcome_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_address",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_city",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_state",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_zipcode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "terminal_country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "merchant_group",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "card_entry_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "recurring_Desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "token_request_desc",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_transaction_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_settlement_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "sum_interchange_amount",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "cnt_transactions",
                                            "type": "Int32"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_MerchantAnalysis_Daily_NoFilter",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_MerchantAnalysis_Daily",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Run_MerchantAnalysis",
                        "type": "Wait",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "waitTimeInSeconds": 1
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-06-04T23:27:35Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDPI_Record')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDPI_Record_meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'PI')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDPIIData",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDPI_Record",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "Delete1",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzFDPIIData",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDEmail')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDEmail_Meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'Email')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDEmail",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDEmail",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDrpZoneFile",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzFDEmail",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [
                    "Chargebacks"
                ],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDExpAddr')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDExpAddr_Meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'ExpAddr')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDExpAddr",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDExpAddr",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDrpZoneFile",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzFDExpAddr",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [
                    "Chargebacks"
                ],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDAltCustIdentification')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDAltCustIdentification_Meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'AltCustIdentification')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDAltCustIdentification",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDAltCustIdentification",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDrpZoneFile",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzFDAltCustIdentification",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [],
                "lastPublishTime": "2020-10-09T22:34:54Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/findLatestPath')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Get Years",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Object",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.Object",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "LatestYear",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "Get Years",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "Year",
                            "value": {
                                "value": "@last(activity('Get Years').output.childItems).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "Get Month",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "LatestYear",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Year",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('Year')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "LatestMonth",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "Get Month",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "Month",
                            "value": {
                                "value": "@last(activity('Get Month').output.childItems).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "Get Days",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "LatestMonth",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Month",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('Month')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "LatestDay",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "Get Days",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "Day",
                            "value": {
                                "value": "@last(activity('Get Days').output.childItems).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "MergeAndCopy",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "LatestDay",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": false,
                                    "wildcardFileName": "*sv",
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings",
                                    "copyBehavior": "MergeFiles"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "enableSkipIncompatibleRow": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "path": {
                                    "value": "@concat('logging/errors/',pipeline().parameters.Source,'/',pipeline().parameters.Object,'/',variables('Year'),'/',variables('Month'),'/',variables('Day'))",
                                    "type": "Expression"
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "src_fully_parameterized",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('Month')",
                                        "type": "Expression"
                                    },
                                    "Directory_Day": {
                                        "value": "@variables('Day')",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "snk_fully_parameterized",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": {
                                        "value": "@pipeline().parameters.dest_container",
                                        "type": "Expression"
                                    },
                                    "Directory": {
                                        "value": "@pipeline().parameters.dest_filePath",
                                        "type": "Expression"
                                    },
                                    "File": {
                                        "value": "@pipeline().parameters.dest_filename",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Source": {
                        "type": "string",
                        "defaultValue": "Fiserv"
                    },
                    "Object": {
                        "type": "string",
                        "defaultValue": "AccountHierarchy"
                    },
                    "dest_filename": {
                        "type": "string",
                        "defaultValue": "AccountHierarchy_test.csv"
                    },
                    "dest_container": {
                        "type": "string",
                        "defaultValue": "stage"
                    },
                    "dest_filePath": {
                        "type": "string",
                        "defaultValue": "testrun/ReferenceFile"
                    }
                },
                "variables": {
                    "Year": {
                        "type": "String"
                    },
                    "Month": {
                        "type": "String"
                    },
                    "Day": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2020-09-14T20:05:17Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDPI_Status')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDPI_Status_Meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'PI_Status')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDPI_Status",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDPI_Status",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDrpZoneFile",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzFDPI_Status",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [
                    "Chargebacks"
                ],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FDCustExpanded')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Source_Metadata",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "dzFDCustExpanded_Meta",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "ForEach_Files",
                        "type": "ForEach",
                        "dependsOn": [
                            {
                                "activity": "Source_Metadata",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "items": {
                                "value": "@activity('Source_Metadata').output.childItems",
                                "type": "Expression"
                            },
                            "isSequential": false,
                            "batchCount": 5,
                            "activities": [
                                {
                                    "name": "If Condition1",
                                    "type": "IfCondition",
                                    "dependsOn": [],
                                    "userProperties": [],
                                    "typeProperties": {
                                        "expression": {
                                            "value": "@contains(item().name,'CustExpanded')",
                                            "type": "Expression"
                                        },
                                        "ifTrueActivities": [
                                            {
                                                "name": "moveDrpToRaw",
                                                "type": "Copy",
                                                "dependsOn": [],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "source": {
                                                        "type": "DelimitedTextSource",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSReadSettings",
                                                            "recursive": false,
                                                            "enablePartitionDiscovery": false
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextReadSettings"
                                                        }
                                                    },
                                                    "sink": {
                                                        "type": "DelimitedTextSink",
                                                        "storeSettings": {
                                                            "type": "AzureBlobFSWriteSettings"
                                                        },
                                                        "formatSettings": {
                                                            "type": "DelimitedTextWriteSettings",
                                                            "quoteAllText": true,
                                                            "fileExtension": ".txt"
                                                        }
                                                    },
                                                    "enableStaging": false
                                                },
                                                "inputs": [
                                                    {
                                                        "referenceName": "all_dzFDCustExpanded",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    }
                                                ],
                                                "outputs": [
                                                    {
                                                        "referenceName": "drpToRawFiles_FDCustExpanded",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "outputdirectorypath": "@item().name"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "name": "DeleteDrpZoneFile",
                                                "type": "Delete",
                                                "dependsOn": [
                                                    {
                                                        "activity": "moveDrpToRaw",
                                                        "dependencyConditions": [
                                                            "Succeeded"
                                                        ]
                                                    }
                                                ],
                                                "policy": {
                                                    "timeout": "7.00:00:00",
                                                    "retry": 0,
                                                    "retryIntervalInSeconds": 30,
                                                    "secureOutput": false,
                                                    "secureInput": false
                                                },
                                                "userProperties": [],
                                                "typeProperties": {
                                                    "dataset": {
                                                        "referenceName": "all_dzFDCustExpanded",
                                                        "type": "DatasetReference",
                                                        "parameters": {
                                                            "filename": "@item().name"
                                                        }
                                                    },
                                                    "enableLogging": false,
                                                    "storeSettings": {
                                                        "type": "AzureBlobFSReadSettings",
                                                        "recursive": false
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "filename": {
                        "type": "String",
                        "defaultValue": "test"
                    }
                },
                "folder": {
                    "name": "FirstData/DropToRaw"
                },
                "annotations": [
                    "Chargebacks"
                ],
                "lastPublishTime": "2020-10-09T22:34:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/findLatestPath_FirstRowHeader')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Get Years",
                        "type": "GetMetadata",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Object",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.Object",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "LatestYear",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "Get Years",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "Year",
                            "value": {
                                "value": "@last(activity('Get Years').output.childItems).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "Get Month",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "LatestYear",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Year",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('Year')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "LatestMonth",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "Get Month",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "Month",
                            "value": {
                                "value": "@last(activity('Get Month').output.childItems).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "Get Days",
                        "type": "GetMetadata",
                        "dependsOn": [
                            {
                                "activity": "LatestMonth",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "src_fully_parameterized_Month",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('Month')",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "fieldList": [
                                "childItems"
                            ],
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true
                            },
                            "formatSettings": {
                                "type": "DelimitedTextReadSettings"
                            }
                        }
                    },
                    {
                        "name": "LatestDay",
                        "type": "SetVariable",
                        "dependsOn": [
                            {
                                "activity": "Get Days",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "Day",
                            "value": {
                                "value": "@last(activity('Get Days').output.childItems).name",
                                "type": "Expression"
                            }
                        }
                    },
                    {
                        "name": "MergeAndCopy",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "LatestDay",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": false,
                                    "wildcardFileName": "*sv",
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings",
                                    "copyBehavior": "MergeFiles"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSettings",
                                    "quoteAllText": true,
                                    "fileExtension": ".txt"
                                }
                            },
                            "enableStaging": false,
                            "enableSkipIncompatibleRow": true
                        },
                        "inputs": [
                            {
                                "referenceName": "src_fully_parameterized_FirstRowHeader",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "raw",
                                    "Directory_Client": {
                                        "value": "@pipeline().parameters.Source",
                                        "type": "Expression"
                                    },
                                    "Directory_Type": {
                                        "value": "@pipeline().parameters.Object",
                                        "type": "Expression"
                                    },
                                    "Directory_Year": {
                                        "value": "@variables('Year')",
                                        "type": "Expression"
                                    },
                                    "Directory_Month": {
                                        "value": "@variables('Month')",
                                        "type": "Expression"
                                    },
                                    "Directory_Day": {
                                        "value": "@variables('Day')",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "snk_fully_parameterized_FirstRowHeader",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": {
                                        "value": "@pipeline().parameters.dest_container",
                                        "type": "Expression"
                                    },
                                    "Directory": {
                                        "value": "@pipeline().parameters.dest_filePath",
                                        "type": "Expression"
                                    },
                                    "File": {
                                        "value": "@pipeline().parameters.dest_filename",
                                        "type": "Expression"
                                    }
                                }
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Source": {
                        "type": "string",
                        "defaultValue": "Fiserv"
                    },
                    "Object": {
                        "type": "string",
                        "defaultValue": "BaseData"
                    },
                    "dest_filename": {
                        "type": "string",
                        "defaultValue": "testFile.csv"
                    },
                    "dest_container": {
                        "type": "string",
                        "defaultValue": "stage"
                    },
                    "dest_filePath": {
                        "type": "string",
                        "defaultValue": "testrun/ReferenceFile"
                    }
                },
                "variables": {
                    "Year": {
                        "type": "String"
                    },
                    "Month": {
                        "type": "String"
                    },
                    "Day": {
                        "type": "String"
                    }
                },
                "annotations": [],
                "lastPublishTime": "2020-04-18T20:15:31Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semOnboardingAnalysis')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "pop_OnboardStaging",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "isolationLevel": "ReadUncommitted",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE staging.onboarding_analysis",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "account_number",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "account_number",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "source_system_key",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "issue_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "activation_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "activation_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "expiration_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "expiration_date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "first_txn_date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "first_txn_date",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_OnboardingAnalysis",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_OnboardingAnalysis_staging",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "partition_switch",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "pop_OnboardStaging",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[p_switch_onboarding_analysis]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/populate_semCardUsageAnalysis')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "pop_CardUsageStaging_preagg",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "pop_CardUsageStaging_monthly",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "03:00:00",
                                "isolationLevel": "ReadUncommitted",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE staging.cardusage_analysis_preagg",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "total_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "active_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "active_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "non_transacting_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "not_activated_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "not_activated_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "total_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "active_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "active_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "non_transacting_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "not_activated_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "not_activated_cards_prev",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_CardUsageAnalysis_preagg",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_CardUsageAnalysis_staging_preagg",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "partition_switch_preagg",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "pop_CardUsageStaging_preagg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[p_switch_cardusage_analysis_preagg]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "pop_CardUsageStaging_monthly",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "sp_dim_date_dashboard",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "03:00:00",
                                "isolationLevel": "ReadUncommitted",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE staging.cardusage_analysis_monthly",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "binnumber",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "binnumber",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "bin_type",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "bin_type",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_id",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_id",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "client_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "client_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "total_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "active_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "active_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "non_transacting_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "not_activated_cards",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "not_activated_cards",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "total_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "total_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "active_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "active_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "non_transacting_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "non_transacting_cards_prev",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "not_activated_cards_prev",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "not_activated_cards_prev",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "vw_CardUsageAnalysis_monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sem_CardUsageAnalysis_staging_monthly",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "partition_switch_monthly",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "pop_CardUsageStaging_preagg",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[sem].[p_switch_cardusage_analysis_monthly]"
                        },
                        "linkedServiceName": {
                            "referenceName": "Consolidation",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "sp_dim_date_dashboard",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[common].[s_dim_date_dashboard]",
                            "storedProcedureParameters": {
                                "report_date": {
                                    "value": {
                                        "value": "@pipeline().parameters.report_date",
                                        "type": "Expression"
                                    },
                                    "type": "DateTime"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "DataWarehouse",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "pop_dim_date_dashboard",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "sp_dim_date_dashboard",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlDWSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "AzureSqlSink",
                                "preCopyScript": "TRUNCATE TABLE [common].[dim_date_dashboard]",
                                "disableMetricsCollection": false
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "timeperiod",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start_prev",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start_prev",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end_prev",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end_prev",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "common_date_dashboard",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "dest_common_date_dashboard",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "report_date": {
                        "type": "string"
                    }
                },
                "folder": {
                    "name": "SemanticLayer"
                },
                "annotations": [],
                "lastPublishTime": "2020-12-28T21:45:51Z"
            },
            "dependsOn": []
        }
    ]
}