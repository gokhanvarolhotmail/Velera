{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "EnterpriseDataSourceProdDF"
        },
        "droptoRaw_FISInterchangeLegacy_properties_typeProperties_scope": {
            "type": "string",
            "defaultValue": "/subscriptions/662e240f-6ddf-4916-a4ff-b5e97b3aeb7e/resourceGroups/EnterpriseDataSourceProdRG/providers/Microsoft.Storage/storageAccounts/enterprisedatasourceprod"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/PL_Copy_RewardsDemoResponseDaily')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Temporary Copy activity that moves data between Raw container locations so Snowflake can ingest the inbound Kobie files for Rewards.",
                "activities": [
                    {
                        "name": "Switch_Copy_RewardsDemoResponseDaily",
                        "type": "Switch",
                        "dependsOn": [
                            {
                                "activity": "validationFileReady",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "on": {
                                "value": "@if(\n    and(\n\t     contains(pipeline().parameters.par_FolderPath,'Rewards/Inbound/Demographics'),contains(pipeline().parameters.par_FileName,'Members_Extract')),'Member_Extract', \n    if(and(contains(pipeline().parameters.par_FolderPath,'Rewards/Inbound/Demographics'),contains(pipeline().parameters.par_FileName,'Member_Error')),'Member_Error','No Processing')\n\n)",
                                "type": "Expression"
                            },
                            "cases": [
                                {
                                    "value": "Member_Extract",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_MemberExtract",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_MemberExtract",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_MemberExtract",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_MemberExtract",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'drop-zone/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('Rewards/Inbound/Demographic/ResponseDaily/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_MemberExtract",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,24,4)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_MemberExtract",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,28,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_MemberExtract",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,30,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "DeleteMemeberExtractFile",
                                            "description": "Delete MemeberExtract File from drop-zone",
                                            "type": "Delete",
                                            "dependsOn": [
                                                {
                                                    "activity": "PL_CopyBinaryFile_MemberExtract",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "timeout": "0.12:00:00",
                                                "retry": 0,
                                                "retryIntervalInSeconds": 30,
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "dataset": {
                                                    "referenceName": "DS_ABLB_Binary_File",
                                                    "type": "DatasetReference",
                                                    "parameters": {
                                                        "Container": {
                                                            "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                            "type": "Expression"
                                                        },
                                                        "Directory": {
                                                            "value": "@replace(pipeline().parameters.par_FolderPath,'drop-zone/','')",
                                                            "type": "Expression"
                                                        },
                                                        "FileName": {
                                                            "value": "@pipeline().parameters.par_FileName",
                                                            "type": "Expression"
                                                        }
                                                    }
                                                },
                                                "logStorageSettings": {
                                                    "linkedServiceName": {
                                                        "referenceName": "EnterpriseDataSource",
                                                        "type": "LinkedServiceReference"
                                                    },
                                                    "path": "logging/errors/Rewards/"
                                                },
                                                "enableLogging": true,
                                                "storeSettings": {
                                                    "type": "AzureBlobFSReadSettings",
                                                    "recursive": true,
                                                    "enablePartitionDiscovery": false
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "value": "Member_Error",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_MemberError",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_MemberError",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_MemberError",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_MemberError",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'drop-zone/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('Rewards/Inbound/Demographic/ResponseDailyError/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_MemberError",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,22 ,4 )",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_MemberError",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,26,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_MemberError",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,28,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "DeleteMemberErrorFile",
                                            "description": "Delete MemberError File from drop-zone",
                                            "type": "Delete",
                                            "dependsOn": [
                                                {
                                                    "activity": "PL_CopyBinaryFile_MemberError",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "timeout": "0.12:00:00",
                                                "retry": 0,
                                                "retryIntervalInSeconds": 30,
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "dataset": {
                                                    "referenceName": "DS_ABLB_Binary_File",
                                                    "type": "DatasetReference",
                                                    "parameters": {
                                                        "Container": {
                                                            "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                            "type": "Expression"
                                                        },
                                                        "Directory": {
                                                            "value": "@replace(pipeline().parameters.par_FolderPath,'drop-zone/','')",
                                                            "type": "Expression"
                                                        },
                                                        "FileName": {
                                                            "value": "@pipeline().parameters.par_FileName",
                                                            "type": "Expression"
                                                        }
                                                    }
                                                },
                                                "logStorageSettings": {
                                                    "linkedServiceName": {
                                                        "referenceName": "EnterpriseDataSource",
                                                        "type": "LinkedServiceReference"
                                                    },
                                                    "path": "logging"
                                                },
                                                "enableLogging": true,
                                                "storeSettings": {
                                                    "type": "AzureBlobFSReadSettings",
                                                    "recursive": true,
                                                    "enablePartitionDiscovery": false
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    },
                    {
                        "name": "validationFileReady",
                        "type": "Validation",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ABLB_Binary_File",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": {
                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                        "type": "Expression"
                                    },
                                    "Directory": {
                                        "value": "@replace(pipeline().parameters.par_FolderPath,'drop-zone/','')",
                                        "type": "Expression"
                                    },
                                    "FileName": {
                                        "value": "@pipeline().parameters.par_FileName",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "timeout": "0.00:10:00",
                            "sleep": 20,
                            "minimumSize": 10
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "par_FolderPath": {
                        "type": "string"
                    },
                    "par_FileName": {
                        "type": "string"
                    }
                },
                "variables": {
                    "var_Year": {
                        "type": "String"
                    },
                    "var_Month": {
                        "type": "String"
                    },
                    "var_Day": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Rewards"
                },
                "annotations": [],
                "lastPublishTime": "2022-10-12T21:00:04Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Copy_RewardsKobieOutbound')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Temporary Copy Activity to Move the Outbound Kobie Demo and Trans files from the Raw container (where Snowflake writes) to the drop-zone (where an SSIS package moves to FTP).",
                "activities": [
                    {
                        "name": "PL_CopyBinaryFile",
                        "type": "ExecutePipeline",
                        "dependsOn": [
                            {
                                "activity": "validationFileReady",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_CopyBinaryFile",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "Source_Container": {
                                    "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                    "type": "Expression"
                                },
                                "Sink_Container": "drop-zone",
                                "Source_Directory": {
                                    "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                    "type": "Expression"
                                },
                                "Sink_Directory": {
                                    "value": "@concat('Rewards/',split(pipeline().parameters.par_FolderPath,'/')[2],'/FTP')",
                                    "type": "Expression"
                                },
                                "FileName": {
                                    "value": "@pipeline().parameters.par_FileName",
                                    "type": "Expression"
                                }
                            }
                        }
                    },
                    {
                        "name": "validationFileReady",
                        "type": "Validation",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ABLB_Binary_File",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": {
                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                        "type": "Expression"
                                    },
                                    "Directory": {
                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                        "type": "Expression"
                                    },
                                    "FileName": {
                                        "value": "@pipeline().parameters.par_FileName",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "timeout": "0.00:10:00",
                            "sleep": 20,
                            "minimumSize": 10
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "par_FolderPath": {
                        "type": "string"
                    },
                    "par_FileName": {
                        "type": "string"
                    }
                },
                "variables": {
                    "var_test": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Rewards"
                },
                "annotations": [],
                "lastPublishTime": "2022-09-29T21:53:54Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Copy_FIS_Network_Interchange_Validation')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Temporary Copy activity that moves data between Raw container locations so Snowflake can ingest the inbound Kobie files for Rewards.",
                "activities": [
                    {
                        "name": "Switch_Copy_RewardsDemoResponseDaily",
                        "type": "Switch",
                        "dependsOn": [
                            {
                                "activity": "validationFileReady",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "on": {
                                "value": "@if(\n    and(\n\t     not(contains(pipeline().parameters.par_FolderPath,'FIS/InterchangeValidation/MASTERCARD/CUSAIPM')),contains(pipeline().parameters.par_FileName,'CUSAIPM.TXT')),\n\t\t 'MASTERCARD_CUSAIPM', \n\t\t if(\n            and(\n\t             not(contains(pipeline().parameters.par_FolderPath,'FIS/InterchangeValidation/MASTERCARD/CUSAIPMC')),contains(pipeline().parameters.par_FileName,'CUSAIPMC.TXT')),\n\t\t         'MASTERCARD_CUSAIPMC',\n                 if(\n\t                 and(\n\t             \t    not(contains(pipeline().parameters.par_FolderPath,'FIS/InterchangeValidation/CIRRUS/CUSACRS')),contains(pipeline().parameters.par_FileName,'CUSACRS.TXT')),\n\t             \t\t'CIRRUS',\n\t                       if(\n\t             \t\t     and(\n\t             \t\t\t      not(contains(pipeline().parameters.par_FolderPath,'FIS/InterchangeValidation/PULSE/CUSAPULS')),contains(pipeline().parameters.par_FileName,'CUSAPULS.TXT')),\n\t             \t\t\t\t  'PULSE',\n\t                                     if(\n\t             \t\t                     and(\n\t             \t\t\t                       not(contains(pipeline().parameters.par_FolderPath,'FIS/InterchangeValidation/VISA/CUSAVDCS')),contains(pipeline().parameters.par_FileName,'CUSAVDCS.TXT')),\n\t             \t\t\t\t\t\t\t\t   \t   'VISA_CUSAVDCS',\n\t\t\t\t\t\t\t\t\t\t\t\t\t   if(\n\t             \t\t                                   and(\n\t             \t\t\t                                     not(contains(pipeline().parameters.par_FolderPath,'FIS/InterchangeValidation/VISA/CUSAVISA')),contains(pipeline().parameters.par_FileName,'CUSAVISA.TXT')),\n\t             \t\t\t\t\t\t\t              \t   \t   'VISA_CUSAVISA',\n\t\t\t\t\t\t\t\t\t\t\t              \t\t   if(\n\t             \t\t                                               and(\n\t             \t\t\t                                                 not(contains(pipeline().parameters.par_FolderPath,'FIS/InterchangeValidation/VISA/CUSAVCRS')),contains(pipeline().parameters.par_FileName,'CUSAVCRS.TXT')),\n\t             \t\t\t\t\t\t\t                          \t   \t   'VISA_CUSAVCRS',\n\t             \t\t\t\t\t\t\t\t\t                              if(\n\t             \t\t                                                              and(\n\t             \t\t\t                                                                not(contains(pipeline().parameters.par_FolderPath,'FIS/InterchangeValidation/VISA/CUSAILNK')),contains(pipeline().parameters.par_FileName,'CUSAILNK.TXT')),\n\t             \t\t\t\t\t\t\t\t\t\t                         \t\t          'VISA_CUSAILNK',\n\t             \t\t\t\t\t\t\t\t\t\t                         \t\t\t\t   if(\n\t             \t\t                                                                                 and(\n\t             \t\t\t                                                                                    not(contains(pipeline().parameters.par_FolderPath,'FIS/InterchangeValidation/VISA/CUSAPLVS')),contains(pipeline().parameters.par_FileName,'CUSAPLVS.TXT')),\n\t             \t\t\t\t\t\t\t\t\t\t                         \t\t                             'VISA_CUSAPLVS',\n\t             \t\t\t\t\t\t\t\t\t\t                         \t\t\t\t                            'No Processing'))))))))\n)",
                                "type": "Expression"
                            },
                            "cases": [
                                {
                                    "value": "MASTERCARD_CUSAIPM",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_MASTERCARD_CUSAIPM",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_MASTERCARD_CUSAIPM",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_MASTERCARD_CUSAIPM",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_MASTERCARD_CUSAIPM",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('FIS/InterchangeValidation/MASTERCARD/CUSAIPM/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_MASTERCARD_CUSAIPM",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@concat('20',substring(pipeline().parameters.par_FileName,1,2))",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_MASTERCARD_CUSAIPM",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,3,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_MASTERCARD_CUSAIPM",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,5,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "value": "VISA_CUSAVDCS",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_VISA_CUSAVDCS",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_VISA_CUSAVDCS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_VISA_CUSAVDCS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_VISA_CUSAVDCS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('FIS/InterchangeValidation/VISA/CUSAVDCS/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_VISA_CUSAVDCS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@concat('20',substring(pipeline().parameters.par_FileName,1,2))",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_VISA_CUSAVDCS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,3,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_VISA_CUSAVDCS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,5,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "value": "PULSE",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_PULSE",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_PULSE",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_PULSE",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_PULSE",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('FIS/InterchangeValidation/PULSE/CUSAPULS/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_PULSE",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@concat('20',substring(pipeline().parameters.par_FileName,1,2))",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_PULSE",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,3,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_PULSE",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,5,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "value": "CIRRUS",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_CIRRUS",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_CIRRUS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_CIRRUS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_CIRRUS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('FIS/InterchangeValidation/CIRRUS/CUSACRS/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_CIRRUS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@concat('20',substring(pipeline().parameters.par_FileName,1,2))",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_CIRRUS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,3,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_CIRRUS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,5,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "value": "MASTERCARD_CUSAIPMC",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_MASTERCARD_CUSAIPMC",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_MASTERCARD_CUSAIPMC",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_MASTERCARD_CUSAIPMC",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_MASTERCARD_CUSAIPMC",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('FIS/InterchangeValidation/MASTERCARD/CUSAIPMC/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_MASTERCARD_CUSAIPMC",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@concat('20',substring(pipeline().parameters.par_FileName,1,2))",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_MASTERCARD_CUSAIPMC",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,3,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_MASTERCARD_CUSAIPMC",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,5,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "value": "VISA_CUSAILNK",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_VISA_CUSAILNK",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_VISA_CUSAILNK",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_VISA_CUSAILNK",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_VISA_CUSAILNK",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('FIS/InterchangeValidation/VISA/CUSAILNK/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_VISA_CUSAILNK",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@concat('20',substring(pipeline().parameters.par_FileName,1,2))",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_VISA_CUSAILNK",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,3,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_VISA_CUSAILNK",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,5,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "value": "VISA_CUSAVCRS",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_VISA_CUSAVCRS",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_VISA_CUSAVCRS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_VISA_CUSAVCRS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_VISA_CUSAVCRS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('FIS/InterchangeValidation/VISA/CUSAVCRS/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_VISA_CUSAVCRS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@concat('20',substring(pipeline().parameters.par_FileName,1,2))",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_VISA_CUSAVCRS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,3,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_VISA_CUSAVCRS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,5,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "value": "VISA_CUSAPLVS",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_VISA_CUSAPLVS",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_VISA_CUSAPLVS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_VISA_CUSAPLVS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_VISA_CUSAPLVS",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('FIS/InterchangeValidation/VISA/CUSAPLVS/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_VISA_CUSAPLVS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@concat('20',substring(pipeline().parameters.par_FileName,1,2))",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_VISA_CUSAPLVS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,3,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_VISA_CUSAPLVS",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,5,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                },
                                {
                                    "value": "VISA_CUSAVISA",
                                    "activities": [
                                        {
                                            "name": "PL_CopyBinaryFile_VISA_CUSAVISA",
                                            "type": "ExecutePipeline",
                                            "dependsOn": [
                                                {
                                                    "activity": "set_Year_VISA_CUSAVISA",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Month_VISA_CUSAVISA",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                },
                                                {
                                                    "activity": "set_Day_VISA_CUSAVISA",
                                                    "dependencyConditions": [
                                                        "Succeeded"
                                                    ]
                                                }
                                            ],
                                            "policy": {
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "pipeline": {
                                                    "referenceName": "PL_CopyBinaryFile",
                                                    "type": "PipelineReference"
                                                },
                                                "waitOnCompletion": true,
                                                "parameters": {
                                                    "Source_Container": {
                                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Container": "raw",
                                                    "Source_Directory": {
                                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                                        "type": "Expression"
                                                    },
                                                    "Sink_Directory": {
                                                        "value": "@concat('FIS/InterchangeValidation/VISA/CUSAVISA/',variables('var_Year'),'/',variables('var_Month'),'/',variables('var_Day'))",
                                                        "type": "Expression"
                                                    },
                                                    "FileName": {
                                                        "value": "@pipeline().parameters.par_FileName",
                                                        "type": "Expression"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Year_VISA_CUSAVISA",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Year",
                                                "value": {
                                                    "value": "@concat('20',substring(pipeline().parameters.par_FileName,1,2))",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Month_VISA_CUSAVISA",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Month",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,3,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        },
                                        {
                                            "name": "set_Day_VISA_CUSAVISA",
                                            "type": "SetVariable",
                                            "dependsOn": [],
                                            "policy": {
                                                "secureOutput": false,
                                                "secureInput": false
                                            },
                                            "userProperties": [],
                                            "typeProperties": {
                                                "variableName": "var_Day",
                                                "value": {
                                                    "value": "@substring(pipeline().parameters.par_FileName,5,2)",
                                                    "type": "Expression"
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    },
                    {
                        "name": "validationFileReady",
                        "type": "Validation",
                        "dependsOn": [],
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ABLB_Binary_File",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": {
                                        "value": "@first(split(pipeline().parameters.par_FolderPath,'/'))",
                                        "type": "Expression"
                                    },
                                    "Directory": {
                                        "value": "@replace(pipeline().parameters.par_FolderPath,'raw/','')",
                                        "type": "Expression"
                                    },
                                    "FileName": {
                                        "value": "@pipeline().parameters.par_FileName",
                                        "type": "Expression"
                                    }
                                }
                            },
                            "timeout": "0.00:10:00",
                            "sleep": 20,
                            "minimumSize": 10
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "par_FolderPath": {
                        "type": "string"
                    },
                    "par_FileName": {
                        "type": "string"
                    }
                },
                "variables": {
                    "var_Year": {
                        "type": "String"
                    },
                    "var_Month": {
                        "type": "String"
                    },
                    "var_Day": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "FIS"
                },
                "annotations": [],
                "lastPublishTime": "2022-10-31T21:16:08Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_CopyByDateFile')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Takes a Start and End date (MM/DD/YYYY) and loops through each day copying any files that match to the par_FileName_optional paramter to a destination folder.  Source Directory should be directory of date data without the year/month/day.  par_FileName_optional is NULL by default.  File Names are matched based on contains function.",
                "activities": [
                    {
                        "name": "Until1",
                        "type": "Until",
                        "dependsOn": [
                            {
                                "activity": "Start Date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@greater(formatDateTime(variables('Date_Increment_End'),'MM/dd/yyyy'),formatDateTime(pipeline().parameters.Date_End,'MM/dd/yyyy'))",
                                "type": "Expression"
                            },
                            "activities": [
                                {
                                    "name": "End Date Increment",
                                    "type": "SetVariable",
                                    "dependsOn": [
                                        {
                                            "activity": "PL_CopyBinaryFolder",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "Date_Increment_End",
                                        "value": {
                                            "value": "@adddays(formatDateTime(variables('Date_Increment_Start')),1)",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "Start Date Increment",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "Date_Increment_Start",
                                        "value": {
                                            "value": "@variables('Date_Increment_End')",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "PL_CopyBinaryFolder",
                                    "type": "ExecutePipeline",
                                    "dependsOn": [
                                        {
                                            "activity": "Start Date Increment",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "pipeline": {
                                            "referenceName": "PL_CopyBinaryFolder",
                                            "type": "PipelineReference"
                                        },
                                        "waitOnCompletion": true,
                                        "parameters": {
                                            "Source_Container": {
                                                "value": "@pipeline().parameters.Source_Container",
                                                "type": "Expression"
                                            },
                                            "Sink_Container": {
                                                "value": "@pipeline().parameters.Sink_Container",
                                                "type": "Expression"
                                            },
                                            "Source_Directory": {
                                                "value": "@concat(pipeline().parameters.Source_Directory,'/',substring(variables('Date_Increment_Start'),0,4),'/',substring(variables('Date_Increment_Start'),5,2),'/',substring(variables('Date_Increment_Start'),8,2))",
                                                "type": "Expression"
                                            },
                                            "Sink_Directory": {
                                                "value": "@concat(pipeline().parameters.Sink_Directory,'/',substring(variables('Date_Increment_Start'),0,4),'/',substring(variables('Date_Increment_Start'),5,2),'/',substring(variables('Date_Increment_Start'),8,2))",
                                                "type": "Expression"
                                            },
                                            "par_FileName_optional": {
                                                "value": "@pipeline().parameters.par_FileName_optional",
                                                "type": "Expression"
                                            }
                                        }
                                    }
                                }
                            ],
                            "timeout": "7.00:00:00"
                        }
                    },
                    {
                        "name": "Start Date",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "Date_Increment_End",
                            "value": {
                                "value": "@formatDateTime(pipeline().parameters.Date_Start)",
                                "type": "Expression"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Source_Container": {
                        "type": "string"
                    },
                    "Sink_Container": {
                        "type": "string"
                    },
                    "Source_Directory": {
                        "type": "string"
                    },
                    "Sink_Directory": {
                        "type": "string"
                    },
                    "Date_Start": {
                        "type": "string",
                        "defaultValue": "02/04/2019"
                    },
                    "Date_End": {
                        "type": "string",
                        "defaultValue": "02/09/2019"
                    },
                    "par_FileName_optional": {
                        "type": "string",
                        "defaultValue": "NULL"
                    }
                },
                "variables": {
                    "Date_Increment_Start": {
                        "type": "String"
                    },
                    "Date_Increment_End": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2022-10-24T22:13:54Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_CopyByDateFolder')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Takes a Start and End date (MM/DD/YYYY) and loops through each day copying all files to a destination folder.  Source Directory should be directory of date data without the year/month/day.",
                "activities": [
                    {
                        "name": "Until1",
                        "type": "Until",
                        "dependsOn": [
                            {
                                "activity": "Start Date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@greater(formatDateTime(variables('Date_Increment_End'),'MM/dd/yyyy'),formatDateTime(pipeline().parameters.Date_End,'MM/dd/yyyy'))",
                                "type": "Expression"
                            },
                            "activities": [
                                {
                                    "name": "End Date Increment",
                                    "type": "SetVariable",
                                    "dependsOn": [
                                        {
                                            "activity": "PL_CopyBinaryFolder",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "Date_Increment_End",
                                        "value": {
                                            "value": "@adddays(formatDateTime(variables('Date_Increment_Start')),1)",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "Start Date Increment",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "Date_Increment_Start",
                                        "value": {
                                            "value": "@variables('Date_Increment_End')",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "PL_CopyBinaryFolder",
                                    "type": "ExecutePipeline",
                                    "dependsOn": [
                                        {
                                            "activity": "Start Date Increment",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "pipeline": {
                                            "referenceName": "PL_CopyBinaryFolder",
                                            "type": "PipelineReference"
                                        },
                                        "waitOnCompletion": true,
                                        "parameters": {
                                            "Source_Container": {
                                                "value": "@pipeline().parameters.Source_Container",
                                                "type": "Expression"
                                            },
                                            "Sink_Container": {
                                                "value": "@pipeline().parameters.Sink_Container",
                                                "type": "Expression"
                                            },
                                            "Source_Directory": {
                                                "value": "@concat(pipeline().parameters.Source_Directory,'/',substring(variables('Date_Increment_Start'),0,4),'/',substring(variables('Date_Increment_Start'),5,2),'/',substring(variables('Date_Increment_Start'),8,2))",
                                                "type": "Expression"
                                            },
                                            "Sink_Directory": {
                                                "value": "@pipeline().parameters.Sink_Directory",
                                                "type": "Expression"
                                            }
                                        }
                                    }
                                }
                            ],
                            "timeout": "7.00:00:00"
                        }
                    },
                    {
                        "name": "Start Date",
                        "type": "SetVariable",
                        "dependsOn": [],
                        "policy": {
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "variableName": "Date_Increment_End",
                            "value": {
                                "value": "@formatDateTime(pipeline().parameters.Date_Start)",
                                "type": "Expression"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "parameters": {
                    "Source_Container": {
                        "type": "string"
                    },
                    "Sink_Container": {
                        "type": "string"
                    },
                    "Source_Directory": {
                        "type": "string"
                    },
                    "Sink_Directory": {
                        "type": "string"
                    },
                    "Date_Start": {
                        "type": "string",
                        "defaultValue": "02/04/2019"
                    },
                    "Date_End": {
                        "type": "string",
                        "defaultValue": "02/09/2019"
                    }
                },
                "variables": {
                    "Date_Increment_Start": {
                        "type": "String"
                    },
                    "Date_Increment_End": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "Utilities"
                },
                "annotations": [],
                "lastPublishTime": "2022-10-24T22:18:38Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_DCI_PushToMerchOperations_ASQL_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "lkp_SF_PTMO",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "SELECT MAX(CREATEDON) as CREATEDON FROM APPLICATION_DB.DCI.PUSHTOMERCHOPERATIONS \n",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "dataset": {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "DCI",
                                    "par_table": "PUSHTOMERCHOPERATIONS"
                                }
                            }
                        }
                    },
                    {
                        "name": "If Condition1",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "lkp_SF_PTMO",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@equals(coalesce(activity('lkp_SF_PTMO').output.firstRow.CREATEDON,0),0)",
                                "type": "Expression"
                            },
                            "ifFalseActivities": [
                                {
                                    "name": "DF_DCI_PTMO_ASQL_SF",
                                    "type": "ExecuteDataFlow",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "0.12:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataflow": {
                                            "referenceName": "DF_DCI_PTMO_ASQL_SF",
                                            "type": "DataFlowReference",
                                            "parameters": {
                                                "par_CREATEDON": {
                                                    "value": "'@{activity('lkp_SF_PTMO').output.firstRow.CREATEDON}'",
                                                    "type": "Expression"
                                                }
                                            },
                                            "datasetParameters": {
                                                "srcPMTO": {
                                                    "par_schema": "dci",
                                                    "par_table": "PUSHTOMERCHOPERATIONS"
                                                },
                                                "snkPTMO": {
                                                    "par_schema": "DCI",
                                                    "par_table": "PUSHTOMERCHOPERATIONS"
                                                }
                                            }
                                        },
                                        "staging": {},
                                        "compute": {
                                            "coreCount": 8,
                                            "computeType": "General"
                                        },
                                        "traceLevel": "Fine"
                                    }
                                }
                            ],
                            "ifTrueActivities": [
                                {
                                    "name": "setVar_LoadDte",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "setVar_LoadDate",
                                        "value": {
                                            "value": "@utcnow()",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "copy_PushtoMerchOperations",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "setVar_LoadDte",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "0.12:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "AzureSqlSource",
                                            "additionalColumns": [
                                                {
                                                    "name": "LoadDte",
                                                    "value": {
                                                        "value": "@variables('setVar_LoadDate')",
                                                        "type": "Expression"
                                                    }
                                                }
                                            ],
                                            "queryTimeout": "02:00:00",
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "SnowflakeSink",
                                            "importSettings": {
                                                "type": "SnowflakeImportCopyCommand"
                                            }
                                        },
                                        "enableStaging": true,
                                        "stagingSettings": {
                                            "linkedServiceName": {
                                                "referenceName": "AzureBlobStorage_SnowFlake",
                                                "type": "LinkedServiceReference"
                                            }
                                        },
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "PushToMerchOperationsId",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "PUSHTOMERCHOPERATIONSID",
                                                        "type": "Int64"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "VendorRecordId",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "VENDORRECORDID",
                                                        "type": "Int64"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "MerchantSiteHostname",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "MERCHANTSITEHOSTNAME",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "MetaKey",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "METAKEY",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "FiName",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "FINAME",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "BankIdentificationNumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "BANKIDENTIFICATIONNUMBER",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "TerminationType",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "TERMINATIONTYPE",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "Status",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "STATUS",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "StatusMessage",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "STATUSMESSAGE",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "Cuid",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "CUID",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "AccountCustomerKey",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "ACCOUNTCUSTOMERKEY",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "CardCustomerKey",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "CARDCUSTOMERKEY",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "Par",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "PAR",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "PlaceCardOnSingleSiteJobId",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "PLACECARDONSINGLESITEJOBID",
                                                        "type": "Int64"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "FinancialInstitutionId",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "FINANCIALINSTITUTIONID",
                                                        "type": "Int64"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "MerchantSiteId",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "MERCHANTSITEID",
                                                        "type": "Int64"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "BinId",
                                                        "type": "Int32"
                                                    },
                                                    "sink": {
                                                        "name": "BINID",
                                                        "type": "Int64"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "Html",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "HTML",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "QueueName",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "QUEUENAME",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "TerminatingState",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "TERMINATINGSTATE",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "TerminatingStateStatus",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "TERMINATINGSTATESTATUS",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "FiLookupKey",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "FILOOKUPKEY",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "IsExpectedFailure",
                                                        "type": "Boolean"
                                                    },
                                                    "sink": {
                                                        "name": "ISEXPECTEDFAILURE",
                                                        "type": "Boolean"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "EmailSent",
                                                        "type": "Boolean"
                                                    },
                                                    "sink": {
                                                        "name": "EMAILSENT",
                                                        "type": "Boolean"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "CompletedOn",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "COMPLETEDON",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "CreatedOn",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "CREATEDON",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "LastUpdatedOn",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "LASTUPDATEDON",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "LoadDte"
                                                    },
                                                    "sink": {
                                                        "name": "LOADDTE",
                                                        "type": "DateTime"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "DS_ASQL_AppODS_DCI",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "par_schema": "dci",
                                                "par_table": "PushToMerchOperations"
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "DS_SF_Application_DB_DCI",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "par_schema": "DCI",
                                                "par_table": "PUSHTOMERCHOPERATIONS"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "setVar_LoadDate": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "DCI"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T14:18:41Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_DCI_PushToWalletReportData_ASQL_SF')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "lkp_SF_PTWRD",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "SELECT MAX(CreateDte) as CreateDte FROM APPLICATION_DB.DCI.PUSHTOWALLETREPORTDATA \n",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "dataset": {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "DCI",
                                    "par_table": "PUSHTOWALLETREPORTDATA"
                                }
                            }
                        }
                    },
                    {
                        "name": "If Condition1",
                        "type": "IfCondition",
                        "dependsOn": [
                            {
                                "activity": "lkp_SF_PTWRD",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "userProperties": [],
                        "typeProperties": {
                            "expression": {
                                "value": "@equals(coalesce(activity('lkp_SF_PTWRD').output.firstRow.CreateDte,0),0)",
                                "type": "Expression"
                            },
                            "ifFalseActivities": [
                                {
                                    "name": "DF_DCI_PTWRD_ASQL_SF",
                                    "type": "ExecuteDataFlow",
                                    "dependsOn": [],
                                    "policy": {
                                        "timeout": "0.12:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "dataflow": {
                                            "referenceName": "DF_DCI_PTWRD_ASQL_SF",
                                            "type": "DataFlowReference",
                                            "parameters": {
                                                "par_CreateDte": {
                                                    "value": "'@{activity('lkp_SF_PTWRD').output.firstRow.CreateDte}'",
                                                    "type": "Expression"
                                                }
                                            },
                                            "datasetParameters": {
                                                "srcPushToWalletReportData": {
                                                    "par_schema": "dci",
                                                    "par_table": "PushToWalletReportData"
                                                },
                                                "snkPushToWalletReportData": {
                                                    "par_schema": "DCI",
                                                    "par_table": "PUSHTOWALLETREPORTDATA"
                                                }
                                            }
                                        },
                                        "staging": {},
                                        "compute": {
                                            "coreCount": 8,
                                            "computeType": "General"
                                        },
                                        "traceLevel": "Fine"
                                    }
                                }
                            ],
                            "ifTrueActivities": [
                                {
                                    "name": "setVar_LoadDte",
                                    "type": "SetVariable",
                                    "dependsOn": [],
                                    "policy": {
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "variableName": "setVar_LoadDate",
                                        "value": {
                                            "value": "@utcnow()",
                                            "type": "Expression"
                                        }
                                    }
                                },
                                {
                                    "name": "copy_PushToWalletReportData",
                                    "type": "Copy",
                                    "dependsOn": [
                                        {
                                            "activity": "setVar_LoadDte",
                                            "dependencyConditions": [
                                                "Succeeded"
                                            ]
                                        }
                                    ],
                                    "policy": {
                                        "timeout": "0.12:00:00",
                                        "retry": 0,
                                        "retryIntervalInSeconds": 30,
                                        "secureOutput": false,
                                        "secureInput": false
                                    },
                                    "userProperties": [],
                                    "typeProperties": {
                                        "source": {
                                            "type": "AzureSqlSource",
                                            "additionalColumns": [
                                                {
                                                    "name": "LoadDte",
                                                    "value": {
                                                        "value": "@variables('setVar_LoadDate')",
                                                        "type": "Expression"
                                                    }
                                                }
                                            ],
                                            "queryTimeout": "02:00:00",
                                            "partitionOption": "None"
                                        },
                                        "sink": {
                                            "type": "SnowflakeSink",
                                            "importSettings": {
                                                "type": "SnowflakeImportCopyCommand"
                                            }
                                        },
                                        "enableStaging": true,
                                        "stagingSettings": {
                                            "linkedServiceName": {
                                                "referenceName": "AzureBlobStorage_SnowFlake",
                                                "type": "LinkedServiceReference"
                                            }
                                        },
                                        "translator": {
                                            "type": "TabularTranslator",
                                            "mappings": [
                                                {
                                                    "source": {
                                                        "name": "ID",
                                                        "type": "Guid"
                                                    },
                                                    "sink": {
                                                        "name": "ID",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "WalletPanNumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "WALLETPANNUMBER",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "ClientNumber",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "CLIENTNUMBER",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "WalletType",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "WALLETTYPE",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "WalletID",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "WALLETID",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "WalletDeviceID",
                                                        "type": "String"
                                                    },
                                                    "sink": {
                                                        "name": "WALLETDEVICEID",
                                                        "type": "String"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "CreateDte",
                                                        "type": "DateTime"
                                                    },
                                                    "sink": {
                                                        "name": "CREATEDTE",
                                                        "type": "DateTime"
                                                    }
                                                },
                                                {
                                                    "source": {
                                                        "name": "LoadDte"
                                                    },
                                                    "sink": {
                                                        "name": "LOADDTE",
                                                        "type": "DateTime"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "inputs": [
                                        {
                                            "referenceName": "DS_ASQL_AppODS_DCI",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "par_schema": "dci",
                                                "par_table": "PushToWalletReportData"
                                            }
                                        }
                                    ],
                                    "outputs": [
                                        {
                                            "referenceName": "DS_SF_Application_DB_DCI",
                                            "type": "DatasetReference",
                                            "parameters": {
                                                "par_schema": "DCI",
                                                "par_table": "PUSHTOWALLETREPORTDATA"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "setVar_LoadDate": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "DCI"
                },
                "annotations": [],
                "lastPublishTime": "2024-10-30T14:18:41Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_AzureBlob_Raw_to_Stage_Fiserv_SpendTrend')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "FiservSpendtrend_Frtransaction Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "Fiserv",
                                "par_Object": "SpendTrend",
                                "par_destFilename": "UpdatedSpendTrend.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "Fiserv/SpendTrend/Current"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Cooper"
                },
                "annotations": [],
                "lastPublishTime": "2022-12-15T23:00:38Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/Pl_AzureBlob_Raw_To_Stage_Confirmed_Fraud')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "FISConfirmedFraud_FrTransaction Merge Latest to Stage",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_FindLatestPath",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "FIS",
                                "par_Object": "ConfirmedFraud",
                                "par_destFilename": "UpdatedConfirmedFraud.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "FIS/ConfirmedFraud/Current"
                            }
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Cooper"
                },
                "annotations": [],
                "lastPublishTime": "2022-12-15T23:06:53Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Stage_WBE_to_ConsolidatedDW')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "This Pipeline loads Feedzai data into ConsolidatedDW for Detection Rate Dashboard",
                "activities": [
                    {
                        "name": "Load_Data_DW_Final",
                        "description": "update FRAUD_TRANSACTION_SCORE.wbe_Code  from [transaction].[STG_Databricks_Wbe] ",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "CopyStageFileToStgTable",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[transaction].[s_FraudTransactionScore_Wbe_update]"
                        },
                        "linkedServiceName": {
                            "referenceName": "DataWarehouse",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Delete from Stage_WBEFile",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "Load_Data_DW_Final",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ADLS_Stage_Wbe",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/Coop/COOPER/CardTransaction/logs"
                            },
                            "enableLogging": true,
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true,
                                "enablePartitionDiscovery": false
                            }
                        }
                    },
                    {
                        "name": "GetFileToProcess",
                        "description": "by default yesterday file",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_GetYesterdayFile",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "WBE",
                                "par_Object": "wbe",
                                "par_destFilename": "updatedwbe.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "wbe"
                            }
                        }
                    },
                    {
                        "name": "CopyStageFileToStgTable",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "GetFileToProcess",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobFSReadSettings",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSettings"
                                }
                            },
                            "sink": {
                                "type": "SqlDWSink",
                                "preCopyScript": "truncate table [transaction].[stg_Databricks_Wbe]",
                                "allowCopyCommand": true,
                                "copyCommandSettings": {},
                                "disableMetricsCollection": false
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/WBE/"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "CARD_NUM",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_NUM",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACCOUNT_NUM",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUM",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_DTM",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_DTM",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TRANSACTION_AMT",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TRANSACTION_AMT",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "COOPER_SCORE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "COOPER_SCORE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FRAUD_WBE_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "FRAUD_WBE_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SOURCE_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SOURCE_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FALCONFADID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "FALCONFADID",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ABLB_PIPE_Header_File",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "stage",
                                    "Directory": "wbe",
                                    "FileName": "updatedwbe.csv"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_ASDW_Stg_Databricks_wbe",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Cooper"
                },
                "annotations": [
                    "cooper"
                ],
                "lastPublishTime": "2022-12-29T00:12:19Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Master_POTT_EP_Offer')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Extended Payment - Plan data pushing into Snowflake App",
                "activities": [
                    {
                        "name": "EP_OFFER",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "EP_OFFER_LOOKUP",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlMISource",
                                "sqlReaderQuery": {
                                    "value": "@concat('SELECT *,getdate() as CREATE_DTM,getdate() as UPDATE_DTM FROM EXTENDEDPAYMENT.dbo.vw_POTT_EP_OFFER WHERE PLAN_UPDATE_DTM >',\n'''',activity('EP_OFFER_LOOKUP').output.firstRow.MAX_PLAN_UPDATE_DTM,''' OR OFFER_CREATE_DTM > ', \n'''',activity('EP_OFFER_LOOKUP').output.firstRow.MAX_PLAN_UPDATE_DTM, '''')\n",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE EXTENDED_PAYMENT.STAGING_EXTENDED_PAYMENT_OFFER;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "EP_PLAN_ID",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "EP_PLAN_ID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EP_OFFER_ID",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "EP_OFFER_ID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ACCOUNT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PROMOTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PROMOTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PROMOTION_DESCRIPTION",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PROMOTION_DESCRIPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PROMOTION_START_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "PROMOTION_START_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PROMOTION_END_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "PROMOTION_END_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ORIGINAL_TRANSACTION_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "ORIGINAL_TRANSACTION_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ORIGINAL_TRANSACTION_DTM",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "ORIGINAL_TRANSACTION_DTM",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ORIGINAL_TRANSACTION_AMT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "ORIGINAL_TRANSACTION_AMT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CHANNEL_TXT",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CHANNEL_TXT",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MERCHANT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "MERCHANT_CATEGORY_CODE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "MERCHANT_CATEGORY_CODE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EP_PLAN_STATUS_DSC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EP_PLAN_STATUS_DSC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OFFER_CREATE_DTM",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "OFFER_CREATE_DTM",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PLAN_UPDATE_DTM",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "PLAN_UPDATE_DTM",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQM_ExtendedPayment",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Schema_Name": "dbo",
                                    "Table_Name": "vw_POTT_EP_OFFER"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "EXTENDED_PAYMENT",
                                    "par_table": "STAGING_EXTENDED_PAYMENT_OFFER"
                                }
                            }
                        ]
                    },
                    {
                        "name": "EP_OFFER_LOOKUP",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "SELECT IFNULL(CASE WHEN OFFER_CREATE_DTM>PLAN_UPDATE_DTM THEN OFFER_CREATE_DTM\nELSE PLAN_UPDATE_DTM END ,'1900-01-01 00:00:00.000') AS MAX_PLAN_UPDATE_DTM\nFROM (SELECT MAX(OFFER_CREATE_DTM) AS OFFER_CREATE_DTM, \nIFNULL(MAX(PLAN_UPDATE_DTM),'1900-01-01 00:00:00.000') AS PLAN_UPDATE_DTM FROM \n\"APPLICATION_DB\".\"EXTENDED_PAYMENT\".\"EXTENDED_PAYMENT_OFFER\" )",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "dataset": {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "EXTENDED_PAYMENT",
                                    "par_table": "EXTENDED_PAYMENT_LOAN"
                                }
                            },
                            "firstRowOnly": true
                        }
                    },
                    {
                        "name": "EP_OFFER_STORED_PROCEDURE",
                        "type": "Lookup",
                        "dependsOn": [
                            {
                                "activity": "EP_OFFER",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "call EXTENDED_PAYMENT.SP_LOAD_STAGE_TO_EP_OFFER();",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "dataset": {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "EXTENDED_PAYMENT",
                                    "par_table": "STAGING_EXTENDED_PAYMENT_LOAN"
                                }
                            },
                            "firstRowOnly": true
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "LAST_RUN_DATE": {
                        "type": "String",
                        "defaultValue": "01-01-1900"
                    }
                },
                "folder": {
                    "name": "POTT (Pay OverTime Transactions)"
                },
                "annotations": [
                    "POTT"
                ],
                "lastPublishTime": "2024-10-30T14:18:40Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Master_POTT_EP_Loan')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Extended Payment - Plan data pushing into Snowflake App",
                "activities": [
                    {
                        "name": "EP_LOAN",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "EP_LOAN_LOOKUP",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlMISource",
                                "sqlReaderQuery": {
                                    "value": "@concat('SELECT *,getdate() as CREATE_DTM,getdate() as UPDATE_DTM FROM dbo.vw_POTT_EP_LOAN WHERE LOAN_UPDATE_DTM >',\n'''',activity('EP_LOAN_LOOKUP').output.firstRow.MAX_LOAN_UPDATE_DTM,''' OR LOAN_CREATE_DTM > ', \n'''',activity('EP_LOAN_LOOKUP').output.firstRow.MAX_LOAN_UPDATE_DTM, '''')",
                                    "type": "Expression"
                                },
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE EXTENDED_PAYMENT.STAGING_EXTENDED_PAYMENT_LOAN;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "EP_PLAN_ID",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "EP_PLAN_ID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EP_OFFER_ID",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "EP_OFFER_ID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PREFERRED_PLAN_NM",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PREFERRED_PLAN_NM",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PLAN_IDENTIFIER_TXT",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PLAN_IDENTIFIER_TXT",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "REVERSAL_TRANSACTION_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REVERSAL_TRANSACTION_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "REVERSAL_TRANSACTION_DTM",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "REVERSAL_TRANSACTION_DTM",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "REVERSAL_TRANSACTION_AMT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "REVERSAL_TRANSACTION_AMT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "REPOST_TRANSACTION_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "REPOST_TRANSACTION_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "REPOST_TRANSACTION_DTM",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "REPOST_TRANSACTION_DTM",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "REPOST_TRANSACTION_AMT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "REPOST_TRANSACTION_AMT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PAYMENT_AMT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "PAYMENT_AMT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FEE_AMT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "FEE_AMT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CALCULATED_INTEREST_AMT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "CALCULATED_INTEREST_AMT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SELECTED_PAYMENT_TERMS_ID",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "SELECTED_PAYMENT_TERMS_ID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EP_LOAN_STATUS_DSC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EP_LOAN_STATUS_DSC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREDIT_LIMIT_AMT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "CREDIT_LIMIT_AMT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "AVAILABLE_CREDIT_AMT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "AVAILABLE_CREDIT_AMT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CURRENT_BALANCE_AMT",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "CURRENT_BALANCE_AMT",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CREDIT_SCORE_TXT",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CREDIT_SCORE_TXT",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAN_CLOSED_DTM",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAN_CLOSED_DTM",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAN_CREATE_DTM",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAN_CREATE_DTM",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "LOAN_UPDATE_DTM",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "LOAN_UPDATE_DTM",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERM_DESCRIPTION",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "TERM_DESCRIPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERM_MONTHS_NBR",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "TERM_MONTHS_NBR",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "TERM_INTEREST_RTE",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "TERM_INTEREST_RTE",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "OMAHA_PAYMENT_TERM_ID",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "OMAHA_PAYMENT_TERM_ID",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PAYMENT_TERMS_FEE_TYPE_CD",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PAYMENT_TERMS_FEE_TYPE_CD",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FEE",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "FEE",
                                            "type": "Int64"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQM_ExtendedPayment",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Schema_Name": "dbo",
                                    "Table_Name": "vw_POTT_EP_LOAN"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "EXTENDED_PAYMENT",
                                    "par_table": "STAGING_EXTENDED_PAYMENT_LOAN"
                                }
                            }
                        ]
                    },
                    {
                        "name": "EP_LOAN_LOOKUP",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "SELECT IFNULL(CASE WHEN LOAN_CREATE_DTM>LOAN_UPDATE_DTM THEN LOAN_CREATE_DTM\nELSE LOAN_UPDATE_DTM END ,'1900-01-01 00:00:00.000') AS MAX_LOAN_UPDATE_DTM\nFROM (SELECT MAX(LOAN_CREATE_DTM) AS LOAN_CREATE_DTM, \nIFNULL(MAX(LOAN_UPDATE_DTM),'1900-01-01 00:00:00.000') AS LOAN_UPDATE_DTM FROM \n\"APPLICATION_DB\".\"EXTENDED_PAYMENT\".\"EXTENDED_PAYMENT_LOAN\" );",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "dataset": {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "EXTENDED_PAYMENT",
                                    "par_table": "EXTENDED_PAYMENT_LOAN"
                                }
                            },
                            "firstRowOnly": true
                        }
                    },
                    {
                        "name": "EP_LOAN_STORED_PROCEDURE",
                        "type": "Lookup",
                        "dependsOn": [
                            {
                                "activity": "EP_LOAN",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "call APPLICATION_DB.EXTENDED_PAYMENT.SP_LOAD_STAGE_TO_EP_LOAN();\n",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "dataset": {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "EXTENDED_PAYMENT",
                                    "par_table": "EXTENDED_PAYMENT_LOAN"
                                }
                            },
                            "firstRowOnly": true
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "LAST_RUN_DATE": {
                        "type": "String",
                        "defaultValue": "01-01-1900"
                    }
                },
                "folder": {
                    "name": "POTT (Pay OverTime Transactions)"
                },
                "annotations": [
                    "POTT"
                ],
                "lastPublishTime": "2024-10-30T14:18:40Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Master_POTT_EP_Plan')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "Extended Payment - Plan data pushing into Snowflake App",
                "activities": [
                    {
                        "name": "EP_PLAN",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "EP_PLAN_LOOKUP",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlMISource",
                                "sqlReaderQuery": {
                                    "value": "@concat('SELECT *,getdate() as CREATE_DTM,getdate() as UPDATE_DTM FROM EXTENDEDPAYMENT.dbo.vw_POTT_EP_PLAN WHERE PROMOTION_UPDATE_DTM >',\n'''',activity('EP_PLAN_LOOKUP').output.firstRow.MAX_PROMOTION_UPDATE_DTM,''' OR PROMOTION_CREATE_DTM > ', \n'''',activity('EP_PLAN_LOOKUP').output.firstRow.MAX_PROMOTION_UPDATE_DTM, '''')",
                                    "type": "Expression"
                                },
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "SnowflakeSink",
                                "preCopyScript": "TRUNCATE TABLE EXTENDED_PAYMENT.STAGING_EXTENDED_PAYMENT_PLAN;",
                                "importSettings": {
                                    "type": "SnowflakeImportCopyCommand"
                                }
                            },
                            "enableStaging": true,
                            "stagingSettings": {
                                "linkedServiceName": {
                                    "referenceName": "AzureBlobStorage_SnowFlake",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "staging/snowflake",
                                "enableCompression": false
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "EP_PLAN_ID",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "EP_PLAN_ID",
                                            "type": "Int64"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CLIENT_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CLIENT_NUMBER",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "FINANCIAL_INSTITUTION_NM",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "FINANCIAL_INSTITUTION_NM",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "CARD_TYPE",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "CARD_TYPE",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PROMOTION_NAME",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PROMOTION_NAME",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PROMOTION_DESCRIPTION",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "PROMOTION_DESCRIPTION",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PROMOTION_START_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "PROMOTION_START_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PROMOTION_END_DATE",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "PROMOTION_END_DATE",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PROMOTION_CREATE_DTM",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "PROMOTION_CREATE_DTM",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "PROMOTION_UPDATE_DTM",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "PROMOTION_UPDATE_DTM",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "EP_PLAN_STATUS_DSC",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "EP_PLAN_STATUS_DSC",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SPA_SYSTEM_NBR",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SPA_SYSTEM_NBR",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SPA_PRINCIPAL_NBR",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SPA_PRINCIPAL_NBR",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "SPA_AGENT_NBR",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "SPA_AGENT_NBR",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "BIN_NUMBER",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "BIN_NUMBER",
                                            "type": "String"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "DS_ASQM_ExtendedPayment",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Schema_Name": "dbo",
                                    "Table_Name": "vw_POTT_EP_PLAN"
                                }
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "EXTENDED_PAYMENT",
                                    "par_table": "STAGING_EXTENDED_PAYMENT_PLAN"
                                }
                            }
                        ]
                    },
                    {
                        "name": "EP_PLAN_LOOKUP",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "SELECT IFNULL(CASE WHEN PROMOTION_CREATE_DTM>PROMOTION_UPDATE_DTM THEN PROMOTION_CREATE_DTM\nELSE PROMOTION_UPDATE_DTM END ,'1900-01-01 00:00:00.000') AS MAX_PROMOTION_UPDATE_DTM\nFROM (SELECT MAX(PROMOTION_CREATE_DTM) AS PROMOTION_CREATE_DTM, \nIFNULL(MAX(PROMOTION_UPDATE_DTM),'1900-01-01 00:00:00.000') AS PROMOTION_UPDATE_DTM FROM \n\"APPLICATION_DB\".\"EXTENDED_PAYMENT\".\"EXTENDED_PAYMENT_PLAN\" )",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "dataset": {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "EXTENDED_PAYMENT",
                                    "par_table": "EXTENDED_PAYMENT_PLAN"
                                }
                            },
                            "firstRowOnly": true
                        }
                    },
                    {
                        "name": "EP_PLAN_STORED_PROCEDURE",
                        "type": "Lookup",
                        "dependsOn": [
                            {
                                "activity": "EP_PLAN",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SnowflakeSource",
                                "query": "call EXTENDED_PAYMENT.SP_LOAD_STAGE_TO_EP_PLAN();\n",
                                "exportSettings": {
                                    "type": "SnowflakeExportCopyCommand"
                                }
                            },
                            "dataset": {
                                "referenceName": "DS_SF_Application_DB_DCI",
                                "type": "DatasetReference",
                                "parameters": {
                                    "par_schema": "EXTENDED_PAYMENT",
                                    "par_table": "EXTENDED_PAYMENT_PLAN"
                                }
                            },
                            "firstRowOnly": true
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "variables": {
                    "LAST_RUN_DATE": {
                        "type": "String",
                        "defaultValue": "01-01-1900"
                    },
                    "var_Src_Directory": {
                        "type": "String"
                    }
                },
                "folder": {
                    "name": "POTT (Pay OverTime Transactions)"
                },
                "annotations": [
                    "POTT"
                ],
                "lastPublishTime": "2024-10-30T14:18:40Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/PL_Raw_CorfirmedFraudReport_to_ConsDW')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "description": "This Pipeline loads ResolutionCenter ConfirmedFraudReport data into ConsolidatedDW ",
                "activities": [
                    {
                        "name": "Load_Data_DW_Final",
                        "description": "update [transaction].[FraudTransaction] \nfrom [transaction].[stg_FraudTransaction] ",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "CopyStageFileToStageTable",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[transaction].[s_FraudTransaction_Load]",
                            "storedProcedureParameters": {
                                "CreateDate": {
                                    "value": {
                                        "value": "@pipeline().TriggerTime",
                                        "type": "Expression"
                                    },
                                    "type": "String"
                                }
                            }
                        },
                        "linkedServiceName": {
                            "referenceName": "DataWarehouse",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "Delete from Stage_File",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "Load_Data_DW_Final",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "DS_ABLB_CSV_Header_File",
                                "type": "DatasetReference",
                                "parameters": {
                                    "Container": "stage",
                                    "Directory": "ResolutionCenter",
                                    "FileName": "updatedConfirmedFraudReport.csv"
                                }
                            },
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "stage/Coop/COOPER/CardTransaction/logs"
                            },
                            "enableLogging": true,
                            "storeSettings": {
                                "type": "AzureBlobFSReadSettings",
                                "recursive": true,
                                "enablePartitionDiscovery": false
                            }
                        }
                    },
                    {
                        "name": "GetFileToProcess",
                        "description": "by default yesterday file",
                        "type": "ExecutePipeline",
                        "dependsOn": [],
                        "policy": {
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "pipeline": {
                                "referenceName": "PL_RawToStage_GetYesterdayFile",
                                "type": "PipelineReference"
                            },
                            "waitOnCompletion": true,
                            "parameters": {
                                "par_Source": "ResolutionCenter",
                                "par_Object": "ConfirmedFraudReport",
                                "par_destFilename": "updatedConfirmedFraudReport.csv",
                                "par_destContainer": "stage",
                                "par_destFilePath": "ResolutionCenter",
                                "par_LoadDate": "2023-02-06"
                            }
                        }
                    },
                    {
                        "name": "CopyStageFileToStageTable",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [
                            {
                                "activity": "GetFileToProcess",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "DF_ConfirmedFraudReportStage_to_ConsDW",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "SourcerfromStage": {},
                                    "sink1": {}
                                }
                            },
                            "staging": {
                                "linkedService": {
                                    "referenceName": "EnterpriseDataSource",
                                    "type": "LinkedServiceReference"
                                },
                                "folderPath": "staging/ResolutionCenter"
                            },
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "folder": {
                    "name": "Cooper"
                },
                "annotations": [
                    "cooper"
                ],
                "lastPublishTime": "2023-09-07T20:47:48Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/ChargeBacks_FiservMem')]",
            "type": "Microsoft.DataFactory/factories/triggers",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "runtimeState": "Started",
                "pipelines": [
                    {
                        "pipelineReference": {
                            "referenceName": "Chargebacks_FiservMembers",
                            "type": "PipelineReference"
                        },
                        "parameters": {}
                    }
                ],
                "type": "ScheduleTrigger",
                "typeProperties": {
                    "recurrence": {
                        "frequency": "Day",
                        "interval": 1,
                        "startTime": "2020-05-10T16:15:00Z",
                        "timeZone": "UTC",
                        "schedule": {}
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/MSSemantic_Load_Trigger')]",
            "type": "Microsoft.DataFactory/factories/triggers",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "runtimeState": "Started",
                "pipelines": [
                    {
                        "pipelineReference": {
                            "referenceName": "Master_Semantic_Loads_Transactions_SF",
                            "type": "PipelineReference"
                        },
                        "parameters": {}
                    },
                    {
                        "pipelineReference": {
                            "referenceName": "PL_Master_Semantic_Transaction_AnalysisDCI",
                            "type": "PipelineReference"
                        },
                        "parameters": {}
                    }
                ],
                "type": "ScheduleTrigger",
                "typeProperties": {
                    "recurrence": {
                        "frequency": "Day",
                        "interval": 1,
                        "startTime": "2020-06-17T03:00:00Z",
                        "timeZone": "UTC",
                        "schedule": {}
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/RawToStage_FISRefFiles_Trigger')]",
            "type": "Microsoft.DataFactory/factories/triggers",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "runtimeState": "Started",
                "pipelines": [
                    {
                        "pipelineReference": {
                            "referenceName": "RawToStage_FISReferenceFiles",
                            "type": "PipelineReference"
                        },
                        "parameters": {}
                    }
                ],
                "type": "ScheduleTrigger",
                "typeProperties": {
                    "recurrence": {
                        "frequency": "Day",
                        "interval": 1,
                        "startTime": "2020-10-02T19:30:00Z",
                        "timeZone": "UTC",
                        "schedule": {
                            "minutes": [
                                0
                            ],
                            "hours": [
                                22
                            ]
                        }
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/RawToStage_FDRefFiles_Trigger')]",
            "type": "Microsoft.DataFactory/factories/triggers",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "runtimeState": "Started",
                "pipelines": [
                    {
                        "pipelineReference": {
                            "referenceName": "RawToStage_FDReferenceFiles",
                            "type": "PipelineReference"
                        },
                        "parameters": {}
                    }
                ],
                "type": "ScheduleTrigger",
                "typeProperties": {
                    "recurrence": {
                        "frequency": "Day",
                        "interval": 1,
                        "startTime": "2020-04-19T04:30:00Z",
                        "timeZone": "UTC",
                        "schedule": {
                            "minutes": [
                                0
                            ],
                            "hours": [
                                22
                            ]
                        }
                    }
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/droptoRaw_FISInterchangeLegacy')]",
            "type": "Microsoft.DataFactory/factories/triggers",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "runtimeState": "Started",
                "pipelines": [
                    {
                        "pipelineReference": {
                            "referenceName": "droptoRaw_InterchangeLegacy",
                            "type": "PipelineReference"
                        },
                        "parameters": {}
                    }
                ],
                "type": "BlobEventsTrigger",
                "typeProperties": {
                    "blobPathBeginsWith": "/drop-zone/blobs/Coop/InterchangeLegacy/",
                    "blobPathEndsWith": ".csv",
                    "ignoreEmptyBlobs": true,
                    "scope": "[parameters('droptoRaw_FISInterchangeLegacy_properties_typeProperties_scope')]",
                    "events": [
                        "Microsoft.Storage.BlobCreated"
                    ]
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/3DS4140toOutboundforcsv')]",
            "type": "Microsoft.DataFactory/factories/triggers",
            "apiVersion": "2018-06-01",
            "properties": {
                "annotations": [],
                "runtimeState": "Started",
                "pipelines": [
                    {
                        "pipelineReference": {
                            "referenceName": "3DS4140toOutboundforcsv",
                            "type": "PipelineReference"
                        },
                        "parameters": {}
                    }
                ],
                "type": "ScheduleTrigger",
                "typeProperties": {
                    "recurrence": {
                        "frequency": "Day",
                        "interval": 1,
                        "startTime": "2020-12-30T22:57:00Z",
                        "timeZone": "UTC",
                        "schedule": {
                            "minutes": [
                                0
                            ],
                            "hours": [
                                1
                            ]
                        }
                    }
                }
            },
            "dependsOn": []
        }
    ]
}